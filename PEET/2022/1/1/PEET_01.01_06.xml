<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.3 20210610//EN" "JATS-journalpublishing1-3.dtd">
<article xml:lang="en" dtd-version="1.3" article-type="research-article" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">PEET</journal-id>
      <journal-id journal-id-type="doi">10.56578</journal-id>
      <journal-title-group>
        <journal-title>Power Engineering and Engineering Thermophysics</journal-title>
        <abbrev-journal-title abbrev-type="issn">Power Eng. Eng Thermophys.</abbrev-journal-title>
        <abbrev-journal-title abbrev-type="publisher">PEET</abbrev-journal-title>
      </journal-title-group>
      <issn publication-format="electronic">2957-9635</issn>
      <issn publication-format="print">2957-9627</issn>
      <publisher>
        <publisher-name>Acadlore</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">AR-wONNaNaCxbYp75mRtbVbc9_1IxC8bCSZ</article-id>
      <article-id pub-id-type="doi">10.56578/peet010106</article-id>
      <title-group>
        <article-title>Energy Storage Capacity Optimization of Non-Grid-Connected Wind-Hydrogen Systems: From the Perspective of Hydrogen Production Features</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <xref ref-type="aff" rid="1">1</xref>
          <name>
            <surname>Zhang</surname>
            <given-names>Xinyu</given-names>
          </name>
          <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3153-8589</contrib-id>
          <email>20201800522@imut.edu.cn</email>
        </contrib>
        <contrib contrib-type="author">
          <xref ref-type="aff" rid="2">2</xref>
          <name>
            <surname>Li</surname>
            <given-names>Hua</given-names>
          </name>
          <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6186-1400</contrib-id>
          <email>lihua1028@imut.edu.cn</email>
        </contrib>
        <contrib contrib-type="author">
          <xref ref-type="aff" rid="1">1</xref>
          <name>
            <surname>Wang</surname>
            <given-names>Jikang</given-names>
          </name>
          <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-0642-9214</contrib-id>
          <email>20201100389@imut.edu.cn</email>
        </contrib>
        <aff id="1">School of Electrical, Inner Mongolia University of Technology, 010080 Hohhot, China</aff>
        <aff id="2">School of Energy and Power Engineering, Inner Mongolia University of Technology, 010051 Hohhot, China</aff>
      </contrib-group>
      <year>2022</year>
      <volume>1</volume>
      <issue>1</issue>
      <fpage>48</fpage>
      <lpage>63</lpage>
      <page-range>48-63</page-range>
      <history>
        <date date-type="received">
          <month>06</month>
          <day>08</day>
          <year>2022</year>
        </date>
        <date date-type="accepted">
          <month>07</month>
          <day>29</day>
          <year>2022</year>
        </date>
        <date date-type="pub">
          <month>10</month>
          <day>30</day>
          <year>2022</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>©2022 by the authors</copyright-statement>
        <copyright-year>2022</copyright-year>
        <license>. Licensee Acadlore Publishing Services Limited, Hong Kong. This article can be downloaded for free, and reused and quoted with a citation of the original published version, under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 license</ext-link>.</license>
      </permissions>
      <abstract><p>This paper intends to improve the hydrogen production efficiency of the electrolysis cells, fully utilize wind energy, and ensure the reliability of power supply. For this purpose, the authors put forward a capacity optimization configuration for non-grid-connected wind-hydrogen hybrid energy storage system, in view of the features of hydrogen production efficiency. The working interval of the electrolytic cell was optimized by analyzing the said features. Considering the features of battery charge/discharge, equipment capacity and power, the authors formulated the energy management strategy applicable to six working conditions, established the quantitative multi-objective function of system cost and reliability, and solved the optimization model by the fast non-dominant sorting genetic algorithm (NSGA)-II. In this way, the optimal combination of energy storage capacity was determined. Next, the wind velocity data of a pastoral area in Inner Mongolia was measured, and analyzed in details. The analysis results show that the electrolytic cell always operates in the optimal working area, and the optimized wind-hydrogen system is economic and reliable in power supply. The research provides a reference for practical engineering applications.</p></abstract>
      <kwd-group>
        <kwd>Hydrogen production features</kwd>
        <kwd>Wind-hydrogen system</kwd>
        <kwd>Electrolytic cell</kwd>
        <kwd>Hybrid energy storage</kwd>
        <kwd>Capacity optimization</kwd>
        <kwd>Fast non-dominant sorting genetic algorithm (NSGA)-II</kwd>
      </kwd-group>
      <counts>
        <count count-type="contributors">3</count>
        <fig-count>11</fig-count>
        <table-count>4</table-count>
        <ref-count>20</ref-count>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec disp-level="level1" sec-type="intro">
      <title>1. Introduction</title>
      <p style="text-indent: 10.2pt;">Many countries are actively pursuing carbon neutrality and carbon peaking by promoting the development of hydrogen energy, which stimulates the growth of renewable energy generation. To achieve the two objectives, it is crucial to couple hydrogen energy with renewable energy, optimize the synergy of multiple energy sources for electricity and heating, promote the advances of distributed energy, make better use of terminal energy, and realize the coupling development between renewable energies (e.g., hydrogen energy and wind power).</p><p style="text-indent: 10.2pt;"> Off-grid wind power mode refers to the concept of connecting to the grid without a grid connection, eliminating the impact of wind power on the grid and realizing the efficient use of wind power [<xref ref-type="bibr" rid="ref_1">1</xref>]. The output terminal of wind power is no longer a single grid but rather an industry or other field that can adapt to the features of wind power. As a new technical solution to the issue of wind power consumption, the hybrid energy storage system formed by hydrogen storage and storage batteries under off-grid conditions can efficiently smooth out wind power fluctuations and improve the dispatchability of wind power. The related energy management strategy and capacity optimization configuration have gradually become a research hotspot, attracting the attention from most experts and scholars.</p><p style="text-indent: 10.2pt;">The research on the capacity optimization configuration and energy management strategy of wind-hydrogen hybrid energy storage systems has made some significant advancements thanks to the unceasing exploration by professionals and academics both domestically and internationally. In order to meet the national grid-connected standard and effectively smooth out wind power fluctuation, Nie et al. [<xref ref-type="bibr" rid="ref_2">2</xref>] proposed a low-pass filter-based alkaline electrolysis cell-battery hybrid energy storage configuration method and developed a hydrogen-super hybrid energy storage system control strategy based on the state of charge (SOC) of the battery. These methods do not consider the effects of load shortage rate on capacitive loads. To optimize the energy storage capacity that balances economy and reliability, Liang et al. built a grid-connected wind-hydrogen hybrid energy storage system with energy-based energy storage containing hydrogen and power-based energy storage with batteries [<xref ref-type="bibr" rid="ref_3">3</xref>], [<xref ref-type="bibr" rid="ref_4">4</xref>]. They also developed an energy management strategy, but failed to model the curtailment of wind power. Cai et al. [<xref ref-type="bibr" rid="ref_5">5</xref>] proposed an enhanced chemical reaction algorithm based on the complementing benefits of particle swarm and chemical reaction optimization methods for grid-connected wind, hydrogen, and combustion systems. </p><p style="text-indent: 10.2pt;">Based on system installation costs, load default rates, and output power fluctuations, Ma et al. [<xref ref-type="bibr" rid="ref_6">6</xref>] presented the capacity allocation for off-grid wind-hydrogen complementary systems, which effectively ensures the economy and reliability of the power supply but does not take into account the effect of operating costs on system economics. Zhang et al. [<xref ref-type="bibr" rid="ref_7">7</xref>] put forward an effective optimization algorithm for optimization and long-term capacity planning of the off-grid hybrid renewable energy system, which is made up of hydrogen storage, fuel cells, and wind power. They also suggested three improved global dynamic harmony search methods and analyzed the effects of various maximum iteration times and reliability levels on system capacity configuration. Zhang et al. [<xref ref-type="bibr" rid="ref_8">8</xref>] derived the most economically advantageous configuration for hydrogen and renewable energy scenery systems by integrating hybrid search optimization algorithms with weather forecast data. Basu et al. [<xref ref-type="bibr" rid="ref_9">9</xref>] examined the economic costs of three systems—wind-hydrogen, solar-hydrogen, and wind-solar-hydrogen—using the HOMER program, concluding that the wind-solar-hydrogen system is the most cost-effective system. Zhang et al. studied only the cost without taking the security of the power supply into account [<xref ref-type="bibr" rid="ref_8">8</xref>], [<xref ref-type="bibr" rid="ref_9">9</xref>]. This leaves out the assessment of hydrogen generation efficiency. </p><p style="text-indent: 10.2pt;">The system's safety and dependability should not be overlooked, however, as production halts and downtime brought on by a power supply that is less reliable can substantially cost consumers money and retard social and economic advancement. A problem that needs to be solved right now is how to create a fair structure for the wind-hydrogen storage system and, through capacity optimization and energy management strategies, achieve good system economy, high hydrogen production efficiency, and at the same time guarantee safe and dependable power supply.</p><p style="text-indent: 10.2pt;">In view of the above problems, this paper formulates an energy management strategy by analyzing the hydrogen production efficiency of the electrolytic cell and the charging and discharging features of the battery, and proposes an optimization method for hybrid energy storage capacity of the wind hydrogen system, in view of the hydrogen production efficiency features of the electrolytic cell. The total cost of the system, the power shortage rate of the load and the power fluctuation rate were taken as the objective functions. On this basis, the fast non-dominant sorting genetic algorithm (NSGA)-II was employed to solve the problem, and obtains an economic and reliable capacity combination, which enables the electrolyzer to operate within the optimal operating range. Simulation results show that the proposed optimization method and energy management strategy are both correct and effective.</p>
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>2. Wind-hydrogen system</title>
      <p style="text-indent: 10.2pt;">As shown in <xref ref-type="fig" rid="fig_1">Figure 1</xref>, the off-grid wind-hydrogen hybrid energy storage system consists of a wind turbine, a battery, a hydrogen storage tank, a hydrogen production system (electrolyzer), a fuel cell and a converter. Specifically, the electrolyzer dissipates excess wind power, the hydrogen fuel cell supplies energy to the outside when the wind power output is insufficient, and the battery serves as a flexible storage unit to assist the hydrogen storage for dissipating wind power and compensating for the load demand.</p>
      
        <fig id="fig_1">
          <label>Figure 1</label>
          <caption>Structure of the wind-hydrogen system</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_JFQWIinlwOGcWKUE.jpeg"/>
        </fig>
      
      
        <sec disp-level="level2">
          
            <title>2.1. Mathematical models</title>
          
          
            <sec disp-level="level3">
              
                <title>2.1. 1 Wind turbine</title>
              
              <p>Ignoring the time lag effect and wake effect of the wind farm, the output power of the wind turbine can be expressed as [<xref ref-type="bibr" rid="ref_5">5</xref>]:</p>
              
                <disp-formula>
                  <label>(1)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>w</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="center center" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <mn>0</mn>
                          </mtd>
                          <mtd>
                            <mi>V</mi>
                            <mi>V</mi>
                            <mo>&lt;</mo>
                            <mo>,</mo>
                            <mo>&gt;</mo>
                            <msub>
                              <mi>V</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>i</mi>
                                  <mi>n</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>V</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>o</mi>
                                  <mi>u</mi>
                                  <mi>t</mi>
                                </mrow>
                              </mrow>
                            </msub>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mi>N</mi>
                            </msub>
                            <mfrac>
                              <mrow>
                                <msup>
                                  <mi>V</mi>
                                  <mn>3</mn>
                                </msup>
                                <mo>−</mo>
                                <msubsup>
                                  <mi>V</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>i</mi>
                                      <mi>n</mi>
                                    </mrow>
                                  </mrow>
                                  <mn>3</mn>
                                </msubsup>
                              </mrow>
                              <mrow>
                                <msubsup>
                                  <mi>V</mi>
                                  <mi>N</mi>
                                  <mn>3</mn>
                                </msubsup>
                                <mo>−</mo>
                                <msub>
                                  <mi>V</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>i</mi>
                                      <mi>n</mi>
                                    </mrow>
                                  </mrow>
                                </msub>
                                <msup>
                                  <mrow data-mjx-texclass="ORD"/>
                                  <mn>3</mn>
                                </msup>
                              </mrow>
                            </mfrac>
                          </mtd>
                          <mtd>
                            <msub>
                              <mi>V</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>i</mi>
                                  <mi>n</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>V</mi>
                              <mi>N</mi>
                            </msub>
                            <mo>≤</mo>
                            <mo>&lt;</mo>
                            <mi>V</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mi>N</mi>
                            </msub>
                          </mtd>
                          <mtd>
                            <msub>
                              <mi>V</mi>
                              <mi>N</mi>
                            </msub>
                            <msub>
                              <mi>V</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>o</mi>
                                  <mi>u</mi>
                                  <mi>t</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <mo>≤</mo>
                            <mo>&lt;</mo>
                            <mi>V</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>where, <italic>P</italic><sub><italic>N</italic></sub> is the rated output of the wind turbine; <italic>V</italic><sub><italic>in</italic></sub><italic> </italic>is the cut-in wind velocity;<italic> V</italic><sub><italic>out</italic></sub> is the cut-out wind velocity; <italic>V</italic> is the actual wind velocity; <italic>V</italic><sub><italic>N</italic></sub><italic> </italic>is the rated wind velocity.</p>
            </sec>
          
          
            <sec disp-level="level3">
              
                <title>2.1. 2 Hydrogen energy storage system</title>
              
              <p><span style="font-family: &amp;amp;quot;Times New Roman&amp;amp;quot;;">This</span> paper develops a hydrogen storage system with polymer electrolyte membrane (PEM) electrolysis cells for hydrogen production, after selecting storage tank for gaseous pressurized hydrogen and a PEM fuel cell. Compared with the traditional alkaline electrolysis cells, the PEM electrolysis cells boast a wide load range, flexible operation and fast response. The storage of high pressure gaseous compressed hydrogen is cheaper and more efficient in conversion than the conventional storage technologies [<xref ref-type="bibr" rid="ref_10">10</xref>]. With a power density of 0.35-1.0W/cm<sup>2</sup>, PEM fuel cells can deliver greater power values per unit volume of hydrogen consumed. Hence, PEM electrolysis cells are the most suitable power generation device for hydrogen production and storage systems.</p><p>The electrolysis cells use excess wind power to produce hydrogen. The amount <italic>Q</italic><sub><italic>el</italic></sub> of hydrogen produced by the electrolysis cells (<italic>Nm</italic><sup><italic>3</italic></sup>) can be calculated by:</p>
              
                <disp-formula>
                  <label>(2)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>η</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mo>×</mo>
                    <mo>×</mo>
                    <mi>ρ</mi>
                  </math>
                </disp-formula>
              
              <p>where, <italic>P</italic><sub><italic>el</italic></sub><sub> </sub>is the input power of the electrolysis cells; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>η</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>e</mi>
        <mi>l</mi>
      </mrow>
    </msub>
  </math>
</inline-formula><sub> </sub>is the efficiency of the electrolysis cells; <italic>ρ</italic><sub> </sub>is the amount of hydrogen produced per 1 <italic>kWh</italic> electrical energy (0.22<italic> Nm</italic><sup><italic>3</italic></sup><italic>/ kWh</italic>).</p><p>The output power of the fuel cells can be calculated by:</p>
              
                <disp-formula>
                  <label>(3)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>f</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>η</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>f</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mo>⋅</mo>
                    <mfrac>
                      <msub>
                        <mi>Q</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>f</mi>
                          <mi>c</mi>
                        </mrow>
                      </msub>
                      <mi>μ</mi>
                    </mfrac>
                  </math>
                </disp-formula>
              
              <p>where, <italic>Q</italic><sub><italic>fc </italic></sub>is the amount of hydrogen input to the fuel cell,<italic> Nm</italic><sup><italic>3</italic></sup>; <sub><inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>η</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>f</mi>
        <mi>c</mi>
      </mrow>
    </msub>
  </math>
</inline-formula></sub><sub><italic> </italic></sub>is the fuel cell efficiency; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <mi>μ</mi>
  </math>
</inline-formula> is the amount of hydrogen required to produce 1<italic>kWh</italic> electrical energy (0.6434<italic> Nm</italic><sup><italic>3</italic></sup><italic>/ kWh</italic>).</p><p>The hydrogen storage capacity of the storage tank can be calculated by:</p>
              
                <disp-formula>
                  <label>(4)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mo stretchy="false">(</mo>
                    <mo>−</mo>
                    <mo stretchy="false">)</mo>
                    <mo>+</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>−</mo>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>t</mi>
                    <mn>1</mn>
                    <mfrac>
                      <mrow>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>f</mi>
                            <mi>c</mi>
                          </mrow>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mo>⋅</mo>
                        <mo>⋅</mo>
                        <mi>t</mi>
                        <mi>μ</mi>
                        <mi mathvariant="normal">Δ</mi>
                        <mi>t</mi>
                      </mrow>
                      <mrow>
                        <msub>
                          <mi>η</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>f</mi>
                            <mi>c</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>η</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>h</mi>
                            <mi>t</mi>
                          </mrow>
                        </msub>
                        <mo>⋅</mo>
                      </mrow>
                    </mfrac>
                  </math>
                </disp-formula>
              
              <p>where, <italic>Q</italic><sub><italic>ht</italic></sub>(<italic>t</italic>) is the amount of hydrogen in the storage tank at time <italic>t</italic>; <italic>Q</italic><sub><italic>el</italic></sub>(<italic>t</italic>)<italic> </italic>is the amount of hydrogen produced by the electrolysis cells at time <italic>t</italic>; <italic>P</italic><sub><italic>fc</italic></sub>(<italic>t</italic>) is the fuel cell output at time <italic>t</italic>; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>η</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>h</mi>
        <mi>t</mi>
      </mrow>
    </msub>
  </math>
</inline-formula> is the storage efficiency of the storage tank; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <mi mathvariant="normal">Δ</mi>
    <mi>t</mi>
  </math>
</inline-formula> is the sampling interval.</p><p>The SOC of the hydrogen energy storage can be expressed as:</p>
              
                <disp-formula>
                  <label>(5)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mrow data-mjx-texclass="ORD">
                        <mi>S</mi>
                        <mi>O</mi>
                        <mi>C</mi>
                      </mrow>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                        <mi>m</mi>
                        <mi>a</mi>
                        <mi>x</mi>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mo>/</mo>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>where, <italic>Q</italic><sub><italic>htmax</italic></sub> is the maximum storage capacity of the hydrogen tank.</p>
            </sec>
          
          
            <sec disp-level="level3">
              
                <title>2.1. 3 Battery model</title>
              
              <p>As an auxiliary energy storage for the wind-hydrogen system, the battery not only helps the hydrogen storage stabilize wind power fluctuations and address the issue of wind curtailment, but also provides the electrolyzer with power when the remaining wind power is below the minimum input power that the electrolyzer can accept, allowing it to function at its best.</p><p>The SOC of a battery can be expressed as:</p>
              
                <disp-formula>
                  <label>(6)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="ORD">
                      <mi>S</mi>
                      <mi>O</mi>
                      <mi>C</mi>
                    </mrow>
                    <mrow data-mjx-texclass="ORD">
                      <mo>/</mo>
                    </mrow>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mi>t</mi>
                    <mi>t</mi>
                    <msub>
                      <mi>E</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>s</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>E</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>s</mi>
                        <mi>c</mi>
                        <mi>m</mi>
                        <mi>a</mi>
                        <mi>x</mi>
                      </mrow>
                    </msub>
                  </math>
                </disp-formula>
              
              <p>where, <italic>E</italic><sub><italic>sc</italic></sub>(<italic>t</italic>) and <italic>E</italic><sub><italic>scmax</italic></sub> are the remaining charge and the maximum charge of the battery at the current moment, respectively. As charging and discharging proceeds, the SOC of the battery rises or falls according to the following relationship:</p>
              
                <disp-formula>
                  <label>(7)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <mrow data-mjx-texclass="ORD">
                              <mi>S</mi>
                              <mi>O</mi>
                              <mi>C</mi>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>S</mi>
                              <mi>O</mi>
                              <mi>C</mi>
                            </mrow>
                            <mo stretchy="false">(</mo>
                            <mo>=</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo stretchy="false">)</mo>
                            <mo>⋅</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo>+</mo>
                            <mi>t</mi>
                            <mi mathvariant="normal">Δ</mi>
                            <mi>t</mi>
                            <msub>
                              <mo stretchy="false">)</mo>
                              <mn>1</mn>
                            </msub>
                            <msub>
                              <mo stretchy="false">)</mo>
                              <mn>1</mn>
                            </msub>
                            <mn>1</mn>
                            <mn>1</mn>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>c</mi>
                                    <mi>h</mi>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi mathvariant="normal">Δ</mi>
                                  <mi>t</mi>
                                </msub>
                                <msub>
                                  <mi>η</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>c</mi>
                                    <mi>h</mi>
                                  </mrow>
                                </msub>
                                <mo>⋅</mo>
                                <mo>⋅</mo>
                              </mrow>
                              <msub>
                                <mi>E</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>s</mi>
                                  <mi>c</mi>
                                </mrow>
                              </msub>
                            </mfrac>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mrow data-mjx-texclass="ORD">
                              <mi>S</mi>
                              <mi>O</mi>
                              <mi>C</mi>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>S</mi>
                              <mi>O</mi>
                              <mi>C</mi>
                            </mrow>
                            <mo stretchy="false">(</mo>
                            <mo>=</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo stretchy="false">)</mo>
                            <mo>⋅</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo>+</mo>
                            <mi>t</mi>
                            <mi mathvariant="normal">Δ</mi>
                            <mi>t</mi>
                            <msub>
                              <mo stretchy="false">)</mo>
                              <mn>2</mn>
                            </msub>
                            <msub>
                              <mo stretchy="false">)</mo>
                              <mn>2</mn>
                            </msub>
                            <mn>1</mn>
                            <mn>1</mn>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>d</mi>
                                    <mi>i</mi>
                                    <mi>s</mi>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi mathvariant="normal">Δ</mi>
                                  <mi>t</mi>
                                </msub>
                                <msub>
                                  <mi>η</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>d</mi>
                                    <mi>i</mi>
                                    <mi>s</mi>
                                  </mrow>
                                </msub>
                                <mo>⋅</mo>
                                <mo>⋅</mo>
                              </mrow>
                              <msub>
                                <mi>E</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>s</mi>
                                  <mi>c</mi>
                                </mrow>
                              </msub>
                            </mfrac>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>where, <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <mi mathvariant="normal">Δ</mi>
  </math>
</inline-formula> is the self-discharge rate of the battery, 0.01; <italic>SOC</italic>(<italic>t</italic>)<sub>1 </sub>and <italic>SOC</italic>(<italic>t</italic>)<sub>2 </sub>are the <italic>SOC</italic> values of the battery during charging and discharging, respectively; <italic>P</italic><sub><italic>ch</italic></sub><sub> </sub>and <italic>P</italic><sub><italic>dis</italic></sub> are the charging and discharging powers, respectively; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>η</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>c</mi>
        <mi>h</mi>
      </mrow>
    </msub>
  </math>
</inline-formula><sub> </sub>and <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>η</mi>
      <mrow data-mjx-texclass="ORD">
        <mrow data-mjx-texclass="ORD">
          <mi>d</mi>
          <mi>i</mi>
          <mi>s</mi>
        </mrow>
      </mrow>
    </msub>
  </math>
</inline-formula> are the charging and discharging efficiencies of the battery, respectively; <italic>E</italic><sub><italic>sc</italic></sub><sub> </sub>is the rated capacity of the battery; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi mathvariant="normal">Δ</mi>
      <mi>t</mi>
    </msub>
  </math>
</inline-formula> is the charging or discharging interval of the battery.</p>
            </sec>
          
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>2.2. Efficiency features of electrolysis cell</title>
          
          <p>PEM electrolysis cells are well adapted to the fluctuations of wind power and can operate in the load range of 5 to 120%, whereas wind power resources are highly volatile and stochastic, leading to unstable wind power production [<xref ref-type="bibr" rid="ref_11">11</xref>]. The electrolytic cell's unit current density is correlated with the hydrogen production efficiency. The higher the unit current density when electrolyzing water, the better the hydrogen production efficiency. The electrolysis cell's hydrogen production efficiency features need to be examined in order to establish its ideal operating interval.</p><p>The water electrolysis voltage of a PEM electrolysis cell depends on the unit current density during the electrolysis of water at a specific temperature and pressure [<xref ref-type="bibr" rid="ref_12">12</xref>]:</p>
          
            <disp-formula>
              <label>(8)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="ORD">
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>e</mi>
                      <mi>l</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mo stretchy="false">)</mo>
                  <mrow data-mjx-texclass="ORD">
                    <mi>T</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>P</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>j</mi>
                  </mrow>
                </mrow>
                <mrow data-mjx-texclass="ORD">
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>r</mi>
                      <mi>e</mi>
                      <mi>v</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mo stretchy="false">)</mo>
                  <mrow data-mjx-texclass="ORD">
                    <mi>T</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>P</mi>
                  </mrow>
                </mrow>
                <mrow data-mjx-texclass="ORD">
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>o</mi>
                      <mi>h</mi>
                      <mi>m</mi>
                    </mrow>
                  </msub>
                </mrow>
                <mrow data-mjx-texclass="ORD">
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>h</mi>
                      <mn>2</mn>
                    </mrow>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mrow data-mjx-texclass="ORD">
                    <mi>T</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>P</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>j</mi>
                  </mrow>
                </mrow>
                <mrow data-mjx-texclass="ORD">
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>o</mi>
                      <mn>2</mn>
                    </mrow>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mrow data-mjx-texclass="ORD">
                    <mi>T</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>P</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo>,</mo>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>j</mi>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mo>+</mo>
                <mo stretchy="false">(</mo>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <mo stretchy="false">)</mo>
                <mi>j</mi>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(9)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mtable columnalign="" columnspacing="1em" rowspacing="4pt">
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>r</mi>
                            <mi>e</mi>
                            <mi>v</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>log</mi>
                          <mi>e</mi>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo>,</mo>
                        <mo stretchy="false">)</mo>
                        <mo>=</mo>
                        <mo>−</mo>
                        <mo>×</mo>
                        <mo>+</mo>
                        <mo>×</mo>
                        <mo data-mjx-texclass="NONE">⁡</mo>
                        <mo>+</mo>
                        <mo>×</mo>
                        <mi>T</mi>
                        <mi>P</mi>
                        <mi>T</mi>
                        <mi>T</mi>
                        <mi>T</mi>
                        <mn>1.5184</mn>
                        <mn>1.5421</mn>
                        <mn>9.523</mn>
                        <mn>9.84</mn>
                        <msup>
                          <mn>10</mn>
                          <mrow data-mjx-texclass="ORD">
                            <mo>−</mo>
                            <mn>3</mn>
                          </mrow>
                        </msup>
                        <msup>
                          <mn>10</mn>
                          <mrow data-mjx-texclass="ORD">
                            <mo>−</mo>
                            <mn>5</mn>
                          </mrow>
                        </msup>
                        <msup>
                          <mn>10</mn>
                          <mrow data-mjx-texclass="ORD">
                            <mo>−</mo>
                            <mn>8</mn>
                          </mrow>
                        </msup>
                        <msup>
                          <mi>T</mi>
                          <mn>2</mn>
                        </msup>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>o</mi>
                            <mi>h</mi>
                            <mi>m</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>R</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mo>=</mo>
                        <mi>j</mi>
                        <mi>j</mi>
                        <munderover>
                          <mo data-mjx-texclass="OP">∑</mo>
                          <mrow data-mjx-texclass="ORD">
                            <mi>i</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>n</mi>
                        </munderover>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>h</mi>
                            <mn>2</mn>
                          </mrow>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo>,</mo>
                        <mo>,</mo>
                        <mo stretchy="false">)</mo>
                        <mo>=</mo>
                        <mo data-mjx-texclass="NONE">⁡</mo>
                        <mi>T</mi>
                        <mi>P</mi>
                        <mi>j</mi>
                        <mi>ln</mi>
                        <mfrac>
                          <mrow>
                            <mi>R</mi>
                            <mi>T</mi>
                          </mrow>
                          <mrow>
                            <msub>
                              <mi>α</mi>
                              <mi>c</mi>
                            </msub>
                            <msub>
                              <mi>n</mi>
                              <mi>c</mi>
                            </msub>
                            <mi>F</mi>
                          </mrow>
                        </mfrac>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <mfrac>
                            <mi>j</mi>
                            <msub>
                              <mi>j</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi data-mjx-auto-op="false">co</mi>
                                </mrow>
                              </mrow>
                            </msub>
                          </mfrac>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>o</mi>
                            <mn>2</mn>
                          </mrow>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo>,</mo>
                        <mo>,</mo>
                        <mo stretchy="false">)</mo>
                        <mo>=</mo>
                        <mo data-mjx-texclass="NONE">⁡</mo>
                        <mi>T</mi>
                        <mi>P</mi>
                        <mi>j</mi>
                        <mi>ln</mi>
                        <mfrac>
                          <mrow>
                            <mi>R</mi>
                            <mi>T</mi>
                          </mrow>
                          <mrow>
                            <msub>
                              <mi>α</mi>
                              <mi>a</mi>
                            </msub>
                            <msub>
                              <mi>n</mi>
                              <mi>a</mi>
                            </msub>
                            <mi>F</mi>
                          </mrow>
                        </mfrac>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <mfrac>
                            <mi>j</mi>
                            <msub>
                              <mi>j</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi data-mjx-auto-op="false">ao</mi>
                                </mrow>
                              </mrow>
                            </msub>
                          </mfrac>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </math>
            </disp-formula>
          
          <p>where, <italic>j</italic> is the unit current density of the electrolyzer; <italic>U</italic><sub><italic>rev</italic></sub>(<italic>T</italic>,<italic>P</italic>) is the reversible voltage required by the electorlyer to electrolyze water; <italic>U</italic><sub><italic>ohm</italic></sub>(<italic>j</italic>) is the pressure drop caused by the surface resistance of the electrolyzer; <italic>U</italic><sub><italic>h</italic></sub><sub>2</sub>(<italic>T,P,J</italic>) and <italic>U</italic><sub><italic>o</italic></sub><sub>2</sub>(<italic>T,P,J</italic>) are the hydrogen and oxygen superpotentials generated during water electrolysis, respectively; <italic>F</italic> is the Faraday constant; <italic>R</italic><sub><italic>i</italic></sub><sub> </sub>is the surface resistance of the <italic>i</italic>-th cell component; <italic>R</italic> is the ideal gas constant; <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>α</mi>
      <mi>c</mi>
    </msub>
  </math>
</inline-formula> and <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>α</mi>
      <mi>a</mi>
    </msub>
  </math>
</inline-formula> are the charge transfer coefficients of the cathode and anode, respectively; <italic>n</italic><sub><italic>c </italic></sub>and <italic>n</italic><sub><italic>a</italic></sub><sub> </sub>are the electron transfer numbers of the cathode and anode, respectively; <italic>j</italic><sub><italic>co</italic></sub> and <italic>j</italic><sub><italic>ao</italic></sub> are the exchange current densities of the cathode and anode, respectively.</p><p>The voltage efficiency of an electrolysis bath is the ratio of the theoretical decomposition voltage to the actual decomposition voltage of water. The water electrolysis is heated up by electrical energy. Thus, the theoretical decomposition voltage is replaced by the thermal neutral voltage. Thus, the voltage efficiency can be expressed as:</p>
          
            <disp-formula>
              <label>(10)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>η</mi>
                  <mi>v</mi>
                </msub>
                <mo>=</mo>
                <mo>×</mo>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>t</mi>
                      <mi>n</mi>
                    </mrow>
                  </msub>
                  <msub>
                    <mi>U</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>e</mi>
                      <mi>l</mi>
                    </mrow>
                  </msub>
                  <mrow data-mjx-texclass="ORD">
                    <mo>/</mo>
                  </mrow>
                </mrow>
                <mn>100</mn>
                <mi mathvariant="normal">%</mi>
              </math>
            </disp-formula>
          
          <p>The relationship between power and the amount of hydrogen generated is not adequately depicted by an electrolyzer's voltage efficiency, which simply measures how effectively electrical energy is utilized by the electrolyzer [<xref ref-type="bibr" rid="ref_13">13</xref>]. Both voltage efficiency and current efficiency are related to the efficiency of hydrogen production in an electrolyzer. At various pressures and temperatures, the electrolytic cell's current efficiency varies. The current efficiency (Faraday efficiency) of the electrolyer, under constant temperature and pressure, can be expressed as:</p>
          
            <disp-formula>
              <label>(11)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>η</mi>
                  <mi>i</mi>
                </msub>
                <mo>=</mo>
                <mn>96.5</mn>
                <msup>
                  <mi>e</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mn>0.09</mn>
                    <mn>75.5</mn>
                    <mrow data-mjx-texclass="ORD">
                      <mo>/</mo>
                    </mrow>
                    <mrow data-mjx-texclass="ORD">
                      <mo>/</mo>
                    </mrow>
                    <msub>
                      <mi>I</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <mo>−</mo>
                    <msubsup>
                      <mi>I</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                </msup>
              </math>
            </disp-formula>
          
          <p>where, <italic>I</italic><sub><italic>el </italic></sub>is the stack current of the electrolyzer, <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>I</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>e</mi>
        <mi>l</mi>
      </mrow>
    </msub>
    <mo>=</mo>
    <mo>⋅</mo>
    <mi>A</mi>
    <mi>j</mi>
  </math>
</inline-formula>, with <italic>A</italic> being the cross-sectional area of the electrolyzer.</p><p>The hydrogen production efficiency of the electrolysis tank can be expressed as:</p>
          
            <disp-formula>
              <label>(12)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>η</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>e</mi>
                    <mi>l</mi>
                  </mrow>
                </msub>
                <msub>
                  <mi>η</mi>
                  <mi>v</mi>
                </msub>
                <msub>
                  <mi>η</mi>
                  <mi>i</mi>
                </msub>
                <mo>=</mo>
                <mo>⋅</mo>
              </math>
            </disp-formula>
          
          <p>The parameters of electrolysis cell are listed in <xref ref-type="table" rid="table_1">Table 1</xref> [<xref ref-type="bibr" rid="ref_14">14</xref>]:</p>
          
            <table-wrap id="table_1">
              <label>Table 1</label>
              <caption>Parameters of electrolyzer</caption>
              <abstract/>
              <table><tbody><tr><td colspan="1" rowspan="1"><p>Parameters</p></td><td colspan="1" rowspan="1"><p>Values</p></td></tr><tr><td colspan="1" rowspan="1"><p>Operating temperature <italic>T</italic>/<italic>K</italic></p></td><td colspan="1" rowspan="1"><p>353.15</p></td></tr><tr><td colspan="1" rowspan="1"><p>Pressure <italic>P</italic>/<italic>Pa</italic></p></td><td colspan="1" rowspan="1"><p>1.01×10<sup>5</sup></p></td></tr><tr><td colspan="1" rowspan="1"><p>Thermally neutral voltage <italic>U<sub>tn</sub></italic>/<italic>V</italic></p></td><td colspan="1" rowspan="1"><p>1.48</p></td></tr><tr><td colspan="1" rowspan="1"><p>Unit current density <italic>j</italic>/<italic>A·cm</italic><sup>-2</sup></p></td><td colspan="1" rowspan="1"><p>0~2</p></td></tr><tr><td colspan="1" rowspan="1"><p>Surface resistance <math>
  <msub>
    <mi>R</mi>
    <mi>i</mi>
  </msub>
  <mrow data-mjx-texclass="ORD">
    <mo>/</mo>
  </mrow>
  <mi>m</mi>
  <mi mathvariant="normal">Ω</mi>
</math></p></td><td colspan="1" rowspan="1"><p>26.8</p></td></tr><tr><td colspan="1" rowspan="1"><p>Cross-sectional area <italic>A</italic>/<italic>cm</italic><sup>2</sup></p></td><td colspan="1" rowspan="1"><p>50</p></td></tr><tr><td colspan="1" rowspan="1"><p>Faraday constant <italic>F</italic>/<italic>C·mol</italic><sup>-1</sup></p></td><td colspan="1" rowspan="1"><p>96485.3</p></td></tr><tr><td colspan="1" rowspan="1"><p>Ideal gas constant <italic>R/J·mol</italic><sup>-1</sup><italic>·K</italic><sup>-1</sup></p></td><td colspan="1" rowspan="1"><p>8.31446</p></td></tr><tr><td colspan="1" rowspan="1"><p>Cathode charge transfer coefficient <math>
  <msub>
    <mi>α</mi>
    <mi>c</mi>
  </msub>
</math></p></td><td colspan="1" rowspan="1"><p>0.71</p></td></tr><tr><td colspan="1" rowspan="1"><p>Anode charge transfer coefficient <math>
  <msub>
    <mi>α</mi>
    <mi>a</mi>
  </msub>
</math></p></td><td colspan="1" rowspan="1"><p>0.29</p></td></tr><tr><td colspan="1" rowspan="1"><p>Cathode exchange current density <italic>j<sub>co</sub></italic>/<italic>mA·cm</italic><sup>-2</sup></p></td><td colspan="1" rowspan="1"><p>24.6</p></td></tr><tr><td colspan="1" rowspan="1"><p>Anode exchange current density <italic>j<sub>ao</sub></italic>/<italic>mA·cm</italic><sup>-2</sup></p></td><td colspan="1" rowspan="1"><p>24.1</p></td></tr><tr><td colspan="1" rowspan="1"><p>Electron transfer numbers <italic>n<sub>c,</sub>n<sub>a</sub></italic></p></td><td colspan="1" rowspan="1"><p>2</p></td></tr></tbody></table>
            </table-wrap>
          
          
            <fig id="fig_2">
              <label>Figure 2</label>
              <caption>Efficiency feature curve of hydrogen production</caption>
              <abstract/>
              <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_W1ec_kZ3fkepK0_4.jpeg"/>
            </fig>
          
          <p>The relationship between the input power (the nominal value) and the hydrogen generation efficiency in an electrolysis cell was established by Eqns. (8)-(12). The hydrogen production efficiency in the electrolysis cell reached 81.69%, as shown in <xref ref-type="fig" rid="fig_2">Figure 2</xref>, and it was favorably associated with the initial input power, peaking at about 0.3. When the input power reached its rated power, the electrolysis cell's efficiency was about 65%. As the input power rose further, the efficiency of the electrolysis cell gradually declined. When running at lower loads compared to the rated load, the water electrolysis system's electrolysis cell section can drastically cut energy usage and boost hydrogen production efficiency. The efficiency of the electrolysis cell is low and the amount of hydrogen produced is limited when the electrolysis cell is run at a low load factor of 0-20%. The ideal working range of the electrolysis cell is chosen at 30 to 100% of the rated power, taking into account the coupling relationship between hydrogen production efficiency and input power.</p>
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>2.3. Energy management strategy</title>
          
          <p>The energy management approach depicted in <xref ref-type="fig" rid="fig_3">Figure 3</xref> was devised, in the light of the battery's charging and discharging capabilities and the working interval of the hydrogen generation process. <xref ref-type="fig" rid="fig_3">Figure 3</xref> describes the electrolytic cell, battery, and fuel cell processes under the six operating conditions of the system mathematically.</p>
          
            <fig id="fig_3">
              <label>Figure 3</label>
              <caption>Energy management strategy</caption>
              <abstract/>
              <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_bCEOUcy_G1fvkyzQ.jpeg"/>
            </fig>
          
          <p style="text-indent: 10pt;">For a given sampling interval, the net output power of the system can be described by:</p>
          
            <disp-formula>
              <label>(13)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>n</mi>
                    <mi>e</mi>
                    <mi>t</mi>
                  </mrow>
                </msub>
                <msub>
                  <mi>P</mi>
                  <mi>w</mi>
                </msub>
                <msub>
                  <mi>P</mi>
                  <mi>l</mi>
                </msub>
                <mo>=</mo>
                <mo>−</mo>
              </math>
            </disp-formula>
          
          <p style="text-indent: 10pt;"><span style="font-family: 宋体;">T</span>he lower and upper limits of the optimum operating interval of the electrolytic cell are denoted by <italic>P</italic><sub><italic>el-min</italic></sub> and <italic>P</italic><sub><italic>el-min</italic></sub>, respectively; the maximum allowable charge and discharge power of the battery are denoted by <italic>P</italic><sub><italic>chmax</italic></sub> and <italic>P</italic><sub><italic>chmin</italic></sub>, respectively.</p>
          
            <sec disp-level="level3">
              
                <title>2.3. 1 Absorption of curtailed wind</title>
              
              <p>The electrolysis cell produces hydrogen, or the battery charges and the fuel cell is out of service, when the net power is more than 0 (load demand is less than the amount of wind energy produced).</p><p>Mode 1: The system functions in mode 1 when the net power is lower than the maximum permitted battery charge power. In this case, the battery is charged normally and both the electrolytic cell and fuel cell are out of service. Then, the charging power of the batteries can be calculated by:</p>
              
                <disp-formula>
                  <label>(14)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>n</mi>
                        <mi>e</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>c</mi>
                        <mi>h</mi>
                        <mi>m</mi>
                        <mi>a</mi>
                        <mi>x</mi>
                      </mrow>
                    </msub>
                    <mo>≤</mo>
                  </math>
                </disp-formula>
              
              
                <disp-formula>
                  <label>(15)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>s</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>n</mi>
                        <mi>e</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                  </math>
                </disp-formula>
              
              <p>Mode 2: When the system satisfies Eq. (16), the input power of the electrolytic cell and the charging power of the battery satisfy Eq. (17):</p>
              
                <disp-formula>
                  <label>(16)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>n</mi>
                          <mi>e</mi>
                          <mi>t</mi>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>c</mi>
                          <mi>h</mi>
                          <mi>m</mi>
                          <mi>a</mi>
                          <mi>x</mi>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                        <mi>m</mi>
                        <mi>i</mi>
                        <mi>n</mi>
                        <mo>−</mo>
                      </mrow>
                    </msub>
                    <mo>−</mo>
                    <mo>&lt;</mo>
                  </math>
                </disp-formula>
              
              
                <disp-formula>
                  <label>(17)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                                <mi>m</mi>
                                <mi>i</mi>
                                <mi>n</mi>
                                <mo>−</mo>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>n</mi>
                                <mi>e</mi>
                                <mi>t</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                                <mi>m</mi>
                                <mi>i</mi>
                                <mi>n</mi>
                                <mo>−</mo>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>−</mo>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>At this point, the electrolyzer is producing hydrogen at the minimum allowable input power. The charging and discharging of the battery depend on the difference between the net power of the system and the minimum allowable input power of the electrolyzer during this sampling interval. If <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>P</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>n</mi>
        <mi>e</mi>
        <mi>t</mi>
      </mrow>
    </msub>
    <msub>
      <mi>P</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>e</mi>
        <mi>l</mi>
        <mi>m</mi>
        <mi>i</mi>
        <mi>n</mi>
        <mo>−</mo>
      </mrow>
    </msub>
    <mo>−</mo>
  </math>
</inline-formula>, the battery is charged; If <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>P</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>n</mi>
        <mi>e</mi>
        <mi>t</mi>
      </mrow>
    </msub>
    <msub>
      <mi>P</mi>
      <mrow data-mjx-texclass="ORD">
        <mi>e</mi>
        <mi>l</mi>
        <mi>m</mi>
        <mi>i</mi>
        <mi>n</mi>
        <mo>−</mo>
      </mrow>
    </msub>
    <mo>−</mo>
  </math>
</inline-formula>, the battery is discharged to assist the electrolyzer in producing hydrogen at the minimum allowable input power.</p><p>Mode 3: When the system satisfies Eq. (18), the input power of the electrolytic cell and the charging power of the battery satisfy Eq. (19): </p>
              
                <disp-formula>
                  <label>(18)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>e</mi>
                          <mi>l</mi>
                          <mi>m</mi>
                          <mi>i</mi>
                          <mi>n</mi>
                          <mo>−</mo>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>n</mi>
                          <mi>e</mi>
                          <mi>t</mi>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>c</mi>
                          <mi>h</mi>
                          <mi>m</mi>
                          <mi>a</mi>
                          <mi>x</mi>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>e</mi>
                          <mi>l</mi>
                          <mi>m</mi>
                          <mi>a</mi>
                          <mi>x</mi>
                          <mo>−</mo>
                        </mrow>
                      </mrow>
                    </msub>
                    <mo>≤</mo>
                    <mo>−</mo>
                    <mo>≤</mo>
                  </math>
                </disp-formula>
              
              
                <disp-formula>
                  <label>(19)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>n</mi>
                                  <mi>e</mi>
                                  <mi>t</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>c</mi>
                                <mi>h</mi>
                                <mi>m</mi>
                                <mi>a</mi>
                                <mi>x</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>−</mo>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>c</mi>
                                  <mi>h</mi>
                                  <mi>m</mi>
                                  <mi>a</mi>
                                  <mi>x</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>In this case, the electrolytic cell operates within the optimal interval, and the battery is charged at the maximum allowable charging power.</p><p>Mode 4: When the system satisfies Eq. (20), the input power of the electrolytic cell, the charging power of the battery and the curtailed wind power of the wind farm satisfy Eq. (21):</p>
              
                <disp-formula>
                  <label>(20)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>n</mi>
                        <mi>e</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>c</mi>
                          <mi>h</mi>
                          <mi>m</mi>
                          <mi>a</mi>
                          <mi>x</mi>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>e</mi>
                          <mi>l</mi>
                        </mrow>
                        <mo>−</mo>
                        <mi>m</mi>
                        <mi>a</mi>
                        <mi>x</mi>
                      </mrow>
                    </msub>
                    <mo>−</mo>
                    <mo>&gt;</mo>
                  </math>
                </disp-formula>
              
              
                <disp-formula>
                  <label>(21)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                                <mi>m</mi>
                                <mi>a</mi>
                                <mi>x</mi>
                                <mo>−</mo>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>c</mi>
                                <mi>h</mi>
                                <mi>m</mi>
                                <mi>a</mi>
                                <mi>x</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>q</mi>
                                <mi>f</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>n</mi>
                                <mi>e</mi>
                                <mi>t</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>−</mo>
                            <mo>−</mo>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>In this case, the electrolyzer operates at the rated input power, the battery is charged at the maximum allowable charging power, and the excess wind power is curtailed.</p>
            </sec>
          
          
            <sec disp-level="level3">
              
                <title>2.3. 2 Energy storage systems during discharge</title>
              
              <p>When the net power is less than 0 (wind power output is less than the load demand), the electrolysis cell is shut down and the battery and fuel cell are discharged.</p><p>Mode 5: When the system satisfies Eq. (22), the fuel cell is out of service and the battery is discharged normally. The discharge power can be expressed by Eq. (23):</p>
              
                <disp-formula>
                  <label>(22)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">|</mo>
                      <mo data-mjx-texclass="CLOSE">|</mo>
                      <msub>
                        <mi>P</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mrow data-mjx-texclass="ORD">
                            <mi>n</mi>
                            <mi>e</mi>
                            <mi>t</mi>
                          </mrow>
                        </mrow>
                      </msub>
                    </mrow>
                    <mo>≤</mo>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>d</mi>
                          <mi>i</mi>
                          <mi>s</mi>
                          <mi>m</mi>
                          <mi>a</mi>
                          <mi>x</mi>
                        </mrow>
                      </mrow>
                    </msub>
                  </math>
                </disp-formula>
              
              
                <disp-formula>
                  <label>(23)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>s</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">|</mo>
                      <mo data-mjx-texclass="CLOSE">|</mo>
                      <msub>
                        <mi>P</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>n</mi>
                          <mi>e</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>Model 6: When the system satisfies Eq. (24), the battery, fuel cell discharge power and system deficit power can be expressed by Eq. (25):</p>
              
                <disp-formula>
                  <label>(24)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">|</mo>
                      <mo data-mjx-texclass="CLOSE">|</mo>
                      <msub>
                        <mi>P</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mrow data-mjx-texclass="ORD">
                            <mi>n</mi>
                            <mi>e</mi>
                            <mi>t</mi>
                          </mrow>
                        </mrow>
                      </msub>
                    </mrow>
                    <mo>&gt;</mo>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>d</mi>
                          <mi>i</mi>
                          <mi>s</mi>
                          <mi>m</mi>
                          <mi>a</mi>
                          <mi>x</mi>
                        </mrow>
                      </mrow>
                    </msub>
                  </math>
                </disp-formula>
              
              
                <disp-formula>
                  <label>(25)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mi>i</mi>
                                  <mi>s</mi>
                                  <mi>m</mi>
                                  <mi>a</mi>
                                  <mi>x</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <msub>
                                  <mi>f</mi>
                                  <mi>c</mi>
                                </msub>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>−</mo>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">|</mo>
                              <mo data-mjx-texclass="CLOSE">|</mo>
                              <msub>
                                <mi>P</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>n</mi>
                                  <mi>e</mi>
                                  <mi>t</mi>
                                </mrow>
                              </msub>
                            </mrow>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>q</mi>
                                <mi>e</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>f</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>−</mo>
                            <mo>−</mo>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">|</mo>
                              <mo data-mjx-texclass="CLOSE">|</mo>
                              <msub>
                                <mi>P</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>n</mi>
                                  <mi>e</mi>
                                  <mi>t</mi>
                                </mrow>
                              </msub>
                            </mrow>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
              <p>In this case, the battery discharges first at the maximum allowable discharge power and the fuel cell discharges subsequently. The power shortage will ensue, for the battery and fuel cell are limited in capacity, and there is an imbalance between supply and demand.</p>
            </sec>
          
        </sec>
      
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>3. Capacity optimization model</title>
      
        <sec disp-level="level2">
          
            <title>3.1. Objective function</title>
          
          <p style="text-indent: 10.2pt;">Consdiering the need to meet the demand for wind power disposal and smooth power supply, the capacity of hydrogen storage and storage batteries in the system should be configured to maximize the economy of the system, and to ensure the reliability of the power supply. In this paper, the capacity optimization model is solved through optimization, followed by decision-making. In this case, the total cost and reliability indicator have the same weight, and the capacity of each part of the energy storage device is determined by the principle of compromise.</p>
          
            <sec disp-level="level3">
              
                <title>3.1. 1 Economic cost analysis</title>
              
              <p>The total cost of hybrid energy storage can be expressed as:</p>
              
                <disp-formula>
                  <label>(26)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi>T</mi>
                          <mi>o</mi>
                          <mi>t</mi>
                          <mi>a</mi>
                          <mi>l</mi>
                        </mrow>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>I</mi>
                        <mi>N</mi>
                        <mi>V</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">O</mi>
                        </mrow>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">M</mi>
                        </mrow>
                        <mi mathvariant="normal">&amp;</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>R</mi>
                        <mi>E</mi>
                        <mi>P</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>Q</mi>
                        <mi>F</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mo>+</mo>
                    <mo>+</mo>
                    <mo>+</mo>
                  </math>
                </disp-formula>
              
              <p>where, <italic>C</italic><sub><italic>INV</italic></sub><sub> </sub>is the initial investment cost of the system; <italic>C</italic><sub><italic>O&amp;amp;M</italic></sub><sub> </sub>is the operation and maintenance cost of the system; <italic>C</italic><sub><italic>REP</italic></sub><sub> </sub>is the replacement cost of the system equipment; <italic>C</italic><sub><italic>QF</italic></sub> is the cost of system wind curtailment. The initial investment cost of the system can be expressed as:</p>
              
                <disp-formula>
                  <label>(27)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>I</mi>
                        <mi>N</mi>
                        <mi>V</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>E</mi>
                        <mi>L</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>K</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>E</mi>
                        <mi>L</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>S</mi>
                        <mi>C</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>K</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>S</mi>
                        <mi>C</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>H</mi>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>K</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>H</mi>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>F</mi>
                        <mi>C</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>K</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>F</mi>
                        <mi>C</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mo>×</mo>
                    <mo>+</mo>
                    <mo>×</mo>
                    <mo>+</mo>
                    <mo>×</mo>
                    <mo>+</mo>
                    <mo>×</mo>
                  </math>
                </disp-formula>
              
              <p>where, <italic>C</italic><sub><italic>EL</italic></sub>, <italic>C</italic><sub><italic>SC</italic></sub>, <italic>C</italic><sub><italic>HT</italic></sub>, and <italic>C</italic><sub><italic>FC</italic></sub> are the capacities of the electrolyzer, battery, hydrogen storage tank and fuel cell respectively, and also the decision variables of capacity optimization; <italic>K</italic><sub><italic>EL</italic></sub>, <italic>K</italic><sub><italic>SC</italic></sub>, <italic>K</italic><sub><italic>HT</italic></sub>, and <italic>K</italic><sub><italic>FC</italic></sub> are the unit prices of the respective equipment in ¥/<italic>kW</italic> or ¥/<italic>kWh</italic>. The operation and maintenance cost of the system can be expressed as:</p>
              
                <disp-formula>
                  <label>(28)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">O</mi>
                        </mrow>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">M</mi>
                        </mrow>
                        <mi mathvariant="normal">&amp;</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>I</mi>
                        <mi>N</mi>
                        <mi>V</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mo>×</mo>
                    <mi>∂</mi>
                  </math>
                </disp-formula>
              
              <p>where, <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <mi>∂</mi>
  </math>
</inline-formula> is the proportionality factor, which represents the share of the system operation and maintenance costs in the total initial investment cost.</p>
              
                <disp-formula>
                  <label>(29)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mtable displaystyle="true" columnalign="right left" columnspacing="0em" rowspacing="3pt">
                      <mtr>
                        <mtd>
                          <msub>
                            <mi>C</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>R</mi>
                              <mi>E</mi>
                              <mi>P</mi>
                            </mrow>
                          </msub>
                        </mtd>
                        <mtd>
                          <mi/>
                          <mo>=</mo>
                          <mo>×</mo>
                          <mo>×</mo>
                          <mo>+</mo>
                          <mo>×</mo>
                          <mo>×</mo>
                          <msub>
                            <mi>C</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>S</mi>
                              <mi>C</mi>
                            </mrow>
                          </msub>
                          <msub>
                            <mi>K</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>S</mi>
                              <mi>C</mi>
                            </mrow>
                          </msub>
                          <msub>
                            <mi>C</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>E</mi>
                              <mi>L</mi>
                            </mrow>
                          </msub>
                          <msub>
                            <mi>K</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>E</mi>
                              <mi>L</mi>
                            </mrow>
                          </msub>
                          <munderover>
                            <mo data-mjx-texclass="OP">∑</mo>
                            <mrow data-mjx-texclass="ORD">
                              <mi>a</mi>
                              <mo>=</mo>
                              <mn>1</mn>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>N</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mo>/</mo>
                              </mrow>
                              <msub>
                                <mi>L</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>s</mi>
                                  <mi>c</mi>
                                </mrow>
                              </msub>
                            </mrow>
                          </munderover>
                          <munderover>
                            <mo data-mjx-texclass="OP">∑</mo>
                            <mrow data-mjx-texclass="ORD">
                              <mi>b</mi>
                              <mo>=</mo>
                              <mn>1</mn>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>N</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mo>/</mo>
                              </mrow>
                              <msub>
                                <mi>L</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>e</mi>
                                  <mi>l</mi>
                                </mrow>
                              </msub>
                            </mrow>
                          </munderover>
                          <mfrac>
                            <mn>1</mn>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mo>+</mo>
                              <mn>1</mn>
                              <mi>i</mi>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>a</mi>
                                  <mo>×</mo>
                                  <msub>
                                    <mi>L</mi>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>s</mi>
                                      <mi>c</mi>
                                    </mrow>
                                  </msub>
                                </mrow>
                              </msup>
                            </mrow>
                          </mfrac>
                          <mfrac>
                            <mn>1</mn>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mo>+</mo>
                              <mn>1</mn>
                              <mi>i</mi>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>b</mi>
                                  <mo>×</mo>
                                  <msub>
                                    <mi>L</mi>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>e</mi>
                                      <mi>l</mi>
                                    </mrow>
                                  </msub>
                                </mrow>
                              </msup>
                            </mrow>
                          </mfrac>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd/>
                        <mtd>
                          <mi/>
                          <mo>+</mo>
                          <mo>×</mo>
                          <mo>×</mo>
                          <msub>
                            <mi>C</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>H</mi>
                              <mi>T</mi>
                            </mrow>
                          </msub>
                          <msub>
                            <mi>K</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>H</mi>
                              <mi>T</mi>
                            </mrow>
                          </msub>
                          <munderover>
                            <mo data-mjx-texclass="OP">∑</mo>
                            <mrow data-mjx-texclass="ORD">
                              <mi>c</mi>
                              <mo>=</mo>
                              <mn>1</mn>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>N</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mo>/</mo>
                              </mrow>
                              <msub>
                                <mi>L</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>h</mi>
                                  <mi>t</mi>
                                </mrow>
                              </msub>
                            </mrow>
                          </munderover>
                          <mfrac>
                            <mn>1</mn>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mo>+</mo>
                              <mn>1</mn>
                              <mi>i</mi>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>c</mi>
                                  <mo>×</mo>
                                  <msub>
                                    <mi>L</mi>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>h</mi>
                                      <mi>t</mi>
                                    </mrow>
                                  </msub>
                                </mrow>
                              </msup>
                            </mrow>
                          </mfrac>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd/>
                        <mtd>
                          <mi/>
                          <mo>+</mo>
                          <mo>×</mo>
                          <mo>×</mo>
                          <msub>
                            <mi>C</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>F</mi>
                              <mi>C</mi>
                            </mrow>
                          </msub>
                          <msub>
                            <mi>K</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>F</mi>
                              <mi>C</mi>
                            </mrow>
                          </msub>
                          <munderover>
                            <mo data-mjx-texclass="OP">∑</mo>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mo>=</mo>
                              <mn>1</mn>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>N</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mo>/</mo>
                              </mrow>
                              <msub>
                                <mi>L</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mrow data-mjx-texclass="ORD">
                                    <mi data-mjx-auto-op="false">fc</mi>
                                  </mrow>
                                </mrow>
                              </msub>
                            </mrow>
                          </munderover>
                          <mfrac>
                            <mn>1</mn>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mo>+</mo>
                              <mn>1</mn>
                              <mi>i</mi>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mo>×</mo>
                                  <msub>
                                    <mi>L</mi>
                                    <mrow data-mjx-texclass="ORD">
                                      <mrow data-mjx-texclass="ORD">
                                        <mi data-mjx-auto-op="false">fc</mi>
                                      </mrow>
                                    </mrow>
                                  </msub>
                                </mrow>
                              </msup>
                            </mrow>
                          </mfrac>
                        </mtd>
                      </mtr>
                    </mtable>
                  </math>
                </disp-formula>
              
              <p>where, <italic>L</italic><sub><italic>sc</italic></sub>, <italic>L</italic><sub><italic>el</italic></sub>, <italic>L</italic><sub><italic>ht</italic></sub>, and <italic>L</italic><sub><italic>fc</italic></sub> are the service life of the battery, electrolytic tank, hydrogen storage tank and fuel cell, respectively; <italic>i</italic> is the annual interest rate, <italic>i</italic>=0.04; <italic>N </italic>is the operating cycle of the wind-hydrogen system, <italic>N</italic>=20.</p><p>There are two main causes of the wind curtailment phenomenon in the wind-hydrogen system: first, the energy storage system has a limitation on the amount of wind power that can be consumed, or the wind curtailment is produced when the system is in mode 4; second, the wind curtailment happens when the system's storage capacity reaches its maximum and the remaining wind turbine power is no longer fed into the electrolyzer unit. The cost of the wind curtailment is calculated using the power that was reduced and added to an objective function of the total cost. The greater the power reduction, the higher the penalty cost.</p>
              
                <disp-formula>
                  <label>(30)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>C</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>Q</mi>
                        <mi>F</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>ρ</mi>
                      <mn>1</mn>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>n</mi>
                        <mi>e</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>s</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>h</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mo>×</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>−</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>−</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>+</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>∣</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <mo>&gt;</mo>
                    <mo data-mjx-texclass="OP" movablelimits="true">max</mo>
                    <mo>−</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <munderover>
                      <mo data-mjx-texclass="OP">∑</mo>
                      <mrow data-mjx-texclass="ORD">
                        <mi>t</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>T</mi>
                    </munderover>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mi>t</mi>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>t</mi>
                    <mi>t</mi>
                  </math>
                </disp-formula>
              
              <p>where, <inline-formula>
  <math xmlns="http://www.w3.org/1998/Math/MathML">
    <msub>
      <mi>ρ</mi>
      <mn>1</mn>
    </msub>
  </math>
</inline-formula> is the unit cost of wind curtailment, 5.8 ¥/<italic>kWh </italic>[<xref ref-type="bibr" rid="ref_15">15</xref>], [<xref ref-type="bibr" rid="ref_16">16</xref>], [<xref ref-type="bibr" rid="ref_17">17</xref>], [<xref ref-type="bibr" rid="ref_18">18</xref>], [<xref ref-type="bibr" rid="ref_19">19</xref>], [<xref ref-type="bibr" rid="ref_20">20</xref>]; <italic>P</italic><sub><italic>net</italic></sub>(<italic>t</italic>), <italic>P</italic><sub><italic>el</italic></sub>(<italic>t</italic>) and <italic>P</italic><sub><italic>sc</italic></sub>(<italic>t</italic>) are the net power at the t-th sampling point, the electrolyzer input power and the battery charging power. when the system is operating in mode 4, respectively; <italic>P</italic><sub><italic>h2</italic></sub>(<italic>t</italic>) is the curtailed wind power generated under the hydrogen production constraint of the electrolyzer; <italic>T</italic> is the number of sampling points.</p>
            </sec>
          
          
            <sec disp-level="level3">
              
                <title>3.1. 2 Reliability analysis</title>
              
              <p>Power fluctuation rate and power deficit rate are selected to measure the reliability of the power supply.</p><p>The power volatility reflects the smoothness of the system output power and is expressed as the percentage change in power at each sampling moment of that system's output power:</p>
              
                <disp-formula>
                  <label>(31)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mtable columnalign="" columnspacing="1em" rowspacing="4pt">
                      <mtr>
                        <mtd>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>t</mi>
                                  <mi>o</mi>
                                  <mi>t</mi>
                                  <mi>a</mi>
                                  <mi>l</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mi>w</mi>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>P</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>f</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mo>=</mo>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mo>+</mo>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mo>−</mo>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mo>+</mo>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mi>t</mi>
                            <mi>t</mi>
                            <mi>t</mi>
                            <mi>t</mi>
                            <mi>t</mi>
                          </mrow>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>f</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>F</mi>
                                <mi>P</mi>
                                <mi>P</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mfrac>
                              <mrow>
                                <munderover>
                                  <mo data-mjx-texclass="OP">∑</mo>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>t</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>T</mi>
                                    <mo>−</mo>
                                    <mn>1</mn>
                                  </mrow>
                                </munderover>
                                <mrow data-mjx-texclass="INNER">
                                  <mo data-mjx-texclass="OPEN">[</mo>
                                  <mo stretchy="false">(</mo>
                                  <mo>+</mo>
                                  <mo stretchy="false">)</mo>
                                  <mo>−</mo>
                                  <mo stretchy="false">(</mo>
                                  <mo stretchy="false">)</mo>
                                  <mo data-mjx-texclass="CLOSE">]</mo>
                                  <msub>
                                    <mi>P</mi>
                                    <mrow data-mjx-texclass="ORD">
                                      <mrow data-mjx-texclass="ORD">
                                        <mi>t</mi>
                                        <mi>o</mi>
                                        <mi>t</mi>
                                        <mi>a</mi>
                                        <mi>l</mi>
                                      </mrow>
                                    </mrow>
                                  </msub>
                                  <msub>
                                    <mi>P</mi>
                                    <mrow data-mjx-texclass="ORD">
                                      <mrow data-mjx-texclass="ORD">
                                        <mi>t</mi>
                                        <mi>o</mi>
                                        <mi>t</mi>
                                        <mi>a</mi>
                                        <mi>l</mi>
                                      </mrow>
                                    </mrow>
                                  </msub>
                                  <mi>t</mi>
                                  <mi>t</mi>
                                  <mn>1</mn>
                                </mrow>
                              </mrow>
                              <mrow>
                                <munderover>
                                  <mo data-mjx-texclass="OP">∑</mo>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>t</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                  </mrow>
                                  <mi>T</mi>
                                </munderover>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mtext>total </mtext>
                                  </mrow>
                                </msub>
                                <mo stretchy="false">(</mo>
                                <mo stretchy="false">)</mo>
                                <mi>t</mi>
                              </mrow>
                            </mfrac>
                          </mrow>
                        </mtd>
                      </mtr>
                    </mtable>
                  </math>
                </disp-formula>
              
              <p>where, <italic>P</italic><sub><italic>w</italic></sub>(<italic>t</italic>) is the output power of the wind turbine at the t-th sampling point; <italic>P</italic><sub><italic>sc</italic></sub>(<italic>t</italic>) is the output power of the battery; <italic>P</italic><sub><italic>el</italic></sub>(<italic>t</italic>) is the input power of the electrolyzer; <italic>P</italic><sub><italic>fc</italic></sub>(<italic>t</italic>) is the output power of the fuel cell; <italic>P</italic><sub><italic>total</italic></sub>(<italic>t</italic>) is the output power of the system at the t-th sampling point; <italic>P</italic><sub><italic>total</italic></sub>(<italic>t+</italic>1) is the output power of the system at the (<italic>t</italic>+1) th sampling point. </p><p>The load shortage rate reflects the probability of a load failing to meet its power demand and is expressed as the ratio of the amount of unmet load demand in each sampling period to the demand of the load in that period.</p>
              
                <disp-formula>
                  <label>(32)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <msub>
                      <mi>f</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>L</mi>
                        <mi>P</mi>
                        <mi>S</mi>
                        <mi>P</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <munderover>
                          <mo data-mjx-texclass="OP">∑</mo>
                          <mrow data-mjx-texclass="ORD">
                            <mi>t</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>T</mi>
                        </munderover>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>q</mi>
                            <mi>e</mi>
                          </mrow>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mi>t</mi>
                      </mrow>
                      <mrow>
                        <munderover>
                          <mo data-mjx-texclass="OP">∑</mo>
                          <mrow data-mjx-texclass="ORD">
                            <mi>t</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>T</mi>
                        </munderover>
                        <msub>
                          <mi>P</mi>
                          <mi>l</mi>
                        </msub>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mi>t</mi>
                      </mrow>
                    </mfrac>
                  </math>
                </disp-formula>
              
              <p>where, <italic>P</italic><sub><italic>l</italic></sub>(<italic>t</italic>) is the demand power of the load at the t-th sampling point; <italic>P</italic><sub><italic>qe</italic></sub>(<italic>t</italic>) is the shortfall power of the load at the t-th sampling point.</p><p>According to the entropy weight method, the weight indicators of power fluctuation rate and load shortage rate are 0.46 and 0.54 respectively. Considering the economic cost, the objective functions of the system are:</p>
              
                <disp-formula>
                  <label>(33)</label>
                  <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">{</mo>
                      <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                      <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>f</mi>
                              <mn>1</mn>
                            </msub>
                            <msub>
                              <mi>C</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>I</mi>
                                <mi>N</mi>
                                <mi>V</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>C</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">O</mi>
                                </mrow>
                                <mi mathvariant="normal">&amp;</mi>
                                <mtext>M</mtext>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>C</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>R</mi>
                                <mi>E</mi>
                                <mi>P</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>C</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>Q</mi>
                                <mi>F</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>+</mo>
                            <mo>+</mo>
                            <mo>+</mo>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <msub>
                              <mi>f</mi>
                              <mn>2</mn>
                            </msub>
                            <msub>
                              <mi>f</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>F</mi>
                                <mi>P</mi>
                                <mi>P</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>f</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>L</mi>
                                <mi>P</mi>
                                <mi>S</mi>
                                <mi>P</mi>
                              </mrow>
                            </msub>
                            <mo>=</mo>
                            <mo>+</mo>
                            <mn>0.46</mn>
                            <mn>0.54</mn>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mrow>
                  </math>
                </disp-formula>
              
            </sec>
          
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>3.2. Binding conditions</title>
          
          <p>1) Equipment capacity constraints</p>
          
            <disp-formula>
              <label>(34)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mtable columnalign="" columnspacing="1em" rowspacing="4pt">
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <mn>0</mn>
                        <mo>&lt;</mo>
                        <mo>&lt;</mo>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>E</mi>
                            <mi>L</mi>
                          </mrow>
                        </msub>
                        <msubsup>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>E</mi>
                            <mi>L</mi>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>m</mi>
                            <mi>a</mi>
                            <mi>x</mi>
                          </mrow>
                        </msubsup>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <mn>0</mn>
                        <mo>&lt;</mo>
                        <mo>&lt;</mo>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>S</mi>
                            <mi>C</mi>
                          </mrow>
                        </msub>
                        <msubsup>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>S</mi>
                            <mi>C</mi>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>m</mi>
                            <mi>a</mi>
                            <mi>x</mi>
                          </mrow>
                        </msubsup>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <mn>0</mn>
                        <mo>&lt;</mo>
                        <mo>&lt;</mo>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>H</mi>
                            <mi>T</mi>
                          </mrow>
                        </msub>
                        <msubsup>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>H</mi>
                            <mi>T</mi>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>m</mi>
                            <mi>a</mi>
                            <mi>x</mi>
                          </mrow>
                        </msubsup>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <mn>0</mn>
                        <mo>&lt;</mo>
                        <mo>&lt;</mo>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>F</mi>
                            <mi>C</mi>
                          </mrow>
                        </msub>
                        <msubsup>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>F</mi>
                            <mi>C</mi>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>m</mi>
                            <mi>a</mi>
                            <mi>x</mi>
                          </mrow>
                        </msubsup>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow data-mjx-texclass="ORD">
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>E</mi>
                            <mi>L</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>S</mi>
                            <mi>C</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>H</mi>
                            <mi>T</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>F</mi>
                            <mi>C</mi>
                          </mrow>
                        </msub>
                        <mo>,</mo>
                        <mo>,</mo>
                        <mo>,</mo>
                        <mo>∈</mo>
                        <msup>
                          <mi>R</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mo>+</mo>
                          </mrow>
                        </msup>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </math>
            </disp-formula>
          
          <p>where, <italic>Cmax EL</italic>, <italic>Cmax SC, Cmax HT, </italic>and<italic> Cmax FC </italic>are the upper capacity limits of the electrolyzer, battery, hydrogen storage tank and fuel cell respectively.</p><p>2) Battery charging and discharging constraints</p>
          
            <disp-formula>
              <label>(35)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <mi>S</mi>
                        <mi>O</mi>
                        <mi>S</mi>
                        <mi>O</mi>
                        <mi>C</mi>
                        <mi>t</mi>
                        <mi>S</mi>
                        <mi>O</mi>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>m</mi>
                            <mi>i</mi>
                            <mi>n</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>C</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>m</mi>
                            <mi>a</mi>
                            <mi>x</mi>
                          </mrow>
                        </msub>
                        <mo>&lt;</mo>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mo>&lt;</mo>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mrow data-mjx-texclass="ORD">
                              <mi>c</mi>
                              <mi>h</mi>
                              <mi>m</mi>
                              <mi>a</mi>
                              <mi>x</mi>
                            </mrow>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo data-mjx-texclass="OP" movablelimits="true">min</mo>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">{</mo>
                          <mo>,</mo>
                          <mo stretchy="false">(</mo>
                          <mo stretchy="false">)</mo>
                          <mo data-mjx-texclass="CLOSE">}</mo>
                          <msubsup>
                            <mi>P</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mrow data-mjx-texclass="ORD">
                                <mi>c</mi>
                                <mi>m</mi>
                                <mi>a</mi>
                                <mi>x</mi>
                              </mrow>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>s</mi>
                              <mi>c</mi>
                            </mrow>
                          </msubsup>
                          <msubsup>
                            <mi>P</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>c</mi>
                              <mi>h</mi>
                              <mi>m</mi>
                              <mi>a</mi>
                              <mi>x</mi>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>s</mi>
                              <mi>c</mi>
                            </mrow>
                          </msubsup>
                          <mrow data-mjx-texclass="ORD">
                            <mi mathvariant="normal">t</mi>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>dismax </mtext>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo data-mjx-texclass="OP" movablelimits="true">min</mo>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">{</mo>
                          <mo>,</mo>
                          <mo stretchy="false">(</mo>
                          <mo stretchy="false">)</mo>
                          <mo data-mjx-texclass="CLOSE">}</mo>
                          <msubsup>
                            <mi>P</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mo data-mjx-texclass="OP" movablelimits="true">max</mo>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>s</mi>
                              <mi>c</mi>
                            </mrow>
                          </msubsup>
                          <msubsup>
                            <mi>P</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mrow data-mjx-texclass="ORD">
                                <mi>d</mi>
                                <mi>i</mi>
                                <mi>s</mi>
                                <mi>m</mi>
                                <mi>a</mi>
                                <mi>x</mi>
                              </mrow>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>s</mi>
                              <mi>c</mi>
                            </mrow>
                          </msubsup>
                          <mrow data-mjx-texclass="ORD">
                            <mi mathvariant="normal">t</mi>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msubsup>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mrow data-mjx-texclass="ORD">
                              <mi>c</mi>
                              <mi>h</mi>
                              <mi>m</mi>
                              <mi>a</mi>
                              <mi>x</mi>
                            </mrow>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>s</mi>
                            <mi>c</mi>
                          </mrow>
                        </msubsup>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mo>=</mo>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">t</mi>
                        </mrow>
                        <mfrac>
                          <mrow>
                            <msub>
                              <mi>E</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <mo stretchy="false">[</mo>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mo>−</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">]</mo>
                            <mi>S</mi>
                            <mi>O</mi>
                            <mi>C</mi>
                            <mi>t</mi>
                            <mi mathvariant="normal">Δ</mi>
                            <mi>S</mi>
                            <mi>O</mi>
                            <mi>C</mi>
                            <mi>t</mi>
                            <mn>1</mn>
                            <mn>1</mn>
                          </mrow>
                          <mrow>
                            <msub>
                              <mi>η</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>c</mi>
                                <mi>h</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi mathvariant="normal">Δ</mi>
                              <mi>t</mi>
                            </msub>
                            <mo>⋅</mo>
                          </mrow>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msubsup>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>i</mi>
                              <mi>s</mi>
                              <mi>m</mi>
                              <mi>a</mi>
                              <mi>x</mi>
                            </mrow>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>s</mi>
                            <mi>c</mi>
                          </mrow>
                        </msubsup>
                        <mo stretchy="false">(</mo>
                        <mo stretchy="false">)</mo>
                        <mo>=</mo>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">t</mi>
                        </mrow>
                        <mfrac>
                          <mrow>
                            <msub>
                              <mi>E</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>s</mi>
                                <mi>c</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>η</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mi>i</mi>
                                  <mi>s</mi>
                                </mrow>
                              </mrow>
                            </msub>
                            <mo>⋅</mo>
                            <mo>⋅</mo>
                            <mo stretchy="false">[</mo>
                            <mo stretchy="false">(</mo>
                            <mo stretchy="false">)</mo>
                            <mo>−</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">(</mo>
                            <mo>−</mo>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">]</mo>
                            <mi>S</mi>
                            <mi>O</mi>
                            <mi>C</mi>
                            <mi>t</mi>
                            <mi mathvariant="normal">Δ</mi>
                            <mi>S</mi>
                            <mi>O</mi>
                            <mi>C</mi>
                            <mi>t</mi>
                            <mn>1</mn>
                            <mn>1</mn>
                          </mrow>
                          <msub>
                            <mi mathvariant="normal">Δ</mi>
                            <mi>t</mi>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>where, <italic>SOC</italic><sub><italic>min</italic></sub>, and <italic>SOC</italic><sub><italic>max</italic></sub> are the upper and lower limits of the charge state of the battery; <italic>P</italic><sub><italic>chmax</italic></sub>, and <italic>P</italic><sub><italic>chmax</italic></sub> are the maximum allowable charge and discharge power of the battery at sampling time t; <italic>Psc cmax</italic>, and <italic>Psc dmax </italic>are the maximum continuous charge and discharge power of the battery, determined by its charge and discharge features; <italic>Psc chmax</italic>(<italic>t</italic>), and <italic>Psc dismax</italic>(<italic>t</italic>) are the maximum allowable charge and discharge power of the battery at sampling time t, determined by its rated capacity and charge state.</p><p> 3) Power constraint on electrolyzer operation</p>
          
            <disp-formula>
              <label>(36)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>e</mi>
                    <mi>l</mi>
                    <mi>m</mi>
                    <mi>i</mi>
                    <mi>n</mi>
                    <mo>−</mo>
                  </mrow>
                </msub>
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>e</mi>
                    <mi>l</mi>
                  </mrow>
                </msub>
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>e</mi>
                    <mi>l</mi>
                    <mi>m</mi>
                    <mi>a</mi>
                    <mi>x</mi>
                    <mo>−</mo>
                  </mrow>
                </msub>
                <mo>&lt;</mo>
                <mo>&lt;</mo>
              </math>
            </disp-formula>
          
          <p>where, <italic>P</italic><sub><italic>el-min</italic></sub>, and <italic>P</italic><sub><italic>el-max</italic></sub> are the upper and lower limit of the optimum operating power of the electrolyzer, with the lower limit being 30% of the rated power and the upper limit being the rated power.</p><p>4) Fuel cell power constraint</p>
          
            <disp-formula>
              <label>(37)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msubsup>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>f</mi>
                    <mi>c</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mi>m</mi>
                    <mi>a</mi>
                    <mi>x</mi>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mo stretchy="false">)</mo>
                <mo>=</mo>
                <mo data-mjx-texclass="OP" movablelimits="true">min</mo>
                <mi>t</mi>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo>,</mo>
                  <mo>⋅</mo>
                  <mo data-mjx-texclass="CLOSE">}</mo>
                  <msub>
                    <mi>P</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>f</mi>
                      <mi>c</mi>
                      <mi>N</mi>
                      <mo>.</mo>
                    </mrow>
                  </msub>
                  <msub>
                    <mi>η</mi>
                    <mrow data-mjx-texclass="ORD">
                      <msub>
                        <mi>f</mi>
                        <mi>c</mi>
                      </msub>
                    </mrow>
                  </msub>
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>Q</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>h</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>Q</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>h</mi>
                          <mi>t</mi>
                          <mi>m</mi>
                          <mi>i</mi>
                          <mi>n</mi>
                        </mrow>
                      </msub>
                      <mo stretchy="false">(</mo>
                      <mo stretchy="false">)</mo>
                      <mo>−</mo>
                      <mi>t</mi>
                    </mrow>
                    <mrow>
                      <mi>μ</mi>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>t</mi>
                      <mo>⋅</mo>
                    </mrow>
                  </mfrac>
                </mrow>
              </math>
            </disp-formula>
          
          <p>where, <italic>Pfc max</italic>(<italic>t</italic>) is the maximum output of the fuel cell at sampling time t; <italic>P</italic><sub><italic>fc</italic></sub><sub>.</sub><sub><italic>N </italic></sub>is the rated output of the fuel cell; <italic>Q</italic><sub><italic>ht</italic></sub>(<italic>t</italic>) is the storage capacity of the hydrogen tank at sampling time t; <italic>Q</italic><sub><italic>ht</italic></sub><sub>min</sub> is the lower capacity limit of the hydrogen tank.</p><p> </p><p>5) Hydrogen production constraint of electrolysis cells</p>
          
            <disp-formula>
              <label>(38)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msubsup>
                  <mi>Q</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>e</mi>
                    <mi>l</mi>
                  </mrow>
                  <mrow data-mjx-texclass="ORD">
                    <mo data-mjx-texclass="OP" movablelimits="true">max</mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mo stretchy="false">)</mo>
                <mo>=</mo>
                <mo data-mjx-texclass="OP" movablelimits="true">min</mo>
                <mi>t</mi>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo>,</mo>
                  <mo data-mjx-texclass="CLOSE">}</mo>
                  <msub>
                    <mi>Q</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>e</mi>
                      <mi>l</mi>
                      <mi>N</mi>
                      <mo>.</mo>
                    </mrow>
                  </msub>
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>Q</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>h</mi>
                          <mi>t</mi>
                          <mo data-mjx-texclass="OP" movablelimits="true">max</mo>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>Q</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>h</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                      <mo>−</mo>
                      <mo stretchy="false">(</mo>
                      <mo stretchy="false">)</mo>
                      <mi>t</mi>
                    </mrow>
                    <mrow>
                      <msub>
                        <mi>η</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>e</mi>
                          <mi>l</mi>
                        </mrow>
                      </msub>
                      <mo>⋅</mo>
                      <mo>⋅</mo>
                      <mi>ρ</mi>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                </mrow>
              </math>
            </disp-formula>
          
          <p>where, <italic>Qmax el</italic>(<italic>t</italic>) is the maximum hydrogen production of the electrolyzer at sampling time t; <italic>Q</italic><sub><italic>el.N</italic></sub> is the nominal hydrogen production of the electrolyzer; <italic>Q</italic><sub><italic>htmax </italic></sub>is the maximum capacity of the hydrogen storage tank. </p><p>6) Capacity constraints of hydrogen storage tanks</p>
          
            <disp-formula>
              <label>(39)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>Q</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>h</mi>
                    <mi>t</mi>
                    <mi>m</mi>
                    <mi>i</mi>
                    <mi>n</mi>
                  </mrow>
                </msub>
                <msub>
                  <mi>Q</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>h</mi>
                    <mi>t</mi>
                  </mrow>
                </msub>
                <msub>
                  <mi>Q</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>h</mi>
                    <mi>t</mi>
                    <mi>m</mi>
                    <mi>a</mi>
                    <mi>x</mi>
                  </mrow>
                </msub>
                <mo>≤</mo>
                <mo>≤</mo>
              </math>
            </disp-formula>
          
          <p>where, <italic>Q</italic><sub><italic>htmin</italic></sub><sub> </sub>= 0.1<italic>Q</italic><sub><italic>htmax</italic></sub>, and <italic>Q</italic><sub><italic>htmax</italic></sub><sub> </sub>= 0.9<italic>Q</italic><sub><italic>ht.N</italic></sub> (<italic>Q</italic><sub><italic>ht.N</italic></sub> is the nominal storage capacity of the hydrogen tank).</p>
        </sec>
      
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>4. Model solving</title>
      <p>The capacity configuration of a wind-hydrogen hybrid energy storage system is a multi-objective, multi-constrained, multi-variable non-linear optimization problem, and the system economy and reliability cannot be optimal at the same time. Given that the NSGA-Ⅱ algorithm has the advantages of high operational efficiency, good distribution of the solution set and good convergence of the solution set, the NSGA-Ⅱ multi-objective genetic optimization algorithm is used here to solve the capacity allocation scheme of the hybrid energy storage system, and the solution flow is shown in <xref ref-type="fig" rid="fig_4">Figure 4</xref>.</p>
      
        <fig id="fig_4">
          <label>Figure 4</label>
          <caption>Flow of capacity optimization</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_aqVrjEcgAK5KdmRE.jpeg"/>
        </fig>
      
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>5. Example analysis</title>
      <p>To verify the effectiveness of the proposed capacity optimization method, a typical daily load and wind velocity in a pastoral area of Inner Mongolia were selected as the system input data, with a sampling interval of 10 min and a wind turbine capacity of 60 kW. Typical daily wind speed and load curves are shown in <xref ref-type="fig" rid="fig_5">Figure 5</xref> and <xref ref-type="fig" rid="fig_6">Figure 6</xref>.</p>
      
        <fig id="fig_5">
          <label>Figure 5</label>
          <caption>Daily wind velocity data</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_RFoZccPghL8p0wbi.jpeg"/>
        </fig>
      
      
        <fig id="fig_6">
          <label>Figure 6</label>
          <caption>Daily load data</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_N9vgcUJ9jfC9y0Gz.jpeg"/>
        </fig>
      
      <p>The actual output power of wind turbine can be obtained from the wind speed data in <xref ref-type="fig" rid="fig_5">Figure 5</xref> and formula (1), as shown in <xref ref-type="fig" rid="fig_7">Figure 7</xref>.</p>
      
        <fig id="fig_7">
          <label>Figure 7</label>
          <caption>Output power of wind turbine</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_RNcvPkBDeYdXxnwJ.jpeg"/>
        </fig>
      
      <p>The power curve of the hybrid energy storage device is obtained from the difference between the wind turbine output and the load demand, as shown in <xref ref-type="fig" rid="fig_8">Figure 8</xref>.</p>
      
        <fig id="fig_8">
          <label>Figure 8</label>
          <caption>Energy storage units power</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_eazn3DdLXe92jbji.jpeg"/>
        </fig>
      
      <p>Before capacity optimization, the optimization interval of <italic>C</italic><sub><italic>EL</italic></sub>, <italic>C</italic><sub><italic>SC</italic></sub> are set to 0~40kW, and the optimization interval of <italic>C</italic><sub><italic>FC</italic></sub>, <italic>C</italic><sub><italic>HT</italic></sub> are 0~30kW and 0~1000Nm<sup>3</sup> respectively, this is because when the wind turbine output is greater than the load demand, the power dissipated by the electrolytic tank and the battery does not exceed 40kW, and conversely when the wind power output is insufficient, the total regulated power of the fuel cell and the battery is less than 30kw. The initial SOC of the battery and hydrogen storage system is 50%.</p><p>The installation costs and related parameters of hydrogen storage and batteries are shown in <xref ref-type="table" rid="table_2">Table 2</xref>.</p>
      
        <table-wrap id="table_2">
          <label>Table 2</label>
          <caption>Energy storage parameters of wind hydrogen system</caption>
          <abstract/>
          <table><tbody><tr><td colspan="1" rowspan="1"><p>Equipment name</p></td><td colspan="1" rowspan="1"><p>Unit investment cost(¥/kW)</p></td><td colspan="1" rowspan="1"><p>Proportion of O&amp;amp;amp;M cost(%)</p></td><td colspan="1" rowspan="1"><p>Service life</p><p>(yeras)</p></td><td colspan="1" rowspan="1"><p>Efficiency (%)</p></td></tr><tr><td colspan="1" rowspan="1"><p>Electrolysis cell</p></td><td colspan="1" rowspan="1"><p>1.4×10<sup>4</sup></p></td><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>10</p></td><td colspan="1" rowspan="1"><p>75</p></td></tr><tr><td colspan="1" rowspan="1"><p>Battery</p></td><td colspan="1" rowspan="1"><p>1.2×10<sup>3</sup></p></td><td colspan="1" rowspan="1"><p>1</p></td><td colspan="1" rowspan="1"><p>4</p></td><td colspan="1" rowspan="1"><p>85/95</p></td></tr><tr><td colspan="1" rowspan="1"><p>Fuel cell</p></td><td colspan="1" rowspan="1"><p>1.4×10<sup>4</sup></p></td><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>10</p></td><td colspan="1" rowspan="1"><p>60</p></td></tr><tr><td colspan="1" rowspan="1"><p>Hydrogen storage tank</p></td><td colspan="1" rowspan="1"><p>3.3×10<sup>3</sup></p></td><td colspan="1" rowspan="1"><p>1</p></td><td colspan="1" rowspan="1"><p>20</p></td><td colspan="1" rowspan="1"><p>95</p></td></tr></tbody></table>
        </table-wrap>
      
      <p>The NSGA-II sets the number of populations to 100, the maximum number of iterations to 200, the crossover probability to 0.8 and the mutation probability to 0.2. <xref ref-type="fig" rid="fig_9">Figure 9</xref> shows the Pareto optimal solution set after the algorithm has been solved, and the analysis shows that the capacity of the energy storage device is linearly related to the reliability of the power supply. On the contrary, when the capacity of energy storage is low, the economy can be guaranteed but the reliability of the supply cannot be taken into account. The economic cost of the system, the power fluctuation rate and the reliability of the supply are all in conflict with each other and cannot be solved optimally at the same time. </p>
      
        <fig id="fig_9">
          <label>Figure 9</label>
          <caption>Pareto solution set</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_bcrM4jMicKftmH7d.jpeg"/>
        </fig>
      
      <p>In order to find the optimal solution that satisfies both the lowest economic cost and the highest supply reliability, a solution from the Pareto solution set frontier needs to be found as a configuration solution of a hybrid energy storage device of wind-hydrogen systems. <xref ref-type="table" rid="table_3">Table 3</xref> to <xref ref-type="table" rid="table_4">Table 4</xref> show the obtained set of Pareto optimal solution sets with the corresponding energy storage capacity.</p>
      
        <table-wrap id="table_3">
          <label>Table 3</label>
          <caption>A set of Pareto optimal solutions</caption>
          <abstract/>
          <table><tbody><tr><td colspan="1" rowspan="1"><p>Options</p></td><td colspan="1" rowspan="1"><p>Economic cost×10<sup>6</sup>/¥</p></td><td colspan="1" rowspan="1"><p>Reliability</p></td></tr><tr><td colspan="1" rowspan="1"><p>1</p></td><td colspan="1" rowspan="1"><p>3.4463</p></td><td colspan="1" rowspan="1"><p>0.0104</p></td></tr><tr><td colspan="1" rowspan="1"><p>2</p></td><td colspan="1" rowspan="1"><p>0.0446</p></td><td colspan="1" rowspan="1"><p>0.1396</p></td></tr><tr><td colspan="1" rowspan="1"><p>3</p></td><td colspan="1" rowspan="1"><p>0.9659</p></td><td colspan="1" rowspan="1"><p>0.0813</p></td></tr><tr><td colspan="1" rowspan="1"><p>4</p></td><td colspan="1" rowspan="1"><p>1.7744</p></td><td colspan="1" rowspan="1"><p>0.0560</p></td></tr><tr><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>0.6527</p></td><td colspan="1" rowspan="1"><p>0.1011</p></td></tr><tr><td colspan="1" rowspan="1"><p>6</p></td><td colspan="1" rowspan="1"><p>1.9316</p></td><td colspan="1" rowspan="1"><p>0.0494</p></td></tr><tr><td colspan="1" rowspan="1"><p>7</p></td><td colspan="1" rowspan="1"><p>2.0468</p></td><td colspan="1" rowspan="1"><p>0.0452</p></td></tr><tr><td colspan="1" rowspan="1"><p>8</p></td><td colspan="1" rowspan="1"><p>1.5845</p></td><td colspan="1" rowspan="1"><p>0.0607</p></td></tr><tr><td colspan="1" rowspan="1"><p>9</p></td><td colspan="1" rowspan="1"><p>0.1007</p></td><td colspan="1" rowspan="1"><p>0.1270</p></td></tr><tr><td colspan="1" rowspan="1"><p>10</p></td><td colspan="1" rowspan="1"><p>2.5563</p></td><td colspan="1" rowspan="1"><p>0.0320</p></td></tr></tbody></table>
        </table-wrap>
      
      
        <table-wrap id="table_4">
          <label>Table 4</label>
          <caption>Capacity configuration options</caption>
          <abstract/>
          <table><tbody><tr><td colspan="1" rowspan="1"><p>Options</p></td><td colspan="1" rowspan="1"><p>Electrolysis cell /kW</p></td><td colspan="1" rowspan="1"><p>Battery/kWh</p></td><td colspan="1" rowspan="1"><p>Fuel cell/kW</p></td><td colspan="1" rowspan="1"><p>Hydrogen storage tank /Nm<sup>3</sup></p></td></tr><tr><td colspan="1" rowspan="1"><p>1</p></td><td colspan="1" rowspan="1"><p>35.8215</p></td><td colspan="1" rowspan="1"><p>39.3740</p></td><td colspan="1" rowspan="1"><p>16.7600</p></td><td colspan="1" rowspan="1"><p>492.4003</p></td></tr><tr><td colspan="1" rowspan="1"><p>2</p></td><td colspan="1" rowspan="1"><p>0.1041</p></td><td colspan="1" rowspan="1"><p>5.3393</p></td><td colspan="1" rowspan="1"><p>0.0914</p></td><td colspan="1" rowspan="1"><p>0.4587</p></td></tr><tr><td colspan="1" rowspan="1"><p>3</p></td><td colspan="1" rowspan="1"><p>25.9401</p></td><td colspan="1" rowspan="1"><p>33.3283</p></td><td colspan="1" rowspan="1"><p>0.0914</p></td><td colspan="1" rowspan="1"><p>0.4587</p></td></tr><tr><td colspan="1" rowspan="1"><p>4</p></td><td colspan="1" rowspan="1"><p>28.3054</p></td><td colspan="1" rowspan="1"><p>39.3740</p></td><td colspan="1" rowspan="1"><p>9.8782</p></td><td colspan="1" rowspan="1"><p>122.6094</p></td></tr><tr><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>15.5287</p></td><td colspan="1" rowspan="1"><p>33.7735</p></td><td colspan="1" rowspan="1"><p>0.0914</p></td><td colspan="1" rowspan="1"><p>0.4587</p></td></tr><tr><td colspan="1" rowspan="1"><p>6</p></td><td colspan="1" rowspan="1"><p>26.8001</p></td><td colspan="1" rowspan="1"><p>37.9503</p></td><td colspan="1" rowspan="1"><p>16.7585</p></td><td colspan="1" rowspan="1"><p>122.6094</p></td></tr><tr><td colspan="1" rowspan="1"><p>7</p></td><td colspan="1" rowspan="1"><p>30.1488</p></td><td colspan="1" rowspan="1"><p>39.1573</p></td><td colspan="1" rowspan="1"><p>16.7600</p></td><td colspan="1" rowspan="1"><p>124.7478</p></td></tr><tr><td colspan="1" rowspan="1"><p>8</p></td><td colspan="1" rowspan="1"><p>28.8913</p></td><td colspan="1" rowspan="1"><p>39.9808</p></td><td colspan="1" rowspan="1"><p>9.8782</p></td><td colspan="1" rowspan="1"><p>59.3710</p></td></tr><tr><td colspan="1" rowspan="1"><p>9</p></td><td colspan="1" rowspan="1"><p>0.5291</p></td><td colspan="1" rowspan="1"><p>13.9939</p></td><td colspan="1" rowspan="1"><p>0.0914</p></td><td colspan="1" rowspan="1"><p>0.4587</p></td></tr><tr><td colspan="1" rowspan="1"><p>10</p></td><td colspan="1" rowspan="1"><p>27.4335</p></td><td colspan="1" rowspan="1"><p>39.3740</p></td><td colspan="1" rowspan="1"><p>16.7600</p></td><td colspan="1" rowspan="1"><p>302.0766</p></td></tr></tbody></table>
        </table-wrap>
      
      <p>Considering the economic cost and the reliability of the power supply, the relative optimal solution is chosen according to the principle of compromise. The total cost of option 6 is less than 2×10<sup>6</sup> ¥ and the reliability index reaches 0.0494, i.e., the load outage rate and power fluctuation rate are less than 10% at this time. This option ensures safe and reliable power supply on the premise of minimizing system cost, therefore option 6 is chosen as the final optimization option.</p>
      
        <fig id="fig_10">
          <label>Figure 10</label>
          <caption>Power of electrolytic cel</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_5MprjhPvJKcdmVj7.jpeg"/>
        </fig>
      
      <p><xref ref-type="fig" rid="fig_10">Figure 10</xref> and <xref ref-type="fig" rid="fig_11">Figure 11</xref> show the input power of the electrolyzer and the hybrid energy storage charge state under this scheme. It is clear that when the wind power output is less than the load demand, the energy management strategy of giving priority to the discharge of the battery over the fuel cell is satisfied; As a flexible energy storage unit, the battery is charged and discharged more frequently than hydrogen storage and can assist the electrolyzer to produce hydrogen efficiently; the energy management strategy is developed to keep the electrolyzer in the optimal operating range(minimum operating power of the electrolytic cell is 8kw and maximum operating power is 26kw), avoiding intermittent operation and frequent start-ups and stoppages of the electrolyzer, thus improving its hydrogen production efficiency and service life to a certain extent and ensuring safe operation and stable hydrogen production.</p>
      
        <fig id="fig_11">
          <label>Figure 11</label>
          <caption>State of charge of hybrid energy storage</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_gLFxRQ32tzzl2PhZ.jpeg"/>
        </fig>
      
    </sec>
    <sec disp-level="level1" sec-type="conclusions">
      <title>6. Conclusions</title>
      <p>Taking into account the hydrogen production features of the electrolyzer, this paper develops an energy management strategy that applies to six operating conditions, and a method for optimizing the energy storage capacity with good economy, high hydrogen production efficiency and good reliability is proposed. The following conclusions are obtained by analyzing the results of arithmetic examples:</p><p>(1) In the results of solving the proposed optimization model, a set of low-cost and reliable capacity configuration solutions were found (electrolyzer 26.8001/kW, battery 37.9503/kWh, fuel cell 16.7585/kW, hydrogen storage tank 122.6094/Nm<sup>3</sup>, economic cost 1.9316×106/¥, reliability indicator 0.0494).</p><p>(2) The developed energy management strategy can maximize the operation of the electrolyzer in the optimal working range (30%~100% of rated power), ensure efficient hydrogen production, avoid intermittent operation and frequent start/stop of the electrolyzer, and improve the service life of the equipment.</p><p>(3) The proposed energy management strategy and capacity optimization method can provide reference for the actual capacity configuration study of wind-hydrogen storage systems. However, the capacity optimization model is constructed with economic indicators that do not take into account the revenue from hydrogen sales. At this stage, the investment cost and conversion efficiency of fuel cells are still low, so it may be more economical to sell hydrogen regularly to the nearest hydrogen market for profit, in addition to supplying electricity.</p>
    </sec>
  </body>
  <back>
    <ack>
      <title>Acknowledgments</title>
      
    </ack>
    <app-group>
      <app>
        <title>Appendix</title>
        
      </app>
    </app-group>
    <notes>
      <title>Author Contributions</title>
      
    </notes>
    <notes>
      <title>Funding</title>
      <p>This research is made possible thanks to the support from the Major Science and Technology Project 2021ZD0027 of Inner Mongolia Autonomous Region, China.</p>
    </notes>
    <notes>
      <title>Informed Consent Statement</title>
      
    </notes>
    <notes>
      <title>Data Availability Statement</title>
      <p>The data used to support the findings of this study are available from the corresponding author upon request.</p>
    </notes>
    <notes notes-type="COI-statement">
      <title>Conflicts of Interest</title>
      <p>The authors declare that they have no conflicts of interest.</p>
    </notes>
    <ref-list>
      <title>References</title>
      <ref id="ref_1">
        <label>1.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Z. Y.</given-names>
              <surname>Yan and X</surname>
            </name>
            <name>
              <given-names>W.</given-names>
              <surname>Kong</surname>
            </name>
          </person-group>
          <article-title>Research on non-grid-connected wind power water-electrolytic hydrogen production system and its applications</article-title>
          <source>Strateg. Study CAE</source>
          <year>2015</year>
          <volume>17</volume>
          <issue>3</issue>
          <page-range>30-34</page-range>
          <fpage>30</fpage>
          <lpage>34</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_2">
        <label>2.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>C. Y.</given-names>
              <surname>Nie</surname>
            </name>
            <name>
              <given-names>X. J.</given-names>
              <surname>Shen</surname>
            </name>
            <name>
              <given-names>H.</given-names>
              <surname>Lv</surname>
            </name>
            <name>
              <given-names>W.</given-names>
              <surname>Wang</surname>
            </name>
          </person-group>
          <article-title>Capacity Configuration and control strategy of hydrogen super hybrid energy storage in grid connected wind farm</article-title>
          <source>Smart Power</source>
          <year>2020</year>
          <volume>48</volume>
          <issue>9</issue>
          <page-range>1-8</page-range>
          <fpage>1</fpage>
          <lpage>8</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.3969/j.issn.1673-7598.2020.09.002</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_3">
        <label>3.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>K. X.</given-names>
              <surname>Liang and H</surname>
            </name>
          </person-group>
          <article-title>Wind-hydrogen system's hybrid energy storage capacity optimization considering equipment features</article-title>
          <source>Modern Electron. Technique</source>
          <year>2021</year>
          <volume>44</volume>
          <issue>1</issue>
          <page-range>180-186</page-range>
          <fpage>180</fpage>
          <lpage>186</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.16652/j.issn.1004-373x.2021.21.037</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_4">
        <label>4.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>J. C.</given-names>
              <surname>Zhao</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>X. J.</given-names>
              <surname>Ma</surname>
            </name>
          </person-group>
          <article-title>Energy storage capacity optimization for wind power /hydrogen system considering dispatching program and economy</article-title>
          <source>Electr. Meas. &amp; Instrum.</source>
          <year>2018</year>
          <volume>55</volume>
          <issue>4</issue>
          <page-range>94-99</page-range>
          <fpage>94</fpage>
          <lpage>99</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_5">
        <label>5.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>G. W.</given-names>
              <surname>Cai</surname>
            </name>
            <name>
              <given-names>L. G.</given-names>
              <surname>Kong</surname>
            </name>
            <name>
              <given-names>A. X.</given-names>
              <surname>Xu</surname>
            </name>
            <name>
              <given-names>Z. X.</given-names>
              <surname>Li</surname>
            </name>
          </person-group>
          <article-title>Evaluation of wind/Hydrogen/Fuel cell grid-connected system power smoothing based on improved chemical reaction optimization algorithm</article-title>
          <source>T. China Electrotechnical Soc.</source>
          <year>2017</year>
          <volume>20</volume>
          <issue/>
          <page-range>251-260</page-range>
          <fpage>251</fpage>
          <lpage>260</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.19595/j.cnki.1000-6753.tces.161037</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_6">
        <label>6.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>R. G.</given-names>
              <surname>Ma</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>J. C.</given-names>
              <surname>Zhao</surname>
            </name>
            <name>
              <given-names>H. W.</given-names>
              <surname>Zhang</surname>
            </name>
            <name>
              <given-names>M.</given-names>
              <surname>Sun</surname>
            </name>
          </person-group>
          <article-title>Multi-objective optimization for capacity of non-grid-connected wind/hydrogen hybrid power system</article-title>
          <source>Acta Energiae Solaris Sinica</source>
          <year>2019</year>
          <volume>40</volume>
          <issue>2</issue>
          <page-range>422-429</page-range>
          <fpage>422</fpage>
          <lpage>429</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_7">
        <label>7.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>W.</given-names>
              <surname>Zhang</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Maleki</surname>
            </name>
            <name>
              <given-names>F.</given-names>
              <surname>Pourfayaz</surname>
            </name>
            <name>
              <given-names>M. S.</given-names>
              <surname>Shadloo</surname>
            </name>
          </person-group>
          <article-title>An artificial intelligence approach to optimization of an off-grid hybrid wind/hydrogen system</article-title>
          <source>Int. J. Hydrogen Energy</source>
          <year>2021</year>
          <volume>46</volume>
          <issue>4</issue>
          <page-range>pp. 12725-1273</page-range>
          <fpage>pp. 127258</fpage>
          <lpage>pp. 112738</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.ijhydene.2021.01.167</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_8">
        <label>8.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>W.</given-names>
              <surname>Zhang</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Maleki</surname>
            </name>
            <name>
              <given-names>M. A.</given-names>
              <surname>Rosen</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Liu</surname>
            </name>
          </person-group>
          <article-title>Sizing a stand-alone solar-wind-hydrogen energy system using weather forecasting and a hybrid search optimization algorithm</article-title>
          <source>Energ. Convers. Manage.</source>
          <year>2019</year>
          <volume>180</volume>
          <issue/>
          <page-range>609-621</page-range>
          <fpage>609</fpage>
          <lpage>621</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.enconman.2018.08.102</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_9">
        <label>9.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>S.</given-names>
              <surname>Basu</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>John</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Kumar</surname>
            </name>
          </person-group>
          <article-title>Design and feasibility analysis of hydrogen based hybrid energy system: A case study</article-title>
          <source>Int. J. Hydrogen Energy</source>
          <year>2021</year>
          <volume>46</volume>
          <issue>0</issue>
          <page-range>pp. 34574-3458</page-range>
          <fpage>pp. 345746</fpage>
          <lpage>pp. 334586</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.ijhydene.2021.08.036</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_10">
        <label>10.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>G. W.</given-names>
              <surname>Cai</surname>
            </name>
            <name>
              <given-names>L. G.</given-names>
              <surname>Kong</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Xue</surname>
            </name>
            <name>
              <given-names>B. Z.</given-names>
              <surname>Sun</surname>
            </name>
          </person-group>
          <article-title>Overview of research on wind power coupled with hydrogen production technology</article-title>
          <source>Autom. Electric Pow. Systems</source>
          <year>2014</year>
          <volume>38</volume>
          <issue>1</issue>
          <page-range>127-135</page-range>
          <fpage>127</fpage>
          <lpage>135</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.7500/AEPS20131231004</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_11">
        <label>11.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>J.</given-names>
              <surname>Li</surname>
            </name>
            <name>
              <given-names>G.</given-names>
              <surname>Li</surname>
            </name>
            <name>
              <given-names>D.</given-names>
              <surname>Liang</surname>
            </name>
            <name>
              <given-names>S.</given-names>
              <surname>Ma</surname>
            </name>
          </person-group>
          <article-title>Review and prospect of hydrogen production technology from renewable energy under targets of carbon peak and carbon neutrality</article-title>
          <source>Distrib. Energy</source>
          <year>2021</year>
          <volume>6</volume>
          <issue>5</issue>
          <page-range>1-9</page-range>
          <fpage>1</fpage>
          <lpage>9</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.16513/j.2096-2185.de.2106528</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_12">
        <label>12.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>A.</given-names>
              <surname>Villagra and P</surname>
            </name>
          </person-group>
          <article-title>An analysis of PEM water electrolysis cells operating at elevated current densities</article-title>
          <source>Int. J. Hydrogen Energy</source>
          <year>2019</year>
          <volume>44</volume>
          <issue>0</issue>
          <page-range>9708-9717</page-range>
          <fpage>9708</fpage>
          <lpage>9717</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.ijhydene.2018.11.179</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_13">
        <label>13.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Z.</given-names>
              <surname>Hong</surname>
            </name>
            <name>
              <given-names>Z.</given-names>
              <surname>Wei</surname>
            </name>
            <name>
              <given-names>X.</given-names>
              <surname>Han</surname>
            </name>
          </person-group>
          <article-title>Optimization scheduling control strategy of wind-hydrogen system considering hydrogen production efficiency</article-title>
          <source>J. Energy Storage</source>
          <year>2022</year>
          <volume>47</volume>
          <issue/>
          <page-range/>
          <fpage/>
          <lpage/>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.est.2021.103609</pub-id>
          <pub-id pub-id-type="publisher-id">103609</pub-id>
        </element-citation>
      </ref>
      <ref id="ref_14">
        <label>14.</label>
        <element-citation publication-type="report" publisher-type="gov">
          <article-title>EU Harmonised Polarisation Curve Test Method for Low Temperature Water Electrolysis</article-title>
          <source>JRC104045</source>
          <year>2018</year>
          <publisher-name>Publications Office of the European Union</publisher-name>
          <publisher-loc>Luxembourg</publisher-loc>
        </element-citation>
      </ref>
      <ref id="ref_15">
        <label>15.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Y.</given-names>
              <surname>Fang</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>X. Z.</given-names>
              <surname>Tian</surname>
            </name>
          </person-group>
          <article-title>Capacity economical optimization of non-grid-connected wind/hydrogen hybrid micro power grid</article-title>
          <source>Comput. Simulat.</source>
          <year>2020</year>
          <volume>37</volume>
          <issue>2</issue>
          <page-range>110-114</page-range>
          <fpage>110</fpage>
          <lpage>114</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_16">
        <label>16.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Z. H.</given-names>
              <surname>Deng and Y</surname>
            </name>
            <name>
              <given-names>W.</given-names>
              <surname>Jiang</surname>
            </name>
          </person-group>
          <article-title>Optimal sizing of a wind-hydrogen system under consideration of the efficiency features of electrolysers</article-title>
          <source>Renew. Energy Resour.</source>
          <year>2020</year>
          <volume>38</volume>
          <issue>2</issue>
          <page-range>259-266</page-range>
          <fpage>259</fpage>
          <lpage>266</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.13941/j.cnki.21-1469/tk.2020.02.018</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_17">
        <label>17.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>W.</given-names>
              <surname>Dong</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Li</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Xiang</surname>
            </name>
          </person-group>
          <article-title>Optimal sizing of a stand-alone hybrid power system based on battery/hydrogen with an improved ant colony optimization</article-title>
          <source>Energies</source>
          <year>2016</year>
          <volume>9</volume>
          <issue>0</issue>
          <page-range/>
          <fpage/>
          <lpage/>
          <pub-id pub-id-type="doi">https://doi.org/10.3390/en9100785</pub-id>
          <pub-id pub-id-type="publisher-id">785</pub-id>
        </element-citation>
      </ref>
      <ref id="ref_18">
        <label>18.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>A.</given-names>
              <surname>Maleki</surname>
            </name>
          </person-group>
          <article-title>Design and optimization of autonomous solar-wind-reverse osmosis desalination systems coupling battery and hydrogen energy storage by an improved bee algorithm</article-title>
          <source>Desalin.</source>
          <year>2018</year>
          <volume>435</volume>
          <issue/>
          <page-range>221-234</page-range>
          <fpage>221</fpage>
          <lpage>234</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.desal.2017.05.034</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_19">
        <label>19.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>A.</given-names>
              <surname>Emrani</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Berrada</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Arechkik</surname>
            </name>
            <name>
              <given-names>M.</given-names>
              <surname>Bakhouya</surname>
            </name>
          </person-group>
          <article-title>Improved techno-economic optimization of an off-grid hybrid solar/wind/gravity energy storage system based on performance indicators</article-title>
          <source>J. Energy Storage</source>
          <year>2022</year>
          <volume>49</volume>
          <issue/>
          <page-range/>
          <fpage/>
          <lpage/>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.est.2022.104163</pub-id>
          <pub-id pub-id-type="publisher-id">104163</pub-id>
        </element-citation>
      </ref>
      <ref id="ref_20">
        <label>20.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>A.</given-names>
              <surname>Mahesh and K</surname>
            </name>
            <name>
              <given-names>S.</given-names>
              <surname>Sandhu</surname>
            </name>
          </person-group>
          <article-title>A genetic algorithm based improved optimal sizing strategy for solar-wind-battery hybrid system using energy filter algorithm</article-title>
          <source>Front. Energy</source>
          <year>2020</year>
          <volume>14</volume>
          <issue>1</issue>
          <page-range>139-151</page-range>
          <fpage>139</fpage>
          <lpage>151</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.est.2022.104163</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
    </ref-list>
  </back>
</article>