<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.3 20210610//EN" "JATS-journalpublishing1-3.dtd">
<article xml:lang="en" dtd-version="1.3" article-type="research-article" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">JISC</journal-id>
      <journal-id journal-id-type="doi">10.56578</journal-id>
      <journal-title-group>
        <journal-title>Journal of Intelligent Systems and Control</journal-title>
        <abbrev-journal-title abbrev-type="issn">J. Intell Syst. Control</abbrev-journal-title>
        <abbrev-journal-title abbrev-type="publisher">JISC</abbrev-journal-title>
      </journal-title-group>
      <issn publication-format="electronic">2957-9813</issn>
      <issn publication-format="print">2957-9805</issn>
      <publisher>
        <publisher-name>Acadlore</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">AR-JJZkja0xZ8R9tF83RK-moMUlzIlhZ-YP</article-id>
      <article-id pub-id-type="doi">10.56578/jisc010103</article-id>
      <title-group>
        <article-title>Modeling and Control Strategy of Wind-Solar Hydrogen Storage Coupled Power Generation System</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <xref ref-type="aff" rid="1">1</xref>
          <name>
            <surname>Yuan</surname>
            <given-names>Tianze</given-names>
          </name>
          <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-4964-4195</contrib-id>
          <email>20211100200@imut.edu.cn</email>
        </contrib>
        <contrib contrib-type="author">
          <xref ref-type="aff" rid="1">1</xref>
          <name>
            <surname>Li</surname>
            <given-names>Hua</given-names>
          </name>
          <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-6186-1400</contrib-id>
          <email>lihua1028@imut.edu.cn</email>
        </contrib>
        <contrib contrib-type="author">
          <xref ref-type="aff" rid="1">1</xref>
          <name>
            <surname>Jia</surname>
            <given-names>Dong</given-names>
          </name>
          <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-8924-0489</contrib-id>
          <email>20211800243@imut.edu.cn</email>
        </contrib>
        <aff id="1">School of Energy and Power Engineering, Inner Mongolia University of Technology, 010051 Hohhot, China</aff>
      </contrib-group>
      <year>2022</year>
      <volume>1</volume>
      <issue>1</issue>
      <fpage>18</fpage>
      <lpage>34</lpage>
      <page-range>18-34</page-range>
      <history>
        <date date-type="received">
          <month>06</month>
          <day>12</day>
          <year>2022</year>
        </date>
        <date date-type="accepted">
          <month>07</month>
          <day>29</day>
          <year>2022</year>
        </date>
        <date date-type="pub">
          <month>10</month>
          <day>29</day>
          <year>2022</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>©2022 by the author(s)</copyright-statement>
        <copyright-year>2022</copyright-year>
        <license>. Published by Acadlore Publishing Services Limited, Hong Kong. This article is available for free download and can be reused and cited, provided that the original published version is credited, under the <a href='https://creativecommons.org/licenses/by/4.0/' target='_blank' class='text-yellow-700 hover:underline'>CC BY 4.0 license</a>.</license>
      </permissions>
      <abstract><p>Hydrogen production by wind and solar hybrid power generation is an important means to solve the strong randomness and high volatility of wind and solar power generation. In this paper, the permanent magnet direct-drive wind turbine, photovoltaic power generation unit, battery pack, and electrolyzer are assembled in the AC bus, and the mathematical model of the wind-solar hydrogen storage coupled power generation system and the simulation model in PSCAD/EMTDC are established. An energy coordination control strategy is designed. After simulation, the proposed control strategy can effectively reduce the rate of curtailment of wind and solar power, and stabilize the fluctuation of wind and solar power generation. It verifies that the established model is correct and the control strategy is effective and feasible.</p></abstract>
      <kwd-group>
        <kwd>Wind-solar hybrid</kwd>
        <kwd>Hydrogen energy</kwd>
        <kwd>Wind-solar hydrogen storage</kwd>
        <kwd>Control strategy</kwd>
        <kwd>Modeling</kwd>
      </kwd-group>
      <counts>
        <count count-type="contributors">3</count>
        <fig-count>13</fig-count>
        <table-count>2</table-count>
        <ref-count>20</ref-count>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec disp-level="level1" sec-type="intro">
      <title>1. Introduction</title>
      <p style="text-align: justify;">In recent years, the environmental problems caused by the large-scale use of fossil energy are becoming more and more serious And, fossil energy is a non-renewable energy, the massive use of fossil energy has gradually brought about a global energy crisis. New energy power generation technology has the advantages of clean and renewable [<xref ref-type="bibr" rid="ref_1">1</xref>], the research on new energy power generation technology has been widely concerned and highly valued by countries all over the world. Wind energy and solar energy are the two main technologies for new energy power generation, however, due to the strong randomness and volatility of wind and solar energy, high rate of abandonment of wind and light. Consume excess wind power and photovoltaics by electrolyzing water to produce hydrogen, and use batteries to make up for the lack of wind power and photovoltaic power generation is an important meansto solve the strong volatility of wind power and photovoltaic power generation [<xref ref-type="bibr" rid="ref_2">2</xref>].</p><p style="text-align: justify;">There have been many studies on hydrogen production from wind power and photovoltaics. Reference [<xref ref-type="bibr" rid="ref_3">3</xref>] reviewed the system composition and energy management strategies of wind-solar-hydrogen coupled power generation. Cai et al. [<xref ref-type="bibr" rid="ref_4">4</xref>] proposes a grid-connected power generation system in which wind power, photovoltaics, hydrogen production, and supercapacitors are assembled on the DC bus, and proposes corresponding control strategies according to four operating scenarios, which can suppress short-term wind and light energy fluctuations and reduce waste. Kinoshita et al. [<xref ref-type="bibr" rid="ref_5">5</xref>] proposed to electrolyze the excess power of wind power to produce hydrogen, which greatly reduces the wind curtailment rate, but the control strategy of the electrolyzer switch limits the power generation efficiency of the wind farm. Abdelkafi and Krichen [<xref ref-type="bibr" rid="ref_6">6</xref>] proposes a power generation system that combines wind power to produce hydrogen with fuel cells and supercapacitors, and adjusts the power generation according to the energy storage level to adapt to the load. This control strategy significantly improves the power generation efficiency and reliability of the system. Lu et al. [<xref ref-type="bibr" rid="ref_7">7</xref>] proposes an energy management strategy for a wind-hydrogen coupled power generation system, which uses the fast response capability of supercapacitors to make up for the shortcomings of the slow response speed of electrolyzers and fuel cells. Zhang et al. [<xref ref-type="bibr" rid="ref_8">8</xref>] proposes an energy coordinated control strategy for wind-hydrogen coupled power generation under three operating conditions, and introduces super capacitors to reduce the voltage change at the grid connection point, which verifies the effectiveness of its control strategy. Maamouri et al. [<xref ref-type="bibr" rid="ref_9">9</xref>] studied the proton exchange membrane electrolyzer and its converter, and proposed a control method of electrolyzer operation, and verified its control strategy through simulation.</p><p style="text-align: justify;">The above studies are mainly focused on wind power hydrogen production systems, and most studies use supercapacitors to make up for short-term power shortages [<xref ref-type="bibr" rid="ref_10">10</xref>]. In order to make full use of wind energy and solar energy and stabilize long-term wind and wind fluctuations, this paper constructs a structure in which permanent magnet direct-drive wind turbines, photovoltaic power generation units, storage batteries, and proton exchange membrane electrolyzers are collected on the AC bus through the converter. This paper firstly establishes the mathematical model of each module in PSCAD/EMTDC software, and considers the hydrogen storage state of the hydrogen storage tank and the output characteristics of the battery, and designs a set of energy management strategies for the coupling system of wind power, photovoltaic, hydrogen production and energy storage and its various the module inverter control strategy makes the output of each module complementary and controllable, and stabilizes the fluctuation of wind and solar output. Finally, the effectiveness and feasibility of the control strategy are verified by simulation.</p>
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>2. Model building</title>
      
        <sec disp-level="level2">
          
            <title>2.1. Wind turbine modeling</title>
          
          <p>A wind turbine is a component in a wind power system that converts wind energy into mechanical energy, the wind power equation is [<xref ref-type="bibr" rid="ref_11">11</xref>]:</p>
          
            <disp-formula>
              <label>(1)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>P</mi>
                  <mi>w</mi>
                </msub>
                <msub>
                  <mi>C</mi>
                  <mi>p</mi>
                </msub>
                <mo>=</mo>
                <mo stretchy="false">(</mo>
                <mo>,</mo>
                <mo stretchy="false">)</mo>
                <mfrac>
                  <mn>1</mn>
                  <mn>2</mn>
                </mfrac>
                <mi>A</mi>
                <mi>ρ</mi>
                <mi>λ</mi>
                <mi>θ</mi>
                <msubsup>
                  <mi>v</mi>
                  <mi>w</mi>
                  <mn>3</mn>
                </msubsup>
              </math>
            </disp-formula>
          
          <p style="text-align: justify;">In the above formula: <italic>Pw</italic> is the mechanical power extracted from the wind turbine; <italic>Cp</italic> is the power coefficient with respect to <italic>λ</italic> and <italic>θ</italic>; <italic>λ</italic> is the tip speed ratio; <italic>θ</italic> is the pitch angle; A is the area (<italic>m</italic><sup>2</sup>) covered by the blades of a wind turbine as they rotate; <italic>ρ</italic> is the air density; <italic>v</italic><sub><italic>w</italic></sub> is wind speed.</p><p style="text-align: justify;">First, the <italic>d</italic><sub><italic>q</italic></sub> coordinate system is constructed. The central axis of the magnetic field <italic>N</italic> pole generated by the rotor magnetic pole of the synchronous motor is taken as the d axis, and the position of the electric angle 90° ahead of the straight axis is defined as the q axis. The intersection of the two axes is the origin of <italic>d</italic><sub><italic>q</italic></sub> coordinate system. In the <italic>d</italic><sub><italic>q</italic></sub> coordinate system, the voltage equation of the permanent magnet synchronous generator (PMSG) is [<xref ref-type="bibr" rid="ref_12">12</xref>], [<xref ref-type="bibr" rid="ref_13">13</xref>]: </p>
          
            <disp-formula>
              <label>(2)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>R</mi>
                          <mrow data-mjx-texclass="ORD">
                            <msup>
                              <mrow data-mjx-texclass="ORD">
                                <mi mathvariant="bold">s</mi>
                              </mrow>
                              <mi>i</mi>
                            </msup>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>L</mi>
                          <mi>d</mi>
                        </msub>
                        <msub>
                          <mi>ω</mi>
                          <mi>s</mi>
                        </msub>
                        <msub>
                          <mi>L</mi>
                          <mi>q</mi>
                        </msub>
                        <mo>=</mo>
                        <mo>−</mo>
                        <mo>−</mo>
                        <mo>+</mo>
                        <mfrac>
                          <mrow>
                            <mi>d</mi>
                            <mi>i</mi>
                            <mi>d</mi>
                          </mrow>
                          <mrow>
                            <mi>d</mi>
                            <mi>t</mi>
                          </mrow>
                        </mfrac>
                        <msup>
                          <mrow data-mjx-texclass="ORD"/>
                          <mi>i</mi>
                        </msup>
                        <mi>q</mi>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>q</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>R</mi>
                          <mrow data-mjx-texclass="ORD">
                            <msup>
                              <mrow data-mjx-texclass="ORD">
                                <mi mathvariant="bold">s</mi>
                              </mrow>
                              <mi>i</mi>
                            </msup>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>L</mi>
                          <mi>q</mi>
                        </msub>
                        <msub>
                          <mi>ω</mi>
                          <mi>s</mi>
                        </msub>
                        <msub>
                          <mi>L</mi>
                          <mrow data-mjx-texclass="ORD">
                            <msup>
                              <mi>d</mi>
                              <mi>i</mi>
                            </msup>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>ω</mi>
                          <mi>s</mi>
                        </msub>
                        <msub>
                          <mi mathvariant="normal">Ψ</mi>
                          <mi>f</mi>
                        </msub>
                        <mo>=</mo>
                        <mo>−</mo>
                        <mo>−</mo>
                        <mo>−</mo>
                        <mo>+</mo>
                        <mfrac>
                          <mrow>
                            <mi>d</mi>
                            <mi>i</mi>
                            <mi>q</mi>
                          </mrow>
                          <mrow>
                            <mi>d</mi>
                            <mi>t</mi>
                          </mrow>
                        </mfrac>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>The shafting model of PMSG is:</p>
          
            <disp-formula>
              <label>(3)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mi>J</mi>
                <mi>B</mi>
                <mfrac>
                  <mrow>
                    <mi>d</mi>
                    <msub>
                      <mi>ω</mi>
                      <mi>m</mi>
                    </msub>
                  </mrow>
                  <mrow>
                    <mi>d</mi>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <mo>=</mo>
                <mo>−</mo>
                <mo>−</mo>
                <msub>
                  <mi>T</mi>
                  <mi>m</mi>
                </msub>
                <msub>
                  <mi>T</mi>
                  <mi>e</mi>
                </msub>
                <msub>
                  <mi>ω</mi>
                  <mi>m</mi>
                </msub>
              </math>
            </disp-formula>
          
          <p style="text-align: justify;">In the above formula:<italic> T</italic><sub><italic>m</italic></sub> is the mechanical torque of the fan; <italic>T</italic><sub><italic>e</italic></sub> is the electromagnetic torque;<italic> J</italic> is the moment of inertia of the permanent magnet machine rotor; <italic>ω</italic><sub><italic>m</italic></sub> is the wind turbine speed; <italic>B</italic> is the viscosity coefficient.</p>
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>2.2. Modeling of photovoltaic power generation units</title>
          
          <p>The mathematical model of photovoltaic power generation unit is:</p>
          
            <disp-formula>
              <label>(4)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mi>I</mi>
                <mi>d</mi>
                <mi>I</mi>
                <mo>=</mo>
                <mo>⋅</mo>
                <mo>+</mo>
                <msub>
                  <mi>N</mi>
                  <mi>p</mi>
                </msub>
                <msub>
                  <mi>I</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>S</mi>
                    <mi>C</mi>
                  </mrow>
                </msub>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">}</mo>
                  <mn>1</mn>
                  <msub>
                    <mi>C</mi>
                    <mn>1</mn>
                  </msub>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">[</mo>
                    <mo data-mjx-texclass="NONE">⁡</mo>
                    <mo>−</mo>
                    <mo data-mjx-texclass="CLOSE">]</mo>
                    <mi>exp</mi>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">(</mo>
                      <mo data-mjx-texclass="CLOSE">)</mo>
                      <mfrac>
                        <mrow>
                          <mi>U</mi>
                          <mi>d</mi>
                          <mi>U</mi>
                          <mo>−</mo>
                        </mrow>
                        <mrow>
                          <msub>
                            <mi>C</mi>
                            <mn>2</mn>
                          </msub>
                          <msub>
                            <mi>N</mi>
                            <mi>S</mi>
                          </msub>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>O</mi>
                              <mi>C</mi>
                            </mrow>
                          </msub>
                        </mrow>
                      </mfrac>
                    </mrow>
                    <mn>1</mn>
                  </mrow>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the formula:</p>
          
            <disp-formula>
              <label>(5)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>C</mi>
                  <mn>1</mn>
                </msub>
                <mo>=</mo>
                <mo>⋅</mo>
                <mo data-mjx-texclass="NONE">⁡</mo>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <mn>1</mn>
                  <mfrac>
                    <msub>
                      <mi>I</mi>
                      <mi>m</mi>
                    </msub>
                    <msub>
                      <mi>I</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>S</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <mfrac>
                    <msub>
                      <mi>U</mi>
                      <mi>m</mi>
                    </msub>
                    <mrow>
                      <msub>
                        <mi>C</mi>
                        <mn>2</mn>
                      </msub>
                      <msub>
                        <mi>U</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>o</mi>
                          <mi>c</mi>
                        </mrow>
                      </msub>
                    </mrow>
                  </mfrac>
                </mrow>
                <mi>exp</mi>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(6)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>C</mi>
                  <mn>2</mn>
                </msub>
                <mo>=</mo>
                <mfrac>
                  <mrow>
                    <mfrac>
                      <msub>
                        <mi>U</mi>
                        <mi>m</mi>
                      </msub>
                      <msub>
                        <mi>U</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>o</mi>
                          <mi>c</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                    <mo>−</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow>
                    <mi>ln</mi>
                    <mo data-mjx-texclass="NONE">⁡</mo>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">(</mo>
                      <mo>−</mo>
                      <mo data-mjx-texclass="CLOSE">)</mo>
                      <mn>1</mn>
                      <mfrac>
                        <msub>
                          <mi>I</mi>
                          <mi>m</mi>
                        </msub>
                        <msub>
                          <mi>I</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>s</mi>
                            <mi>c</mi>
                          </mrow>
                        </msub>
                      </mfrac>
                    </mrow>
                  </mrow>
                </mfrac>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(7)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mi>d</mi>
                <mi>I</mi>
                <mi>α</mi>
                <mo>=</mo>
                <mo>−</mo>
                <mo>+</mo>
                <mo>⋅</mo>
                <mfrac>
                  <mi>G</mi>
                  <msub>
                    <mi>G</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>r</mi>
                      <mi>e</mi>
                      <mi>f</mi>
                    </mrow>
                  </msub>
                </mfrac>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <msub>
                    <mi>T</mi>
                    <mi>e</mi>
                  </msub>
                  <msub>
                    <mi>T</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>r</mi>
                      <mi>e</mi>
                      <mi>f</mi>
                    </mrow>
                  </msub>
                </mrow>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <mfrac>
                    <mi>G</mi>
                    <msub>
                      <mi>G</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>r</mi>
                        <mi>e</mi>
                        <mi>f</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mn>1</mn>
                </mrow>
                <msub>
                  <mi>N</mi>
                  <mi>p</mi>
                </msub>
                <msub>
                  <mi>I</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>s</mi>
                    <mi>c</mi>
                  </mrow>
                </msub>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(8)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mi>d</mi>
                <mi>U</mi>
                <mi>β</mi>
                <mi>d</mi>
                <mi>T</mi>
                <mi>d</mi>
                <mi>I</mi>
                <mo>=</mo>
                <mo>−</mo>
                <msub>
                  <mi>R</mi>
                  <mi>s</mi>
                </msub>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(9)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>T</mi>
                  <mi>e</mi>
                </msub>
                <msub>
                  <mi>T</mi>
                  <mi>a</mi>
                </msub>
                <msub>
                  <mi>t</mi>
                  <mi>c</mi>
                </msub>
                <mo>=</mo>
                <mo>+</mo>
                <mi>G</mi>
              </math>
            </disp-formula>
          
          <p>In the above formula: <italic>U</italic><sub><italic>oc</italic></sub> is the open circuit voltage of photovoltaic modules; <italic>I</italic><sub><italic>sc</italic></sub> is the short-circuit current of photovoltaic modules; <italic>U</italic><sub><italic>m</italic></sub> is the maximum power point voltage of photovoltaic modules; <italic>I</italic><sub><italic>m</italic></sub> is the maximum power point current of the photovoltaic module; <italic>G</italic> is the solar radiation intensity; <italic>α</italic> is the current temperature variation coefficient; <italic>β</italic> is the voltage temperature variation coefficient; <italic>T</italic><sub><italic>a</italic></sub> is the ambient temperature; <italic>t</italic><sub><italic>c</italic></sub><italic> </italic>is the temperature variation coefficient of photovoltaic modules; <italic>R</italic><sub><italic>s</italic></sub> is the series resistance of the component; <italic>N</italic><sub><italic>p</italic></sub> is the parallel number of modules in the PV array; <italic>N</italic><sub><italic>S</italic></sub><italic> </italic>is the serial number of modules in the PV array.</p>
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>2.3. Battery modeling</title>
          
          <p>The battery mathematical model is:</p>
          
            <disp-formula>
              <label>(10)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mi>E</mi>
                <mo>=</mo>
                <mo>−</mo>
                <mo>+</mo>
                <msub>
                  <mi>N</mi>
                  <mi>s</mi>
                </msub>
                <msub>
                  <mi>E</mi>
                  <mn>0</mn>
                </msub>
                <msub>
                  <mi>E</mi>
                  <mi>t</mi>
                </msub>
                <mfrac>
                  <mrow>
                    <mi>K</mi>
                    <mi>S</mi>
                    <mi>O</mi>
                    <mi>C</mi>
                  </mrow>
                  <mrow>
                    <mi>S</mi>
                    <mi>O</mi>
                    <mi>C</mi>
                    <mi>i</mi>
                    <mi>τ</mi>
                    <mi>d</mi>
                    <mi>τ</mi>
                    <mo>−</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <msub>
                      <mi>N</mi>
                      <mi>s</mi>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mi>n</mi>
                    </msub>
                    <msubsup>
                      <mo data-mjx-texclass="OP">∫</mo>
                      <mn>0</mn>
                      <mi>t</mi>
                    </msubsup>
                  </mrow>
                </mfrac>
              </math>
            </disp-formula>
          
          <p>In the formula:</p>
          
            <disp-formula>
              <label>(11)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mi>S</mi>
                <mi>O</mi>
                <mi>C</mi>
                <mi mathvariant="normal">%</mi>
                <mo>=</mo>
                <mo>×</mo>
                <mfrac>
                  <mrow>
                    <msub>
                      <mi>N</mi>
                      <mi>s</mi>
                    </msub>
                    <msub>
                      <mi>N</mi>
                      <mi>p</mi>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mi>n</mi>
                    </msub>
                    <mo>−</mo>
                    <mo stretchy="false">(</mo>
                    <mo stretchy="false">)</mo>
                    <msubsup>
                      <mo data-mjx-texclass="OP">∫</mo>
                      <mn>0</mn>
                      <mi>t</mi>
                    </msubsup>
                    <mi>i</mi>
                    <mi>τ</mi>
                    <mi>d</mi>
                    <mi>τ</mi>
                  </mrow>
                  <mrow>
                    <msub>
                      <mi>N</mi>
                      <mi>s</mi>
                    </msub>
                    <msub>
                      <mi>N</mi>
                      <mi>p</mi>
                    </msub>
                    <msub>
                      <mi>Q</mi>
                      <mi>n</mi>
                    </msub>
                  </mrow>
                </mfrac>
                <mn>100</mn>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(12)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>E</mi>
                  <mi>t</mi>
                </msub>
                <mo>=</mo>
                <mo data-mjx-texclass="NONE">⁡</mo>
                <mi>A</mi>
                <mi>exp</mi>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>−</mo>
                  <mo stretchy="false">(</mo>
                  <mo stretchy="false">)</mo>
                  <mo>+</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <mi>B</mi>
                  <mi>i</mi>
                  <mi>τ</mi>
                  <mi>τ</mi>
                  <msubsup>
                    <mo data-mjx-texclass="OP">∫</mo>
                    <mn>0</mn>
                    <mi>t</mi>
                  </msubsup>
                  <mrow data-mjx-texclass="ORD">
                    <mi mathvariant="normal">d</mi>
                  </mrow>
                  <msub>
                    <mrow data-mjx-texclass="ORD">
                      <mi mathvariant="normal">C</mi>
                    </mrow>
                    <mi>b</mi>
                  </msub>
                </mrow>
              </math>
            </disp-formula>
          
          
            <disp-formula>
              <label>(13)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>C</mi>
                  <mi>b</mi>
                </msub>
                <msub>
                  <mi>C</mi>
                  <mi>t</mi>
                </msub>
                <mo>=</mo>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <msub>
                    <mi>T</mi>
                    <mi>b</mi>
                  </msub>
                  <mn>25</mn>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula: <italic>E</italic><sub><italic>0</italic></sub> is the initial potential; <italic>K</italic> is the polarization voltage constant; <italic>N</italic><sub><italic>s</italic></sub> is the number of batteries in series; <italic>N</italic><sub><italic>p</italic></sub> is the number of parallel battery packs; <italic>A</italic> is the voltage variation coefficient; <italic>B</italic> is the capacity change coefficient; <italic>Q</italic><sub><italic>n</italic></sub> is the rated capacity of the battery; SOC is the state of charge;<italic> i</italic>(<italic>t</italic>) is the charge and discharge current; <italic>C</italic><sub>(</sub><sub><italic>t</italic></sub><sub>)</sub> is the polarization effect coefficient; <italic>T</italic><sub><italic>b</italic></sub> is the battery temperature.</p>
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>2.4. Electrolyzer model</title>
          
          <p>This paper chooses to model the Proton Exchange Membrane Electrolysis (PEMEL) cell. Proton exchange membrane electrolyzer has high current density, good safety of alkaline free solution, rapid startup and shutdown, high hydrogen production purity, and a certain overload range. It can be used in combination with natural random wind power and photoelectric. The PEMEL mathematical model is [<xref ref-type="bibr" rid="ref_14">14</xref>]:</p>
          
            <disp-formula>
              <label>(14)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>V</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>ele </mtext>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>E</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>ele </mtext>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>V</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>el,act </mtext>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>V</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>el,ohm </mtext>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo>+</mo>
                        <mo>+</mo>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>E</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>ele </mtext>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo>+</mo>
                        <mfrac>
                          <mrow>
                            <mi mathvariant="normal">Δ</mi>
                            <msub>
                              <mi>G</mi>
                              <mi>f</mi>
                            </msub>
                          </mrow>
                          <mrow>
                            <mn>2</mn>
                            <mi>F</mi>
                          </mrow>
                        </mfrac>
                        <mfrac>
                          <mrow>
                            <mi>R</mi>
                            <msub>
                              <mi>T</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <mrow>
                            <mn>2</mn>
                            <mi>F</mi>
                          </mrow>
                        </mfrac>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">[</mo>
                          <mo data-mjx-texclass="NONE">⁡</mo>
                          <mo data-mjx-texclass="CLOSE">]</mo>
                          <mi>ln</mi>
                          <mrow data-mjx-texclass="INNER">
                            <mo data-mjx-texclass="OPEN">(</mo>
                            <mo data-mjx-texclass="CLOSE">)</mo>
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <msub>
                                      <mi>H</mi>
                                      <mn>2</mn>
                                    </msub>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <msub>
                                      <mi>O</mi>
                                      <mn>2</mn>
                                    </msub>
                                  </mrow>
                                </msub>
                                <msup>
                                  <mrow data-mjx-texclass="ORD"/>
                                  <mrow data-mjx-texclass="ORD">
                                    <mfrac>
                                      <mn>1</mn>
                                      <mn>2</mn>
                                    </mfrac>
                                  </mrow>
                                </msup>
                              </mrow>
                              <msub>
                                <mi>a</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <msub>
                                    <mi>H</mi>
                                    <mn>2</mn>
                                  </msub>
                                  <mi>O</mi>
                                </mrow>
                              </msub>
                            </mfrac>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>V</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>el,act </mtext>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo data-mjx-texclass="NONE">⁡</mo>
                        <mfrac>
                          <mrow>
                            <mi>R</mi>
                            <msub>
                              <mi>T</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>e</mi>
                                <mi>l</mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <mrow>
                            <mn>2</mn>
                            <mi>α</mi>
                            <mi>F</mi>
                          </mrow>
                        </mfrac>
                        <mi>ln</mi>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <mfrac>
                            <mi>i</mi>
                            <msub>
                              <mi>i</mi>
                              <mn>0</mn>
                            </msub>
                          </mfrac>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>V</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>el,ohm </mtext>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>R</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>el,ohm </mtext>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo>=</mo>
                        <mi>i</mi>
                        <mfrac>
                          <msub>
                            <mi>t</mi>
                            <mi>m</mi>
                          </msub>
                          <msub>
                            <mi>σ</mi>
                            <mi>m</mi>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>σ</mi>
                          <mi>m</mi>
                        </msub>
                        <mo>=</mo>
                        <mo data-mjx-texclass="NONE">⁡</mo>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo>−</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <mn>0.00514</mn>
                          <mn>0.00326</mn>
                          <msub>
                            <mi>λ</mi>
                            <mi>m</mi>
                          </msub>
                        </mrow>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <mn>1268</mn>
                          <mrow data-mjx-texclass="INNER">
                            <mo data-mjx-texclass="OPEN">(</mo>
                            <mo>−</mo>
                            <mo data-mjx-texclass="CLOSE">)</mo>
                            <mfrac>
                              <mn>1</mn>
                              <mn>303</mn>
                            </mfrac>
                            <mfrac>
                              <mn>1</mn>
                              <msub>
                                <mi>T</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>e</mi>
                                  <mi>l</mi>
                                </mrow>
                              </msub>
                            </mfrac>
                          </mrow>
                        </mrow>
                        <mi>exp</mi>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula: <italic>V</italic><sub><italic>ele</italic></sub> is the cell voltage; E<sub>ele</sub> is the open circuit voltage; <italic>V</italic><sub><italic>el,act</italic></sub> is the activation polarization voltage; <italic>V</italic><sub><italic>el.ohm</italic></sub> is the ohmic polarization voltage; <italic>F</italic> is Faraday's constant; <italic>R</italic> is the gas constant; <italic>G</italic><sub><italic>f</italic></sub> &amp;amp;nbsp;is Gibbs free energy; <italic>T</italic><sub><italic>el</italic></sub> is the temperature of the electrolytic cell; <italic>λ</italic><sub><italic>m</italic></sub> is the water content of the membrane; <italic>i</italic> is the current density;<italic> i</italic><sub><italic>0</italic></sub> is the exchange current density; <italic>σ</italic> is the membrane conductivity; <italic>α</italic> is the transfer coefficient.</p><p>The hydrogen production rate of the electrolyzer is:</p>
          
            <disp-formula>
              <label>(15)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>v</mi>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>H</mi>
                              <mn>2</mn>
                            </msub>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>I</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>e</mi>
                            <mi>l</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mi>η</mi>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo>,</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <msub>
                            <mi>T</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>e</mi>
                              <mi>l</mi>
                            </mrow>
                          </msub>
                          <mi>j</mi>
                        </mrow>
                        <mfrac>
                          <msub>
                            <mi>N</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>e</mi>
                              <mi>l</mi>
                            </mrow>
                          </msub>
                          <mrow>
                            <mn>2</mn>
                            <mi>F</mi>
                          </mrow>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mi>η</mi>
                        <mi>exp</mi>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo>,</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <msub>
                            <mi>T</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>e</mi>
                              <mi>l</mi>
                            </mrow>
                          </msub>
                          <mi>j</mi>
                        </mrow>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo>+</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <mfrac>
                            <mrow>
                              <msub>
                                <mi>a</mi>
                                <mn>2</mn>
                              </msub>
                              <msub>
                                <mi>a</mi>
                                <mn>3</mn>
                              </msub>
                              <msub>
                                <mi>T</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>e</mi>
                                  <mi>l</mi>
                                </mrow>
                              </msub>
                              <mo>+</mo>
                            </mrow>
                            <mi>j</mi>
                          </mfrac>
                          <mfrac>
                            <mrow>
                              <msub>
                                <mi>a</mi>
                                <mn>4</mn>
                              </msub>
                              <msub>
                                <mi>a</mi>
                                <mn>5</mn>
                              </msub>
                              <msub>
                                <mi>T</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>e</mi>
                                  <mi>l</mi>
                                </mrow>
                              </msub>
                              <mo>+</mo>
                            </mrow>
                            <msup>
                              <mi>j</mi>
                              <mn>2</mn>
                            </msup>
                          </mfrac>
                        </mrow>
                        <mo>=</mo>
                        <mo data-mjx-texclass="NONE">⁡</mo>
                        <msub>
                          <mi>a</mi>
                          <mn>1</mn>
                        </msub>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula: <italic>v</italic><sub><italic>H2</italic></sub> is the hydrogen production rate;<italic> j</italic> is the current density; <italic>I</italic><sub><italic>el</italic></sub> is the electrolyzer current; <italic>ɑ</italic> is the Faraday efficiency coefficient; <italic>N</italic><sub><italic>el</italic></sub> is the number of electrolyzers in series.</p>
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>2.5. Hydrogen storage tank modeling</title>
          
          <p>In this paper, the high-pressure gas pipe is used to store hydrogen, and the hydrogen storage tank is modeled from the aspects of hydrogen storage capacity and gas tank pressure. The mathematical model of the hydrogen storage tank is:</p>
          
            <disp-formula>
              <label>(16)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>H</mi>
                              <mn>2</mn>
                            </msub>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>v</mi>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>H</mi>
                              <mn>2</mn>
                            </msub>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>n</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>=</mo>
                        <mo>+</mo>
                        <msubsup>
                          <mo data-mjx-texclass="OP">∫</mo>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>t</mi>
                              <mn>1</mn>
                            </msub>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <msub>
                              <mi>t</mi>
                              <mn>2</mn>
                            </msub>
                          </mrow>
                        </msubsup>
                        <mi>d</mi>
                        <mi>t</mi>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <msub>
                            <mi>t</mi>
                            <mn>0</mn>
                          </msub>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>P</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mi>R</mi>
                            <msub>
                              <mi>T</mi>
                              <mi>s</mi>
                            </msub>
                          </mrow>
                          <msub>
                            <mi>V</mi>
                            <mi>s</mi>
                          </msub>
                        </mfrac>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <msub>
                            <mi>M</mi>
                            <mrow data-mjx-texclass="ORD">
                              <msub>
                                <mi>H</mi>
                                <mn>2</mn>
                              </msub>
                            </mrow>
                          </msub>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula: <italic>P</italic><sub><italic>s</italic></sub> is the pressure of the hydrogen storage tank; <italic>M</italic><sub><italic>H2</italic></sub> is the hydrogen storage capacity of the hydrogen storage tank; <italic>T</italic><sub><italic>s</italic></sub> is the temperature of the hydrogen storage tank; <italic>R</italic> is the gas constant; <italic>n</italic><sub><italic>s</italic></sub>(<italic>t</italic><sub><italic>0</italic></sub>) is the hydrogen storage amount at <italic>t</italic><sub><italic>0</italic></sub>; <italic>Vs</italic> is the volume of the hydrogen storage tank; <italic>t</italic><sub><italic>1</italic></sub> and<italic> t</italic><sub><italic>2</italic></sub> are the beginning and end time of hydrogen storage and hydrogen intake.</p>
        </sec>
      
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>3. System coordination control</title>
      <p style="text-align: justify;">The structure of the wind-solar hydrogen storage coupled power generation system is shown in the <xref ref-type="fig" rid="fig_1">Figure 1</xref>. Wind turbines, photovoltaic arrays, batteries, and electrolyzers are collected on the AC bus through the converter, and then the electric energy is fed into the power grid through the AC bus. The hydrogen produced by the electrolyzer is fed into the hydrogen storage tank through the pipeline for nearby hydrogen energy loads. The system utilizes the surplus power generation when wind and light are abundant to produce hydrogen, reducing the rate of abandoning wind and light. The battery pack is responsible for supplementing the lack of power when wind and photovoltaic power generation is insufficient, and absorbing part of the surplus wind power and photovoltaics. The battery pack is connected to the AC bus through the inverter, which is composed of bidirectional DC converter and grid connected inverter.</p>
      
        <sec disp-level="level2">
          
            <title>3.1. Energy control</title>
          
          <p>The system power balance objective function is: </p>
          
            <disp-formula>
              <label>(17)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>p</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>b</mi>
                            <mi>a</mi>
                            <mi>t</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>l</mi>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>e</mi>
                            <mi>l</mi>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <mo>=</mo>
                        <mo>+</mo>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>p</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mtext>wind </mtext>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>P</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>p</mi>
                            <mi>v</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo>+</mo>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>P</italic><sub><italic>wind</italic></sub> is wind turbine output power;<italic> P</italic><sub><italic>pv</italic></sub> is output power for PV array; <italic>P</italic><sub><italic>bat</italic></sub> is charging and discharging power for battery; <italic>P</italic><sub><italic>ld</italic></sub> is demand power for grid loads; <italic>P</italic><sub><italic>el</italic></sub> is Power consumption for the electrolyzer; <italic>P</italic><sub><italic>wp</italic></sub> is the sum of the output power of wind and photovoltaic power generation units. In addition to considering the rated power of each unit to limit its output, this paper also considers the battery state of charge, the terminal voltage limit, and the upper and lower limits of the hydrogen storage tank pressure.</p><p>The constraints of battery operation are: </p>
          
            <disp-formula>
              <label>(18)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mo data-mjx-texclass="OP" movablelimits="true">min</mo>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>b</mi>
                            <mi>a</mi>
                            <mi>t</mi>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>U</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mo data-mjx-texclass="OP" movablelimits="true">max</mo>
                          </mrow>
                        </msub>
                        <mo>≤</mo>
                        <mo>≤</mo>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mn>15</mn>
                        <mn>90</mn>
                        <mi mathvariant="normal">%</mi>
                        <mi>S</mi>
                        <mi>O</mi>
                        <mi>C</mi>
                        <mi mathvariant="normal">%</mi>
                        <mo>≤</mo>
                        <mo>≤</mo>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>U</italic><sub><italic>bat</italic></sub> is the battery terminal voltage; <italic>U</italic><sub><italic>min</italic></sub> is the lower limit of the battery terminal voltage; <italic>U</italic><sub><italic>max</italic></sub> is the upper limit of the battery terminal voltage; SOC is the battery state of charge.</p><p>The operating constraints of the hydrogen storage tank are:</p>
          
            <disp-formula>
              <label>(19)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mo data-mjx-texclass="OP" movablelimits="true">min</mo>
                  </mrow>
                </msub>
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mtext>tan </mtext>
                  </mrow>
                </msub>
                <msub>
                  <mi>P</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mo data-mjx-texclass="OP" movablelimits="true">max</mo>
                  </mrow>
                </msub>
                <mo>≤</mo>
                <mo>≤</mo>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>P</italic><sub><italic>tan</italic></sub> is the pressure of the hydrogen storage tank;<italic> P</italic><sub><italic>min</italic></sub> is the lower limit of the pressure of the hydrogen storage tank;<italic> P</italic><sub><italic>max</italic></sub> is the upper limit of the pressure of the hydrogen storage tank.</p><p>The system power coordination control method is shown in <xref ref-type="fig" rid="fig_2">Figure 2</xref>. The energy management strategy in this paper is divided into 13 working conditions.</p>
          
            <fig id="fig_1">
              <label>Figure 1</label>
              <caption>Structure of wind-solar hydrogen storage coupled power generation system</caption>
              <abstract/>
              <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_UD-ptrgiRKX6_2OO.png"/>
            </fig>
          
          
            <fig id="fig_2">
              <label>Figure 2</label>
              <caption>System power coordination control</caption>
              <abstract/>
              <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_iyApQNyDsUFnysgB.png"/>
            </fig>
          
          <p>(1). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is less than the upper pressure limit; The rated power of the electrolytic cell is greater than that of wind power and photoelectric power; And make the reference power of the electrolytic cell equal to the power generated by wind power and photoelectric less the grid side load.</p><p>(2). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is greater than the upper pressure limit; The rated power of electrolytic cell shall not be greater than the power generated by wind power and photoelectric power; The terminal voltage of the storage battery is greater than or equal to the upper voltage limit; The reference power of the storage battery is 0, and the reference power of the electrolytic cell is equal to the rated power.</p><p>(3). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is greater than the upper pressure limit; The rated power of electrolytic cell shall not be greater than the power generated by wind power and photoelectric power; The terminal voltage of storage battery is less than the upper limit of voltage; The rated power of the battery pack is greater than that of the wind power and photoelectric power minus the grid side load power minus the rated power of the electrolytic cell; The reference power of the storage battery is equal to the wind power and photoelectric power minus the grid side load power minus the rated power of the electrolytic cell, and the reference power of the electrolytic cell is equal to the rated power.</p><p>(4). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is greater than the upper pressure limit; The rated power of electrolytic cell shall not be greater than the power generated by wind power and photoelectric power; The terminal voltage of storage battery is less than the upper limit of voltage; The rated power of the storage battery shall not be greater than that of the wind power and photoelectric power minus the grid side load power minus the rated power of the electrolytic cell; Make the reference power of the battery pack equal to the rated power of the battery pack and the reference power of the electrolytic cell equal to the rated power.</p><p>(5). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is greater than the upper pressure limit; The terminal voltage of the storage battery is greater than or equal to the upper voltage limit; The reference power of the electrolytic cell is 0 and the reference power of the storage battery is 0.</p><p>(6). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is greater than the upper pressure limit; The terminal voltage of storage battery is less than the upper limit of voltage; The rated power of the storage battery is greater than that of the wind power and photoelectric power minus the load power at the grid side; The reference power of the battery is equal to the power generated by wind power and photoelectric power minus the grid side load power, and the reference power of the electrolytic cell is 0.</p><p>(7). When the output power of wind power and photoelectric power is greater than or equal to the grid side load; The pressure of hydrogen storage tank is greater than the upper pressure limit; The terminal voltage of storage battery is less than the upper limit of voltage; The rated power of the storage battery is less than or equal to the wind power and photovoltaic power minus the load power at the grid side; Make the reference power of the battery equal to the rated power of the battery.</p><p>(8). When the wind power and photoelectric power are less than the grid side load; The pressure of hydrogen storage tank is greater than the lower pressure limit; The terminal voltage of storage battery is less than the lower limit of voltage; Let the reference power of the battery set be 0 and the reference power of the electrolytic cell be 0.</p><p>(9). When the output power of wind power and photoelectric power is less than the grid side load; The pressure of hydrogen storage tank is less than or equal to the lower pressure limit; The terminal voltage of the storage battery is greater than or equal to the lower voltage limit; The rated power is less than or equal to the absolute value of the wind power and photovoltaic power minus the grid side power; Make the reference power of the storage battery set equal to the absolute value of the wind power and photovoltaic power minus the grid side power; Make the reference power of electrolytic cell 0.</p><p>(10). When the wind power and photoelectric power are less than the grid side load; The pressure of hydrogen storage tank is less than or equal to the lower pressure limit; The terminal voltage of the storage battery is greater than or equal to the lower voltage limit; The rated power is less than or equal to the absolute value of the wind power and photovoltaic power minus the grid side power; Make the reference power of the battery set equal to the rated power of the battery set, and make the reference power of the electrolytic cell 0.</p><p>(11). When the output power of wind power and photoelectric power is less than the grid side load; The pressure of hydrogen storage tank is greater than the lower pressure limit; The terminal voltage of the storage battery is less than that of the storage battery; The reference power of the storage battery is 0.</p><p style="text-indent: 10.2pt;">(12). When the wind power and photoelectric power are less than the grid side load; The pressure of hydrogen storage tank is greater than the lower pressure limit; The terminal voltage of the storage battery is less than or equal to that of the storage battery; The rated power of the storage battery is less than or equal to the absolute value of the wind power and photovoltaic power minus the power at the grid side; The reference power of the battery pack is equal to the rated power of the battery pack.</p><p>(13). When the wind power and photoelectric power are less than the grid side load; The pressure of hydrogen storage tank is greater than the lower pressure limit; The terminal voltage of the storage battery is greater than that of the storage battery; The rated power of the storage battery is less than or equal to the absolute value of the wind power and photovoltaic power minus the power at the grid side; The reference power of the battery is equal to the absolute value of the wind power and photoelectric power minus the power at the grid side minus the rated power of the electrolytic cell.</p><p><italic>K</italic><sub><italic>bat</italic></sub> is the battery switch; <italic>K</italic><sub><italic>ele</italic></sub> is the electrolytic cell switch; <italic>K</italic><sub><italic>tan</italic></sub> is the switch of hydrogen storage tank; <italic>P</italic><sub><italic>bat-ref </italic></sub>and <italic>P</italic><sub><italic>ele-ref</italic></sub><italic> </italic>are the battery reference power and the electrolytic cell reference power respectively; <italic>P</italic><sub><italic>batN</italic></sub>,<span style="font-family: 宋体;"> </span><italic>P</italic><sub><italic>eleN</italic></sub> are the rated power of the battery and the rated power of the electrolytic cell, respectively.</p>
        </sec>
      
      
        <sec disp-level="level2">
          
            <title>3.2. Inverter control strategy</title>
          
          <p>The energy management center feeds back the reference value according to the operation of each output unit, and coordinates and controls the output of each unit. The control equation of the inverter on the side of the permanent magnet wind turbine:</p>
          
            <disp-formula>
              <label>(20)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>q</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mo>−</mo>
                            <mo>−</mo>
                            <mo>+</mo>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>1</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>1</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">[</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">]</mo>
                              <mrow data-mjx-texclass="INNER">
                                <mo data-mjx-texclass="OPEN">(</mo>
                                <mo>+</mo>
                                <mo data-mjx-texclass="CLOSE">)</mo>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>p</mi>
                                    <mn>2</mn>
                                  </mrow>
                                </msub>
                                <mfrac>
                                  <msub>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi mathvariant="normal">k</mi>
                                    </mrow>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>i</mi>
                                      <mn>2</mn>
                                    </mrow>
                                  </msub>
                                  <mi>s</mi>
                                </mfrac>
                              </mrow>
                              <mrow data-mjx-texclass="INNER">
                                <mo data-mjx-texclass="OPEN">(</mo>
                                <mo>−</mo>
                                <mo data-mjx-texclass="CLOSE">)</mo>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>r</mi>
                                    <mi>e</mi>
                                    <mi>f</mi>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>P</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>g</mi>
                                    <mi>e</mi>
                                    <mi>n</mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <msub>
                                <mi>i</mi>
                                <mi>q</mi>
                              </msub>
                            </mrow>
                            <msub>
                              <mi>i</mi>
                              <mi>d</mi>
                            </msub>
                            <msub>
                              <mi>ω</mi>
                              <mi>s</mi>
                            </msub>
                            <msub>
                              <mi>L</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>w</mi>
                                <mi>d</mi>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>ω</mi>
                              <mi>s</mi>
                            </msub>
                            <msub>
                              <mi mathvariant="normal">Ψ</mi>
                              <mi>f</mi>
                            </msub>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mo>−</mo>
                            <mo>+</mo>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>3</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>3</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mi>r</mi>
                                  <mi>e</mi>
                                  <mi>f</mi>
                                </mrow>
                              </msub>
                              <msub>
                                <mi>i</mi>
                                <mi>d</mi>
                              </msub>
                            </mrow>
                            <msub>
                              <mi>i</mi>
                              <mi>q</mi>
                            </msub>
                            <msub>
                              <mi>ω</mi>
                              <mi>s</mi>
                            </msub>
                            <msub>
                              <mi>L</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>w</mi>
                                <mi>q</mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>M</italic><sub><italic>wq</italic></sub> is the fan q-axis control pulse;<italic> W</italic><sub><italic>dq</italic></sub><italic> </italic>is the control pulse of the d-axis of the fan; <italic>k</italic><sub><italic>p</italic></sub> and <italic>k</italic><sub><italic>i</italic></sub> are the proportional coefficient and integral coefficient, respectively, and the following are similar; <italic>i</italic><sub><italic>d</italic></sub> is the d-axis current; <italic>i</italic><sub><italic>q</italic></sub> is the q-axis current; <italic>P</italic><sub><italic>ref</italic></sub> reference power for wind turbines; <italic>P</italic><sub><italic>gen</italic></sub> is the actual power of the wind turbine; <italic>L</italic><sub><italic>wd</italic></sub> is the d-axis filter inductance; <italic>L</italic><sub><italic>wq</italic></sub> is the q-axis filter inductance; <italic>U</italic><sub><italic>dc</italic></sub> is the DC link voltage. Since the d-axis current is related to reactive power, <italic>i</italic><sub><italic>derf</italic></sub>=0 is set in the control process.</p><p>The control equation of the grid-side converter of the permanent magnet fan is:</p>
          
            <disp-formula>
              <label>(21)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>q</mi>
                            <mn>1</mn>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>4</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>4</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>q</mi>
                                  <mi>r</mi>
                                  <mi>e</mi>
                                  <mi>f</mi>
                                  <mn>1</mn>
                                </mrow>
                              </msub>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>q</mi>
                                  <mn>1</mn>
                                </mrow>
                              </msub>
                            </mrow>
                            <mo>+</mo>
                            <mo>+</mo>
                            <msub>
                              <mi>i</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>d</mi>
                                <mn>1</mn>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>U</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>q</mi>
                                <mn>2</mn>
                              </mrow>
                            </msub>
                            <mi>ω</mi>
                            <mi>L</mi>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>w</mi>
                            <mi>d</mi>
                            <mn>1</mn>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>5</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>5</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mi>r</mi>
                                  <mi>e</mi>
                                  <mi>f</mi>
                                  <mn>1</mn>
                                </mrow>
                              </msub>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mn>1</mn>
                                </mrow>
                              </msub>
                            </mrow>
                            <mo>+</mo>
                            <mo>−</mo>
                            <msub>
                              <mi>U</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>d</mi>
                                <mn>2</mn>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>i</mi>
                              <mrow data-mjx-texclass="ORD">
                                <mi>q</mi>
                                <mn>1</mn>
                              </mrow>
                            </msub>
                            <mi>ω</mi>
                            <mi>L</mi>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the formula:</p>
          
            <disp-formula>
              <label>(22)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>i</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>d</mi>
                            <mi>r</mi>
                            <mi>e</mi>
                            <mi>f</mi>
                            <mn>1</mn>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo>+</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <msub>
                            <mrow data-mjx-texclass="ORD">
                              <mi mathvariant="normal">k</mi>
                            </mrow>
                            <mrow data-mjx-texclass="ORD">
                              <mi>p</mi>
                              <mn>6</mn>
                            </mrow>
                          </msub>
                          <mfrac>
                            <msub>
                              <mrow data-mjx-texclass="ORD">
                                <mi mathvariant="normal">k</mi>
                              </mrow>
                              <mrow data-mjx-texclass="ORD">
                                <mi>i</mi>
                                <mn>6</mn>
                              </mrow>
                            </msub>
                            <mi>s</mi>
                          </mfrac>
                        </mrow>
                        <mrow data-mjx-texclass="INNER">
                          <mo data-mjx-texclass="OPEN">(</mo>
                          <mo>−</mo>
                          <mo data-mjx-texclass="CLOSE">)</mo>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                              <mi>r</mi>
                              <mi>e</mi>
                              <mi>f</mi>
                            </mrow>
                          </msub>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mrow>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>i</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>q</mi>
                            <mn>1</mn>
                            <mtext> lref </mtext>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mn>0</mn>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>i</italic><sub><italic>q1</italic></sub>,<italic> i</italic><sub><italic>d1</italic></sub>, <italic>U</italic><sub><italic>q2</italic></sub>, <italic>U</italic><sub><italic>d2</italic></sub> are the components of the grid-side current and voltage on the q-axis and the d-axis, respectively; <italic>M</italic><sub><italic>wq1</italic></sub>, <italic>M</italic><sub><italic>wq1</italic></sub> are the control pulses of the q-axis and d-axis of the grid-side converter of the fan respectively. Since the reactive power output of the grid-side converter can be controlled by controlling the q-axis current, and the DC-side voltage can be stabilized by controlling the d-axis current, the grid-side converter is set to <italic>i</italic><sub><italic>q1ref</italic></sub>=0, and <italic>i</italic><sub><italic>d1ref</italic></sub><italic> </italic>is obtained from the DC link voltage through the PI controller. The control equation of the photovoltaic unit DC/DC converter is:</p>
          
            <disp-formula>
              <label>(23)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>M</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>p</mi>
                    <mi>v</mi>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mfrac>
                  <mrow>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">(</mo>
                      <mo>+</mo>
                      <mo data-mjx-texclass="CLOSE">)</mo>
                      <msub>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">k</mi>
                        </mrow>
                        <mrow data-mjx-texclass="ORD">
                          <mi>p</mi>
                          <mn>7</mn>
                        </mrow>
                      </msub>
                      <mfrac>
                        <msub>
                          <mrow data-mjx-texclass="ORD">
                            <mi mathvariant="normal">k</mi>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>i</mi>
                            <mn>7</mn>
                          </mrow>
                        </msub>
                        <mi>s</mi>
                      </mfrac>
                    </mrow>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">(</mo>
                      <mo>−</mo>
                      <mo data-mjx-texclass="CLOSE">)</mo>
                      <msub>
                        <mi>U</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>m</mi>
                          <mi>p</mi>
                          <mi>p</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>U</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>p</mi>
                          <mi>v</mi>
                        </mrow>
                      </msub>
                    </mrow>
                    <mo>+</mo>
                    <mo>−</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>p</mi>
                        <mi>v</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>U</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>d</mi>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <mrow>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">(</mo>
                      <mo>+</mo>
                      <mo data-mjx-texclass="CLOSE">)</mo>
                      <msub>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">k</mi>
                        </mrow>
                        <mrow data-mjx-texclass="ORD">
                          <mi>p</mi>
                          <mn>8</mn>
                        </mrow>
                      </msub>
                      <mfrac>
                        <msub>
                          <mrow data-mjx-texclass="ORD">
                            <mi mathvariant="normal">k</mi>
                          </mrow>
                          <mrow data-mjx-texclass="ORD">
                            <mi>i</mi>
                            <mn>8</mn>
                          </mrow>
                        </msub>
                        <mi>s</mi>
                      </mfrac>
                    </mrow>
                    <mrow data-mjx-texclass="INNER">
                      <mo data-mjx-texclass="OPEN">(</mo>
                      <mo>−</mo>
                      <mo data-mjx-texclass="CLOSE">)</mo>
                      <msub>
                        <mi>U</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>m</mi>
                          <mi>p</mi>
                          <mi>p</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>U</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>p</mi>
                          <mi>v</mi>
                        </mrow>
                      </msub>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>p</mi>
                        <mi>v</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </mfrac>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>U</italic><sub><italic>mppt</italic></sub><italic> </italic>is the maximum power tracking voltage of the photovoltaic unit; <italic>U</italic><sub><italic>pv</italic></sub> is the output voltage of the photovoltaic unit; <italic>M</italic><sub><italic>pv</italic></sub> is the control pulse of the photovoltaic unit. </p><p>The control equation of the photovoltaic grid-connected inverter is:</p>
          
            <disp-formula>
              <label>(24)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>p</mi>
                            <mi>v</mi>
                            <mi>q</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>9</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>9</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>q</mi>
                                  <mi>r</mi>
                                  <mi>e</mi>
                                  <mi>f</mi>
                                </mrow>
                              </msub>
                              <msub>
                                <mi>i</mi>
                                <mi>q</mi>
                              </msub>
                            </mrow>
                            <mo>+</mo>
                            <msub>
                              <mi>i</mi>
                              <mi>d</mi>
                            </msub>
                            <mi>ω</mi>
                            <mi>L</mi>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>p</mi>
                            <mi>v</mi>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mfrac>
                          <mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>10</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>10</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mi>i</mi>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>d</mi>
                                  <mi>r</mi>
                                  <mi>e</mi>
                                  <mi>f</mi>
                                </mrow>
                              </msub>
                              <msub>
                                <mi>i</mi>
                                <mi>d</mi>
                              </msub>
                            </mrow>
                            <mo>+</mo>
                            <mo>−</mo>
                            <msub>
                              <mi>U</mi>
                              <mi>d</mi>
                            </msub>
                            <msub>
                              <mi>i</mi>
                              <mi>q</mi>
                            </msub>
                            <mi>ω</mi>
                            <mi>L</mi>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula,<italic> i</italic><sub><italic>qref</italic></sub>, <italic>i</italic><sub><italic>q</italic></sub>,<italic> i</italic><sub><italic>derf</italic></sub><sub>, </sub><italic>i</italic><sub><italic>d</italic></sub> are the q-axis current reference value, q-axis current, d-axis voltage reference value, and d-axis current respectively; <italic>M</italic><sub><italic>pvq</italic></sub>, <italic>M</italic><sub><italic>pvd</italic></sub> are the trigger pulses of the q-axis and d-axis of the grid-connected inverter of photovoltaic units, respectively. The battery pack adopts a bidirectional DC/DC converter. When the converter is in Buck mode, the control equation is:</p>
          
            <disp-formula>
              <label>(25)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>M</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>b</mi>
                    <mi>a</mi>
                    <mi>t</mi>
                    <mi>b</mi>
                    <mi>u</mi>
                    <mi>c</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">[</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">]</mo>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">(</mo>
                    <mo>+</mo>
                    <mo data-mjx-texclass="CLOSE">)</mo>
                    <msub>
                      <mrow data-mjx-texclass="ORD">
                        <mi mathvariant="normal">k</mi>
                      </mrow>
                      <mrow data-mjx-texclass="ORD">
                        <mi>p</mi>
                        <mn>11</mn>
                      </mrow>
                    </msub>
                    <mfrac>
                      <msub>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">k</mi>
                        </mrow>
                        <mrow data-mjx-texclass="ORD">
                          <mi>i</mi>
                          <mn>11</mn>
                        </mrow>
                      </msub>
                      <mi>s</mi>
                    </mfrac>
                  </mrow>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">(</mo>
                    <mo>−</mo>
                    <mo data-mjx-texclass="CLOSE">)</mo>
                    <mfrac>
                      <msub>
                        <mi>P</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mtext>inref </mtext>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>i</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>b</mi>
                          <mi>a</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                    <msub>
                      <mi>U</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>b</mi>
                        <mi>a</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <msub>
                    <mi>K</mi>
                    <mn>2</mn>
                  </msub>
                  <msub>
                    <mi>i</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>b</mi>
                      <mi>a</mi>
                      <mi>t</mi>
                    </mrow>
                  </msub>
                </mrow>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>+</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <msub>
                    <mrow data-mjx-texclass="ORD">
                      <mi mathvariant="normal">k</mi>
                    </mrow>
                    <mrow data-mjx-texclass="ORD">
                      <mi>p</mi>
                      <mn>12</mn>
                    </mrow>
                  </msub>
                  <mfrac>
                    <msub>
                      <mrow data-mjx-texclass="ORD">
                        <mi mathvariant="normal">k</mi>
                      </mrow>
                      <mrow data-mjx-texclass="ORD">
                        <mi>i</mi>
                        <mn>12</mn>
                      </mrow>
                    </msub>
                    <mi>s</mi>
                  </mfrac>
                </mrow>
              </math>
            </disp-formula>
          
          <p>When the converter is in Boost, the control equation is:</p>
          
            <disp-formula>
              <label>(26)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>M</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mtext>batboost </mtext>
                  </mrow>
                </msub>
                <msub>
                  <mi>K</mi>
                  <mn>1</mn>
                </msub>
                <mo>=</mo>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">[</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">]</mo>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">(</mo>
                    <mo>+</mo>
                    <mo data-mjx-texclass="CLOSE">)</mo>
                    <msub>
                      <mrow data-mjx-texclass="ORD">
                        <mi mathvariant="normal">k</mi>
                      </mrow>
                      <mrow data-mjx-texclass="ORD">
                        <mi>p</mi>
                        <mn>13</mn>
                      </mrow>
                    </msub>
                    <mfrac>
                      <msub>
                        <mrow data-mjx-texclass="ORD">
                          <mi mathvariant="normal">k</mi>
                        </mrow>
                        <mrow data-mjx-texclass="ORD">
                          <mi>i</mi>
                          <mn>13</mn>
                        </mrow>
                      </msub>
                      <mi>s</mi>
                    </mfrac>
                  </mrow>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">(</mo>
                    <mo>−</mo>
                    <mo data-mjx-texclass="CLOSE">)</mo>
                    <mfrac>
                      <msub>
                        <mi>P</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mtext>outref </mtext>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>i</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>b</mi>
                          <mi>a</mi>
                          <mi>t</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                    <msub>
                      <mi>U</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>d</mi>
                        <mi>c</mi>
                        <mi>b</mi>
                        <mi>a</mi>
                        <mi>t</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <msub>
                    <mi>i</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>b</mi>
                      <mi>a</mi>
                      <mi>t</mi>
                    </mrow>
                  </msub>
                </mrow>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>+</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <msub>
                    <mrow data-mjx-texclass="ORD">
                      <mi mathvariant="normal">k</mi>
                    </mrow>
                    <mrow data-mjx-texclass="ORD">
                      <mi>p</mi>
                      <mn>14</mn>
                    </mrow>
                  </msub>
                  <mfrac>
                    <msub>
                      <mrow data-mjx-texclass="ORD">
                        <mi mathvariant="normal">k</mi>
                      </mrow>
                      <mrow data-mjx-texclass="ORD">
                        <mi>i</mi>
                        <mn>14</mn>
                      </mrow>
                    </msub>
                    <mi>s</mi>
                  </mfrac>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>P</italic><sub><italic>outref</italic></sub>, <italic>P</italic><sub><italic>inref</italic></sub> are the reference power of battery discharge state and charge state; <italic>U</italic><sub><italic>bat</italic></sub> is the battery terminal voltage; <italic>U</italic><sub><italic>dcbat</italic></sub><italic> </italic>is the DC link voltage of the battery; <italic>M</italic><sub><italic>batbuck</italic></sub> is the charging control pulse; <italic>M</italic><sub><italic>batboost</italic></sub> is the discharge control pulse. When the battery pack inverter is running in Buck mode, it is charging, and Boost is discharging [<xref ref-type="bibr" rid="ref_15">15</xref>]. </p><p>The control equation of the grid-connected inverter of the battery pack is:</p>
          
            <disp-formula>
              <label>(27)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">{</mo>
                  <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"/>
                  <mtable columnalign="left" columnspacing="1em" rowspacing="4pt">
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>b</mi>
                            <mi>a</mi>
                            <mi>t</mi>
                            <mi>q</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo>×</mo>
                        <mn>2</mn>
                        <mfrac>
                          <mrow>
                            <msub>
                              <mi>U</mi>
                              <mi>q</mi>
                            </msub>
                            <msub>
                              <mi>i</mi>
                              <mi>d</mi>
                            </msub>
                            <mo>−</mo>
                            <mo>+</mo>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mi>i</mi>
                                <mi>q</mi>
                              </msub>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>15</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>15</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mi>ω</mi>
                            <mi>L</mi>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                              <mi>b</mi>
                              <mi>a</mi>
                              <mi>t</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <msub>
                          <mi>M</mi>
                          <mrow data-mjx-texclass="ORD">
                            <mi>b</mi>
                            <mi>a</mi>
                            <mi>t</mi>
                            <mi>d</mi>
                          </mrow>
                        </msub>
                        <mo>=</mo>
                        <mo>×</mo>
                        <mn>2</mn>
                        <mfrac>
                          <mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">[</mo>
                              <mo>−</mo>
                              <mo data-mjx-texclass="CLOSE">]</mo>
                              <mrow data-mjx-texclass="INNER">
                                <mo data-mjx-texclass="OPEN">(</mo>
                                <mo>−</mo>
                                <mo data-mjx-texclass="CLOSE">)</mo>
                                <msub>
                                  <mi>U</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>d</mi>
                                    <mi>c</mi>
                                    <mi>b</mi>
                                    <mi>a</mi>
                                    <mi>t</mi>
                                    <mi>r</mi>
                                    <mi>e</mi>
                                    <mi>f</mi>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>U</mi>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>d</mi>
                                    <mi>c</mi>
                                    <mi>b</mi>
                                    <mi>a</mi>
                                    <mi>t</mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <mrow data-mjx-texclass="INNER">
                                <mo data-mjx-texclass="OPEN">(</mo>
                                <mo>+</mo>
                                <mo data-mjx-texclass="CLOSE">)</mo>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>p</mi>
                                    <mn>16</mn>
                                  </mrow>
                                </msub>
                                <mfrac>
                                  <msub>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi mathvariant="normal">k</mi>
                                    </mrow>
                                    <mrow data-mjx-texclass="ORD">
                                      <mi>i</mi>
                                      <mn>16</mn>
                                    </mrow>
                                  </msub>
                                  <mi>s</mi>
                                </mfrac>
                              </mrow>
                              <msub>
                                <mi>i</mi>
                                <mi>d</mi>
                              </msub>
                            </mrow>
                            <mrow data-mjx-texclass="INNER">
                              <mo data-mjx-texclass="OPEN">(</mo>
                              <mo>+</mo>
                              <mo data-mjx-texclass="CLOSE">)</mo>
                              <msub>
                                <mrow data-mjx-texclass="ORD">
                                  <mi mathvariant="normal">k</mi>
                                </mrow>
                                <mrow data-mjx-texclass="ORD">
                                  <mi>p</mi>
                                  <mn>17</mn>
                                </mrow>
                              </msub>
                              <mfrac>
                                <msub>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi mathvariant="normal">k</mi>
                                  </mrow>
                                  <mrow data-mjx-texclass="ORD">
                                    <mi>i</mi>
                                    <mn>17</mn>
                                  </mrow>
                                </msub>
                                <mi>s</mi>
                              </mfrac>
                            </mrow>
                            <mo>+</mo>
                            <mo>+</mo>
                            <msub>
                              <mi>U</mi>
                              <mi>d</mi>
                            </msub>
                            <msub>
                              <mi>i</mi>
                              <mi>q</mi>
                            </msub>
                            <mi>ω</mi>
                            <mi>L</mi>
                          </mrow>
                          <msub>
                            <mi>U</mi>
                            <mrow data-mjx-texclass="ORD">
                              <mi>d</mi>
                              <mi>c</mi>
                            </mrow>
                          </msub>
                        </mfrac>
                      </mtd>
                    </mtr>
                  </mtable>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>U</italic><sub><italic>q </italic></sub>and <italic>U</italic><sub><italic>d</italic></sub> are the q-axis and d-axis voltages; <italic>M</italic><sub><italic>batq</italic></sub>, <italic>M</italic><sub><italic>batd</italic></sub> are the control pulses of the q-axis and d-axis of the battery grid-side converter.</p><p>The control equation of the DC/DC converter of the electrolyzer is [<xref ref-type="bibr" rid="ref_14">14</xref>]:</p>
          
            <disp-formula>
              <label>(28)</label>
              <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                <msub>
                  <mi>M</mi>
                  <mrow data-mjx-texclass="ORD">
                    <mi>e</mi>
                    <mi>l</mi>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">[</mo>
                  <mo>−</mo>
                  <mo data-mjx-texclass="CLOSE">]</mo>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">(</mo>
                    <mo>+</mo>
                    <mo data-mjx-texclass="CLOSE">)</mo>
                    <msub>
                      <mi>k</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>p</mi>
                        <mn>18</mn>
                      </mrow>
                    </msub>
                    <mfrac>
                      <msub>
                        <mi>k</mi>
                        <mrow data-mjx-texclass="ORD">
                          <mi>i</mi>
                          <mn>18</mn>
                        </mrow>
                      </msub>
                      <mi>s</mi>
                    </mfrac>
                  </mrow>
                  <mrow data-mjx-texclass="INNER">
                    <mo data-mjx-texclass="OPEN">(</mo>
                    <mo>−</mo>
                    <mo data-mjx-texclass="CLOSE">)</mo>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mtext>elref </mtext>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>P</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>e</mi>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <msub>
                    <mi>i</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>e</mi>
                      <mi>l</mi>
                    </mrow>
                  </msub>
                </mrow>
                <mrow data-mjx-texclass="INNER">
                  <mo data-mjx-texclass="OPEN">(</mo>
                  <mo>+</mo>
                  <mo data-mjx-texclass="CLOSE">)</mo>
                  <msub>
                    <mi>k</mi>
                    <mrow data-mjx-texclass="ORD">
                      <mi>p</mi>
                      <mn>19</mn>
                    </mrow>
                  </msub>
                  <mfrac>
                    <msub>
                      <mi>k</mi>
                      <mrow data-mjx-texclass="ORD">
                        <mi>i</mi>
                        <mn>19</mn>
                      </mrow>
                    </msub>
                    <mi>s</mi>
                  </mfrac>
                </mrow>
              </math>
            </disp-formula>
          
          <p>In the above formula, <italic>M</italic><sub><italic>el</italic></sub> is the control pulse of the electrolytic cell converter; <italic>P</italic><sub><italic>elref </italic></sub>and <italic>P</italic><sub><italic>el</italic></sub> are the reference power and actual power of the electrolyzer respectively; <italic>i</italic><sub><italic>el</italic></sub><italic> </italic>is the actual value of the current of the electrolytic cell. The control strategy of the grid-connected inverter of the electrolyzer is the same as that of the grid-connected inverter of the battery, and will not be repeated here.</p>
        </sec>
      
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>4. Simulation study</title>
      <p>Build the wind power/photovoltaic/hydrogen production/battery grid-connected power generation system as shown in PSCAD/EMTDC to simulate the weather conditions at dawn, the wind speed is 8m/s in the first 4s, 12m/s in 4s, 8.7m/s in 7s, and 10m/s in 10s and maintained for 15s; In the first 10s, the light intensity was 0W/m<sup>2</sup>, and the temperature was 28℃, In 10s, the light intensity was changed to 1200W/m<sup>2</sup> and kept until 15s, and the temperature remained unchanged. The simulation time is 15s. System parameters see <xref ref-type="table" rid="table_1">Table 1</xref>. Simulation control parameters see <xref ref-type="table" rid="table_2">Table 2</xref> [<xref ref-type="bibr" rid="ref_16">16</xref>], [<xref ref-type="bibr" rid="ref_17">17</xref>], [<xref ref-type="bibr" rid="ref_18">18</xref>], [<xref ref-type="bibr" rid="ref_19">19</xref>], [<xref ref-type="bibr" rid="ref_20">20</xref>].</p><p>According to the scenario set in this paper, the operation of the wind turbine is shown in the <xref ref-type="fig" rid="fig_3">Figure 3</xref>.</p><p>The per-unit value of the fan speed remains 0.48, 1, and 0.63 in the four-stage wind speed change, and the per-unit value of the mechanical torque is 0.6, 1, and 0.8, respectively. The electromagnetic torque follows the mechanical torque fluctuation. The actual output power of the wind turbine is 300kW, 900kW, 400kW, 600kW, the actual output power is similar to the reference power, and the error is within a reasonable range. In this paper, 1MW direct driven fan is selected, which can not only effectively use wind energy but also operate at full load.</p><p>The operation of the wind turbine generator side is shown in the <xref ref-type="fig" rid="fig_4">Figure 4</xref>.</p><p>Due to the control strategy in this paper, the d-axis reference current is set to 0. It can be seen from the figure that the d-axis current is basically consistent with the d-axis reference current, and the error is within a reasonable range. The q-axis current fluctuates reasonably with the q-axis reference current when the wind speed changes stepwise.</p>
      <p>The operation of the wind turbine grid-side converter is shown in the <xref ref-type="fig" rid="fig_5">Figure 5</xref>.</p><p>The q-axis current and d-axis current of the grid-side converter fluctuate closely with their reference values, and the fluctuation range is less than 0.01kA, which can verify that the control parameters are reasonable. The grid-side DC link is always maintained at around 0.9kV, which is consistent with the reference value of the DC link, which can verify that the grid-side converter is normally turned on. </p>
      
        <table-wrap id="table_1">
          <label>Table 1</label>
          <caption>Simulation system device parameters</caption>
          <abstract/>
          <table><tbody><tr><td colspan="1" rowspan="1" colwidth="236"><p>Device name</p></td><td colspan="1" rowspan="1"><p>Parameter name</p></td><td colspan="1" rowspan="1"><p>Numerical value</p></td></tr><tr><td colspan="1" rowspan="9" colwidth="236"><p>PMSG</p></td><td colspan="1" rowspan="1"><p>Rated capacity/kW</p></td><td colspan="1" rowspan="1"><p>1000</p></td></tr><tr><td colspan="1" rowspan="1"><p>Rated wind speed/(m/s)</p></td><td colspan="1" rowspan="1"><p>12</p></td></tr><tr><td colspan="1" rowspan="1"><p>Rated frequency/Hz</p></td><td colspan="1" rowspan="1"><p>50</p></td></tr><tr><td colspan="1" rowspan="1"><p>Air density/(kg/m<sup>3</sup>)</p></td><td colspan="1" rowspan="1"><p>1.22</p></td></tr><tr><td colspan="1" rowspan="1"><p>Wind turbine radius/m</p></td><td colspan="1" rowspan="1"><p>7.2</p></td></tr><tr><td colspan="1" rowspan="1"><p>Number of pole pairs n<sub>p</sub></p></td><td colspan="1" rowspan="1"><p>30</p></td></tr><tr><td colspan="1" rowspan="1"><p>Moment of inertia 2H/s</p></td><td colspan="1" rowspan="1"><p>0.02</p></td></tr><tr><td colspan="1" rowspan="1"><p>Viscosity coefficient B(pu)</p></td><td colspan="1" rowspan="1"><p>0.0001</p></td></tr><tr><td colspan="1" rowspan="1"><p>Magnetic field strength(pu)</p></td><td colspan="1" rowspan="1"><p>1.0</p></td></tr><tr><td colspan="1" rowspan="10" colwidth="236"><p>PV array</p></td><td colspan="1" rowspan="1"><p>The number of components in series N<sub>s</sub></p></td><td colspan="1" rowspan="1"><p>22</p></td></tr><tr><td colspan="1" rowspan="1"><p>Number of components in parallel N<sub>p</sub></p></td><td colspan="1" rowspan="1"><p>250</p></td></tr><tr><td colspan="1" rowspan="1"><p>Current temperature coefficient of variation α/(A/℃)</p></td><td colspan="1" rowspan="1"><p>0.001</p></td></tr><tr><td colspan="1" rowspan="1"><p>Reference light intensity G<sub>ref</sub>/(W/m<sup>2</sup>)</p></td><td colspan="1" rowspan="1"><p>1000</p></td></tr><tr><td colspan="1" rowspan="1"><p>Reference temperature T<sub>ref</sub>/℃</p></td><td colspan="1" rowspan="1"><p>25</p></td></tr><tr><td colspan="1" rowspan="1"><p>Open circuit voltage U<sub>oc</sub>/V</p></td><td colspan="1" rowspan="1"><p>45</p></td></tr><tr><td colspan="1" rowspan="1"><p>Short circuit current I<sub>pvsc</sub>/A</p></td><td colspan="1" rowspan="1"><p>5.5</p></td></tr><tr><td colspan="1" rowspan="1"><p>Maximum power point voltage U<sub>mp</sub>/V</p></td><td colspan="1" rowspan="1"><p>36</p></td></tr><tr><td colspan="1" rowspan="1"><p>Maximum power point current I<sub>mp</sub>/A</p></td><td colspan="1" rowspan="1"><p>5</p></td></tr><tr><td colspan="1" rowspan="1"><p>Voltage Temperature Variation Coefficient β/(V/℃)</p></td><td colspan="1" rowspan="1"><p>0.000 5</p></td></tr><tr><td colspan="1" rowspan="7" colwidth="236"><p>Battery pack</p></td><td colspan="1" rowspan="1"><p>Standard/kV</p></td><td colspan="1" rowspan="1"><p>0.6</p></td></tr><tr><td colspan="1" rowspan="1"><p>Rated capacity/(kA h)</p></td><td colspan="1" rowspan="1"><p>100</p></td></tr><tr><td colspan="1" rowspan="1"><p>Capacity loss per hour at nominal current (%)</p></td><td colspan="1" rowspan="1"><p>35</p></td></tr><tr><td colspan="1" rowspan="1"><p>initial state of charge Initial SOC (%)</p></td><td colspan="1" rowspan="1"><p>50</p></td></tr><tr><td colspan="1" rowspan="1"><p>Number of batteries in series</p></td><td colspan="1" rowspan="1"><p>50</p></td></tr><tr><td colspan="1" rowspan="1"><p>Terminal voltage <italic>U</italic><sub>max</sub>/kV</p></td><td colspan="1" rowspan="1"><p>0.62</p></td></tr><tr><td colspan="1" rowspan="1"><p>Terminal voltage lower limit <italic>U</italic><sub>min</sub>/kV</p></td><td colspan="1" rowspan="1"><p>0.58</p></td></tr><tr><td colspan="1" rowspan="9" colwidth="236"><p>PEMEL</p></td><td colspan="1" rowspan="1"><p>Rated power <italic>P</italic><sub>eleN</sub>/kW</p></td><td colspan="1" rowspan="1"><p>200</p></td></tr><tr><td colspan="1" rowspan="1"><p>Rated current <italic>I</italic><sub>nom</sub>/kA</p></td><td colspan="1" rowspan="1"><p>1.5</p></td></tr><tr><td colspan="1" rowspan="1"><p>Serial number <italic>N</italic><sub>el</sub></p></td><td colspan="1" rowspan="1"><p>100</p></td></tr><tr><td colspan="1" rowspan="1"><p>Electrolyzer <italic>T</italic><sub>el</sub>/K</p></td><td colspan="1" rowspan="1"><p>335</p></td></tr><tr><td colspan="1" rowspan="1"><p>Hydrogen pressure <italic>P</italic>H<sub>2</sub>/atm</p></td><td colspan="1" rowspan="1"><p>3</p></td></tr><tr><td colspan="1" rowspan="1"><p>Oxygen pressure <italic>P</italic>O<sub>2</sub>/atm</p></td><td colspan="1" rowspan="1"><p>3</p></td></tr><tr><td colspan="1" rowspan="1"><p>Current density <italic>i</italic>(A/cm<sup>2</sup>)</p></td><td colspan="1" rowspan="1"><p>0.78</p></td></tr><tr><td colspan="1" rowspan="1"><p>Transfer coefficient α</p></td><td colspan="1" rowspan="1"><p>0.0008</p></td></tr><tr><td colspan="1" rowspan="1"><p>AC current density <italic>i<sub>0</sub></italic>(A/cm<sup>2</sup>)</p></td><td colspan="1" rowspan="1"><p>0.4</p></td></tr><tr><td colspan="1" rowspan="5" colwidth="236"><p>Hydrogen storage tank</p></td><td colspan="1" rowspan="1"><p>Hydrogen storage at time<italic>t</italic><sub>0 </sub>/mol</p></td><td colspan="1" rowspan="1"><p>90000</p></td></tr><tr><td colspan="1" rowspan="1"><p>Hydrogen storage tank volume <italic>V</italic><sub>S</sub>/m<sup>3</sup></p></td><td colspan="1" rowspan="1"><p>12</p></td></tr><tr><td colspan="1" rowspan="1"><p>Hydrogen storage tank temperature <italic>T</italic><sub>S</sub>/K</p></td><td colspan="1" rowspan="1"><p>301.15</p></td></tr><tr><td colspan="1" rowspan="1"><p>Upper pressure limit <italic>P</italic><sub>max</sub>/Mpa</p></td><td colspan="1" rowspan="1"><p>2.52</p></td></tr><tr><td colspan="1" rowspan="1"><p>Lower pressure limit <italic>P</italic><sub>min</sub>/Mpa</p></td><td colspan="1" rowspan="1"><p>2.48</p></td></tr></tbody></table>
        </table-wrap>
      
      
        <table-wrap id="table_2">
          <label>Table 2</label>
          <caption>Simulation control parameters</caption>
          <abstract/>
          <table><tbody><tr><td colspan="1" rowspan="1"><p>Control parameter</p></td><td colspan="1" rowspan="1"><p>Numerical value</p></td><td colspan="1" rowspan="1"><p>Control parameter</p></td><td colspan="1" rowspan="1"><p>Numerical value</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG q-axis current control proportional coefficient<italic></italic>k<sub>p1</sub></p></td><td colspan="1" rowspan="1"><p>10</p></td><td colspan="1" rowspan="1"><p>Battery pack discharge current control integral coefficient k<sub>p12</sub></p></td><td colspan="1" rowspan="1"><p>0.01</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG q-axis current integral coefficient control k<sub>i1</sub></p></td><td colspan="1" rowspan="1"><p>0.02</p></td><td colspan="1" rowspan="1"><p>Battery pack adjustment factor K1</p></td><td colspan="1" rowspan="1"><p>0.08</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG active power control k<sub>p2</sub></p></td><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>Battery pack charging current control proportional coefficient k<sub>p13</sub></p></td><td colspan="1" rowspan="1"><p>5</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG active power control k<sub>i2</sub></p></td><td colspan="1" rowspan="1"><p>0.01</p></td><td colspan="1" rowspan="1"><p>Battery pack charging current control integral coefficient k<sub>i13</sub></p></td><td colspan="1" rowspan="1"><p>2</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG d-axis current control proportional coefficient k<sub>p3</sub></p></td><td colspan="1" rowspan="1"><p>4</p></td><td colspan="1" rowspan="1"><p>Battery pack adjustment factor K2</p></td><td colspan="1" rowspan="1"><p>0.01</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG d-axis current control integral coefficient<italic></italic>k<sub>i3</sub></p></td><td colspan="1" rowspan="1"><p>0.04</p></td><td colspan="1" rowspan="1"><p>Battery voltage control proportional coefficient k<sub>p14</sub></p></td><td colspan="1" rowspan="1"><p>8</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG grid side q-axis current control proportional coefficient k<sub>p4</sub></p></td><td colspan="1" rowspan="1"><p>1.5</p></td><td colspan="1" rowspan="1"><p>Battery voltage control integral coefficient k<sub>i14</sub></p></td><td colspan="1" rowspan="1"><p>0.02</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG grid side q-axis current control integral coefficient k<sub>i4</sub></p></td><td colspan="1" rowspan="1"><p>0.01</p></td><td colspan="1" rowspan="1"><p>Battery pack DC voltage control proportional coefficient k<sub>p15</sub></p></td><td colspan="1" rowspan="1"><p>4</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG grid side d-axis current control proportional coefficient k<sub>p5</sub></p></td><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>Battery pack DC voltage control integral coefficient k<sub>i15</sub></p></td><td colspan="1" rowspan="1"><p>0.025</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG grid side d-axis current control integral coefficient k<sub>i5</sub></p></td><td colspan="1" rowspan="1"><p>0.01</p></td><td colspan="1" rowspan="1"><p>d-axis current control proportional coefficient k<sub>p16 </sub>on the battery grid side</p></td><td colspan="1" rowspan="1"><p>10</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG DC voltage control proportional coefficient k<sub>p6</sub></p></td><td colspan="1" rowspan="1"><p>5</p></td><td colspan="1" rowspan="1"><p>Integral coefficient k<sub>i16 </sub>for d-axis current control on battery grid side</p></td><td colspan="1" rowspan="1"><p>0.08</p></td></tr><tr><td colspan="1" rowspan="1"><p>PMSG DC voltage control integral coefficient k<sub>i6</sub></p></td><td colspan="1" rowspan="1"><p>0.05</p></td><td colspan="1" rowspan="1"><p>q-axis current control proportional coefficient k<sub>p17</sub>on battery grid side</p></td><td colspan="1" rowspan="1"><p>7</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic DC voltage control proportional coefficient k<sub>p7</sub></p></td><td colspan="1" rowspan="1"><p>0.5</p></td><td colspan="1" rowspan="1"><p>Integral coefficient k<sub>i17 </sub>for q-axis current control on battery grid side</p></td><td colspan="1" rowspan="1"><p>0.05</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic DC voltage control integral coefficient k<sub>i7</sub></p></td><td colspan="1" rowspan="1"><p>0.2</p></td><td colspan="1" rowspan="1"><p>Electrolyzer active power control proportional coefficient k<sub>p18</sub></p></td><td colspan="1" rowspan="1"><p>200</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic d-axis current control proportional coefficient k<sub>p8</sub></p></td><td colspan="1" rowspan="1"><p>0.15</p></td><td colspan="1" rowspan="1"><p>Electrolyzer active power control integral coefficient k<sub>i18</sub></p></td><td colspan="1" rowspan="1"><p>0.01</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic d-axis current control integral coefficient k<sub>i8</sub></p></td><td colspan="1" rowspan="1"><p>0.08</p></td><td colspan="1" rowspan="1"><p>Electrolyzer current control proportional coefficient k<sub>p19</sub></p></td><td colspan="1" rowspan="1"><p>0.1</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic q-axis current control proportional coefficient k<sub>p9</sub></p></td><td colspan="1" rowspan="1"><p>0.15</p></td><td colspan="1" rowspan="1"><p>Electrolyzer current control integral coefficient k<sub>i19</sub></p></td><td colspan="1" rowspan="1"><p>0.005</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic q-axis current control integral coefficient k<sub>i9</sub></p></td><td colspan="1" rowspan="1"><p>0.08</p></td><td colspan="1" rowspan="1"><p>Electrolyzer DC voltage control proportional coefficient k<sub>p20</sub></p></td><td colspan="1" rowspan="1"><p>4</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic reactive power control proportional coefficient k<sub>p10</sub></p></td><td colspan="1" rowspan="1"><p>0.3</p></td><td colspan="1" rowspan="1"><p>Electrolyzer DC voltage control integral coefficient k<sub>i20</sub></p></td><td colspan="1" rowspan="1"><p>0.21</p></td></tr><tr><td colspan="1" rowspan="1"><p>Photovoltaic reactive power control integral coefficient k<sub>i10</sub></p></td><td colspan="1" rowspan="1"><p>0.02</p></td><td colspan="1" rowspan="1"><p>d-axis current control proportional coefficient k<sub>p21</sub>on the grid side of the electrolyzer</p></td><td colspan="1" rowspan="1"><p>25</p></td></tr><tr><td colspan="1" rowspan="1"><p>Battery pack DC voltage control proportional coefficient k<sub>p11</sub></p></td><td colspan="1" rowspan="1"><p>6</p></td><td colspan="1" rowspan="1"><p>Integral coefficient k<sub>i21 </sub>for d-axis current control on the grid side of the electrolyzer</p></td><td colspan="1" rowspan="1"><p>0.55</p></td></tr><tr><td colspan="1" rowspan="1"><p>Battery pack DC voltage control integral coefficient k<sub>i11</sub></p></td><td colspan="1" rowspan="1"><p>0.03</p></td><td colspan="1" rowspan="1"><p>q-axis current control proportional coefficient k<sub>p22</sub>on the grid side of the electrolyzer</p></td><td colspan="1" rowspan="1"><p>10</p></td></tr><tr><td colspan="1" rowspan="1"><p>Battery pack discharge current control proportional coefficient k<sub>i12</sub></p></td><td colspan="1" rowspan="1"><p>1.5</p></td><td colspan="1" rowspan="1"><p>Integral system of q-axis current control on the grid side of the electrolyzer k<sub>i22</sub></p></td><td colspan="1" rowspan="1"><p>0.48</p></td></tr></tbody></table>
        </table-wrap>
      
      <p>The output of photovoltaic power generation unit is shown in the <xref ref-type="fig" rid="fig_6">Figure 6</xref>. </p><p>The temperature is set at 28℃ unchanged, the light intensity is 0W/m<sup>2</sup> for the first 10s, and the light intensity becomes 1200W/m<sup>2</sup> in 10s. The power of the photovoltaic power generation unit is 0 for the first ten seconds. At ten seconds, due to the change of the light intensity, the power of the photovoltaic power generation unit becomes 0.3MW.</p><p><br></p>
      
        <fig id="fig_3">
          <label>Figure 3</label>
          <caption>Wind power unit operation</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_wVxmmZ3ahTo9s944.png"/>
        </fig>
      
      
        <fig id="fig_4">
          <label>Figure 4</label>
          <caption>Operation of wind turbine side converter</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_rya4XI60jeoRa6v3.png"/>
        </fig>
      
      
        <fig id="fig_5">
          <label>Figure 5</label>
          <caption>Operation of wind turbine grid side converter</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_h2AE2y5RTaJdrTno.png"/>
        </fig>
      
      
        <fig id="fig_6">
          <label>Figure 6</label>
          <caption>Illumination change and photovoltaic power generation unit power output</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_T5FKaymWEj9wlhKs.png"/>
        </fig>
      
      
        <fig id="fig_7">
          <label>Figure 7</label>
          <caption>Photovoltaic characteristic curve</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_eU9K8p-sEPdy35Tz.png"/>
        </fig>
      
      
        <fig id="fig_8">
          <label>Figure 8</label>
          <caption>Operation of the inverter of the photovoltaic power generation unit</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_b-b6JRPeZxflkrpf.png"/>
        </fig>
      
      <p><xref ref-type="fig" rid="fig_7">Figure 7</xref> presents the photovoltaic characteristic curves of the photovoltaic cells used in this paper. In this paper, the maximum power point tracking control method is adopted to ensure that photovoltaic cells are always close to the maximum power. The maximum power point is marked in the figure.</p><p>The operation of the photovoltaic converter is shown in the <xref ref-type="fig" rid="fig_8">Figure 8</xref>.</p><p>In the first 10s, since the output power of the photovoltaic power generation unit is 0, the d-axis current and q-axis current of the inverter are both 0, and the inverter is turned off. At 10s, the photovoltaic power generation unit emits power, the reference current of the d-axis of the inverter is -0.4kA, the reference value of the q-axis current is 0.4kA, and the actual values of the d-axis and q-axis current fluctuate around the reference value, which can prove that the photovoltaic power generation unit is replaced. The flow device is turned on and off normally, and the control parameters and control strategies are reasonable and effective.</p><p>The output of the battery pack is shown in the <xref ref-type="fig" rid="fig_9">Figure 9</xref>.</p><p>For the first 4s, the battery pack is in a discharge state, and the output power is 200kW to supplement the load demand. Since the battery pack is already running at rated power, the lack of power is supplemented by the grid. During 4-7s, the battery is working in the charging state, consuming 100kW of surplus wind power, and the rest of the wind power is consumed by the electrolyzer. During 7-10s, the battery is in discharge state, and the power shortage is 200kW. </p>
      
        <fig id="fig_9">
          <label>Figure 9</label>
          <caption>Operation of the battery pack</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_Y2FARHYzJeFDN-Ly.png"/>
        </fig>
      
      
        <fig id="fig_10">
          <label>Figure 10</label>
          <caption>Operation of the battery pack converter</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_qFMgb4rhXVV1pqCT.png"/>
        </fig>
      
      <p>The operation of the battery pack converter is shown in the <xref ref-type="fig" rid="fig_10">Figure 10</xref>. The switching of different states of the battery pack is determined by whether its rated power is greater than the difference between wind power, photovoltaic and grid side loads. For details, see the energy management strategy section above.</p><p>The d-axis and q-axis currents of the battery converter are both maintained at around 0kA, which is consistent with the reference value, and the fluctuation level is small. Between 1.1kV and 0.9kV, it can be verified that the battery converter operates normally.</p><p>The operation of the electrolyzer and hydrogen storage tank is shown in the <xref ref-type="fig" rid="fig_11">Figure 11</xref>.</p>
      
        <fig id="fig_11">
          <label>Figure 11</label>
          <caption>Operation of electrolyzer and hydrogen storage tank</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_vMDx73-OuG5C3vZ_.png"/>
        </fig>
      
      <p>The 0-4s and 7-10s systems have no surplus power, and the electrolyzer does not produce hydrogen. The 4-7s and 10-15s electrolyzers consume 200kW of surplus power and produce 1.4mol/s of hydrogen. The initial pressure of the hydrogen storage tank is about 2.49483Mpa, and hydrogen is added at 4s-7s and 10-15s, and the pressure of the hydrogen storage tank remains unchanged for the rest of the time. The action of the electrolyzer and the hydrogen storage tank is consistent, which can verify the normal operation of the control of the hydrogen production and hydrogen storage systems.</p><p>The operation of the electrolytic cell converter is shown in the <xref ref-type="fig" rid="fig_12">Figure 12</xref>.</p>
      <p>The electrolytic cell was opened and operated at 4-7s and 10-15s. During the operation, the d-axis current and the q-axis current followed the reference value, and the inverter control was operating normally. </p><p>The power coordination control of the system is shown in <xref ref-type="fig" rid="fig_13">Figure 13</xref>.</p>
      
        <fig id="fig_12">
          <label>Figure 12</label>
          <caption>Operation of the electrolytic cell converter</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_wvllOBA1rYCdlGZ8.png"/>
        </fig>
      
      
        <fig id="fig_13">
          <label>Figure 13</label>
          <caption>Coordinated operation of system power</caption>
          <abstract/>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://media.acadlore.com/assets/media/2022/10/img_kmj3IfsQnaUw-pxI.png"/>
        </fig>
      
      <p>In the first 4s of the system, the output power of the wind turbine is 300kW, the photovoltaic has no output, and the rated power of the battery is 200kW, and the insufficient part is supplemented by the grid. The 4-7s wind turbine runs at the rated wind speed, the output power is 900kW, the battery consumes 100kW of surplus wind power, the electrolyzer consumes 200Kw of surplus wind power, and the photovoltaic has no output. The output power of the 7-10s wind turbine is 400kW, the battery supplements the shortfall power of 200kW, the photovoltaic has no output, and the electrolyzer does not operate. The output power of the 10-15s wind turbine is 600kW, which has met the load demand of the grid. The photovoltaic power generation is 300kW, and the electrolyzer consumes the surplus photovoltaic power generation of 200kW, and the battery consumes the surplus photovoltaic power generation of 100kW. It can be seen from <xref ref-type="fig" rid="fig_13">Figure 13</xref> that the energy conversion efficiency of the system established in this paper is high. Wind energy and solar energy can be better converted into electric energy, with less wind and light discarded. It can be fully consumed when wind energy and solar energy are abundant, and can be supplemented by the battery pack when wind power and photoelectric power are few.</p>
    </sec>
    <sec disp-level="level1" sec-type="">
      <title>5. Conclusion</title>
      <p>In this paper, the mathematical model of the power generation system of wind power/photovoltaic/ hydrogen production/battery with common AC bus is constructed, and the energy coordination control strategy and the control strategy of each part of the converter are designed. Finally, the model is built in PSCAD/EMTDC, and the proposed simulation is verified. Based on the above theory and simulation results, the following conclusions can be drawn:</p><p>(1) The model constructed in this paper is reasonable and available. When the wind and photovoltaic power generation is surplus, the battery and electrolyzer run in time to absorb excess wind power and photovoltaic power generation, smooth the fluctuation of wind power generation and photovoltaic power generation, and verify the effectiveness and feasibility of the control strategy.</p><p>(2) Compared with the existing research, the research in this paper does not use a single wind power generation or photovoltaic power generation combined with energy storage to produce hydrogen, but uses wind and photovoltaic complementary power generation to produce hydrogen, which makes the advantages of the two energy sources complementary and better to ensure the stability of new energy power generation.</p><p>(3) In the follow-up research of this paper, fuel cells can be added, which can realize the power generation and utilization of hydrogen energy, and enhance the toughness of the system in the case of a large shortage of wind energy and light energy. Super capacitors can also be added to enhance the short-term power control capability of the system and improve the system robustness.</p>
    </sec>
  </body>
  <back>
    <ack>
      <title>Acknowledgments</title>
      
    </ack>
    <app-group>
      <app>
        <title>Appendix</title>
        
      </app>
    </app-group>
    <notes>
      <title>Author Contributions</title>
      
    </notes>
    <notes>
      <title>Funding</title>
      <p>This paper was supported by Autonomous Region's major science and technology project (Grant No.: 2021ZD0027). “Key technologies for efficient integration and flexible control of high-power wind hydrogen storage systems”.</p>
    </notes>
    <notes>
      <title>Informed Consent Statement</title>
      
    </notes>
    <notes>
      <title>Data Availability Statement</title>
      <p>The data used to support the findings of this study are available from the corresponding author upon request.</p>
    </notes>
    <notes notes-type="COI-statement">
      <title>Conflicts of Interest</title>
      <p>The authors declare that they have no conflicts of interest.</p>
    </notes>
    <ref-list>
      <title>References</title>
      <ref id="ref_1">
        <label>1.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>J.</given-names>
              <surname>Wang</surname>
            </name>
            <name>
              <given-names>H.</given-names>
              <surname>Li</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Peng</surname>
            </name>
          </person-group>
          <article-title>Application models of renewable energy under the carbon neutrality target</article-title>
          <source>Mod. Ch.</source>
          <year>2022</year>
          <volume>42</volume>
          <issue>5</issue>
          <page-range>6-6</page-range>
          <fpage>6</fpage>
          <lpage>6</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_2">
        <label>2.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Y. Z.</given-names>
              <surname>Wang</surname>
            </name>
            <name>
              <given-names>L.</given-names>
              <surname>Kang</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Zhang</surname>
            </name>
          </person-group>
          <article-title>Development history, typical form and future trend of integrated energy system</article-title>
          <source>Act. Energiae Solaris Sinica</source>
          <year>2021</year>
          <volume>42</volume>
          <issue>8</issue>
          <page-range>84-95</page-range>
          <fpage>84</fpage>
          <lpage>95</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_3">
        <label>3.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>F.</given-names>
              <surname>Cao</surname>
            </name>
            <name>
              <given-names>T.</given-names>
              <surname>Guo</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Yin</surname>
            </name>
          </person-group>
          <article-title>Research progress on design and energy management strategies of wind-solar-hydrogen hybrid power generation systems</article-title>
          <source>Distrib. Energy</source>
          <year>2021</year>
          <volume>6</volume>
          <issue>4</issue>
          <page-range>1-14</page-range>
          <fpage>1</fpage>
          <lpage>14</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_4">
        <label>4.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>G.</given-names>
              <surname>Cai</surname>
            </name>
            <name>
              <given-names>C.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>L.</given-names>
              <surname>Kong</surname>
            </name>
          </person-group>
          <article-title>Modeling and control of wind power/photovoltaic/hydrogen production/supercapacitor grid-connected system</article-title>
          <source>Pow. Sys. Technol.</source>
          <year>2016</year>
          <volume>40</volume>
          <issue>0</issue>
          <page-range>2982-2990</page-range>
          <fpage>2982</fpage>
          <lpage>2990</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_5">
        <label>5.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>H.</given-names>
              <surname>Kinoshita</surname>
            </name>
            <name>
              <given-names>R.</given-names>
              <surname>Takahashi</surname>
            </name>
            <name>
              <given-names>T.</given-names>
              <surname>Murata</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Tamura</surname>
            </name>
            <name>
              <given-names>M.</given-names>
              <surname>Sugimasa</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Komura</surname>
            </name>
            <name>
              <given-names>K.</given-names>
              <surname>Ide</surname>
            </name>
          </person-group>
          <article-title>A study of hydrogen generation with doubly-fed adjustable speed wind generator</article-title>
          <source>Electr. Eng. Jpn.</source>
          <year>2011</year>
          <volume>175</volume>
          <issue>3</issue>
          <page-range>27-36</page-range>
          <fpage>27</fpage>
          <lpage>36</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1002/eej.21003</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_6">
        <label>6.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>A.</given-names>
              <surname>Abdelkafi and L</surname>
            </name>
          </person-group>
          <article-title>Energy management optimization of a hybrid power production unit based renewable energies</article-title>
          <source>Int. J. Elec. Power. Energy Syst.</source>
          <year>2014</year>
          <volume>62</volume>
          <issue/>
          <page-range>1-9</page-range>
          <fpage>1</fpage>
          <lpage>9</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.ijepes.2014.04.012</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_7">
        <label>7.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Y.</given-names>
              <surname>Lu</surname>
            </name>
            <name>
              <given-names>C.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>L.</given-names>
              <surname>Liang</surname>
            </name>
          </person-group>
          <article-title>Modeling and control of wind-hydrogen coupled system based on electric-hydrogen hybrid energy storage</article-title>
          <source>Mag. Introduct.</source>
          <year>2020</year>
          <volume>48</volume>
          <issue>3</issue>
          <page-range>8-8</page-range>
          <fpage>8</fpage>
          <lpage>8</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_8">
        <label>8.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>H.</given-names>
              <surname>Zhang</surname>
            </name>
            <name>
              <given-names>Q.</given-names>
              <surname>Sun</surname>
            </name>
            <name>
              <given-names>Z.</given-names>
              <surname>Li</surname>
            </name>
          </person-group>
          <article-title>Research on cooperative control power generation strategy of wind-hydrogen coupling system</article-title>
          <source>J. Northeast Dian li Univ.</source>
          <year>2018</year>
          <volume>38</volume>
          <issue>3</issue>
          <page-range>15-23</page-range>
          <fpage>15</fpage>
          <lpage>23</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_9">
        <label>9.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>R.</given-names>
              <surname>Maamouri</surname>
            </name>
            <name>
              <given-names>D.</given-names>
              <surname>Guilbert</surname>
            </name>
            <name>
              <given-names>M.</given-names>
              <surname>Zasadzinski</surname>
            </name>
            <name>
              <given-names>H.</given-names>
              <surname>Rafaralahy</surname>
            </name>
          </person-group>
          <article-title>Proton exchange membrane water electrolysis: Modeling for hydrogen flow rate control</article-title>
          <source>Int. J. Hydrogen. Energ.</source>
          <year>2021</year>
          <volume>46</volume>
          <issue>1</issue>
          <page-range>7676-7700</page-range>
          <fpage>7676</fpage>
          <lpage>7700</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.ijhydene.2020.11.276</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_10">
        <label>10.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>H.</given-names>
              <surname>Deng</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Teng</surname>
            </name>
          </person-group>
          <article-title>Research on energy management strategy of wind-hydrogen coupling system</article-title>
          <source>Act. Energiae Solaris Sinica</source>
          <year>2021</year>
          <volume>42</volume>
          <issue>1</issue>
          <page-range>256-263</page-range>
          <fpage>256</fpage>
          <lpage>263</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_11">
        <label>11.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>H.</given-names>
              <surname>Sun</surname>
            </name>
            <name>
              <given-names>Z.</given-names>
              <surname>Li</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Chen</surname>
            </name>
          </person-group>
          <article-title>Status quo and development trend of wind power hydrogen production technology</article-title>
          <source>T. China Electrotechnical Soc.</source>
          <year>2019</year>
          <volume>34</volume>
          <issue>9</issue>
          <page-range>4071-4083</page-range>
          <fpage>4071</fpage>
          <lpage>4083</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_12">
        <label>12.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>H.</given-names>
              <surname>Deng</surname>
            </name>
            <name>
              <given-names>J.</given-names>
              <surname>Chen</surname>
            </name>
            <name>
              <given-names>D.</given-names>
              <surname>Jiao</surname>
            </name>
          </person-group>
          <article-title>Energy management control strategy of wind-hydrogen coupled grid-connected system</article-title>
          <source>High Voltage Eng.</source>
          <year>2020</year>
          <volume>8</volume>
          <issue>1</issue>
          <page-range>99-106</page-range>
          <fpage>99</fpage>
          <lpage>106</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_13">
        <label>13.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>J.</given-names>
              <surname>Wang</surname>
            </name>
            <name>
              <given-names>H.</given-names>
              <surname>Li</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Peng</surname>
            </name>
          </person-group>
          <article-title>PEMFC modeling and performance analysis control</article-title>
          <source>Elect. Meas. Technol.</source>
          <year>2022</year>
          <volume>45</volume>
          <issue>8</issue>
          <page-range>8-8</page-range>
          <fpage>8</fpage>
          <lpage>8</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_14">
        <label>14.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>X.</given-names>
              <surname>Guo</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Wei</surname>
            </name>
            <name>
              <given-names>Y.</given-names>
              <surname>Wan</surname>
            </name>
          </person-group>
          <article-title>Overview of new energy hydrogen production power electronic converters</article-title>
          <source>Automat. Electr. P. Sys.</source>
          <year>2021</year>
          <volume>45</volume>
          <issue>0</issue>
          <page-range>15-15</page-range>
          <fpage>15</fpage>
          <lpage>15</lpage>
          <pub-id pub-id-type="doi"/>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_15">
        <label>15.</label>
        <element-citation publication-type="thesis">
          <person-group person-group-type="author">
            <name>
              <given-names>L.</given-names>
              <surname>Kong</surname>
            </name>
          </person-group>
          <article-title>Research on optimal configuration and coordinated control strategy of wind-solar-hydrogen integrated energy system</article-title>
          <source>Academic Dissertation</source>
          <year>2017</year>
          <publisher-name>North China Electric Power University</publisher-name>
          <publisher-loc>Beijing, China</publisher-loc>
        </element-citation>
      </ref>
      <ref id="ref_16">
        <label>16.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>M. S.</given-names>
              <surname>Fathy</surname>
            </name>
            <name>
              <given-names>H.</given-names>
              <surname>Awad</surname>
            </name>
            <name>
              <given-names>H.</given-names>
              <surname>Hegarzy</surname>
            </name>
            <name>
              <given-names>E. E.</given-names>
              <surname>Elkholy</surname>
            </name>
          </person-group>
          <article-title>Performance of a PV-wind hybrid system under severe weather and loading conditions</article-title>
          <source>Int. J. Ind. Elec. Drive.</source>
          <year>2018</year>
          <volume>4</volume>
          <issue>3</issue>
          <page-range>145-154</page-range>
          <fpage>145</fpage>
          <lpage>154</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1504/IJIED.2018.093679</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_17">
        <label>17.</label>
        <element-citation publication-type="conf-paper">
          <person-group person-group-type="author">
            <name>
              <given-names>E.</given-names>
              <surname>Ribeiro</surname>
            </name>
            <name>
              <given-names>A. J. M.</given-names>
              <surname>Cardoso</surname>
            </name>
            <name>
              <given-names>C.</given-names>
              <surname>Boccaletti</surname>
            </name>
          </person-group>
          <person-group person-group-type="editor"/>
          <article-title>Power converters analysis in a renewable energy based hybrid system with hydrogen storage</article-title>
          <source/>
          <publisher-loc/>
          <publisher-name>IET</publisher-name>
          <conf-name>IET Conference on Renewable Power Generation</conf-name>
          <conf-acronym>RPG 2011</conf-acronym>
          <conf-loc>Edinburgh</conf-loc>
          <conf-date>September 6-8, 2011</conf-date>
          <year>2011</year>
          <volume/>
          <issue/>
          <page-range>1-6</page-range>
          <fpage>1</fpage>
          <lpage>6</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1049/cp.2011.0212.</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_18">
        <label>18.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>J. P.</given-names>
              <surname>Torreglosa</surname>
            </name>
            <name>
              <given-names>P.</given-names>
              <surname>García</surname>
            </name>
            <name>
              <given-names>L. M.</given-names>
              <surname>Fernández</surname>
            </name>
            <name>
              <given-names>F.</given-names>
              <surname>Jurado</surname>
            </name>
          </person-group>
          <article-title>Energy dispatching based on predictive controller of an off-grid wind turbine/photovoltaic/hydrogen/battery hybrid system</article-title>
          <source>Renew. Energ.</source>
          <year>2015</year>
          <volume>74</volume>
          <issue/>
          <page-range>326-336</page-range>
          <fpage>326</fpage>
          <lpage>336</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.renene.2014.08.010</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_19">
        <label>19.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>Z.</given-names>
              <surname>Abdin and W</surname>
            </name>
          </person-group>
          <article-title>Hybrid energy systems for off-grid power supply and hydrogen production based on renewable energy: A techno-economic analysis</article-title>
          <source>Energ. Convers. Manage.</source>
          <year>2019</year>
          <volume>196</volume>
          <issue/>
          <page-range>1068-1079</page-range>
          <fpage>1068</fpage>
          <lpage>1079</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1016/j.enconman.2019.06.068</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
      <ref id="ref_20">
        <label>20.</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <given-names>A. O.</given-names>
              <surname>Haruni</surname>
            </name>
            <name>
              <given-names>M.</given-names>
              <surname>Negnevitsky</surname>
            </name>
            <name>
              <given-names>M. E.</given-names>
              <surname>Haque</surname>
            </name>
            <name>
              <given-names>A.</given-names>
              <surname>Gargoom</surname>
            </name>
          </person-group>
          <article-title>A novel operation and control strategy for a standalone hybrid renewable power system</article-title>
          <source>IEEE T. Sustain. Energ.</source>
          <year>2012</year>
          <volume>4</volume>
          <issue>2</issue>
          <page-range>402-413</page-range>
          <fpage>402</fpage>
          <lpage>413</lpage>
          <pub-id pub-id-type="doi">https://doi.org/10.1109/TSTE.2012.2225455</pub-id>
          <pub-id pub-id-type="publisher-id"/>
        </element-citation>
      </ref>
    </ref-list>
  </back>
</article>